var __webpack_modules__ = {
  "./src/shared/constants.ts": 
  /*!*********************************!*\
  !*** ./src/shared/constants.ts ***!
  \*********************************/ (__unused_webpack_module, __webpack_exports__, __webpack_require__) => {
    eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   RANDOM_EVENT_PATH: () => (/* binding */ RANDOM_EVENT_PATH),\n/* harmony export */   TRIGGERED_RANDOM_EVENTS_PATH: () => (/* binding */ TRIGGERED_RANDOM_EVENTS_PATH),\n/* harmony export */   updateUserKey: () => (/* binding */ updateUserKey),\n/* harmony export */   userKey: () => (/* binding */ userKey)\n/* harmony export */ });\nconst RANDOM_EVENT_PATH = 'stat_data.世界.随机事件[0]';\n/**\n * 获取用户键名，支持多种回退机制\n */\nfunction getUserKey() {\n    try {\n        // 尝试使用 substitudeMacros 函数\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        if (typeof substitudeMacros === 'function') {\n            const result = substitudeMacros('<user>');\n            if (result && result !== '<user>' && typeof result === 'string') {\n                console.log('[Constants] 使用 substitudeMacros 获取用户键:', result);\n                return result;\n            }\n        }\n        // 回退1: 尝试从酒馆助手变量获取\n        if (typeof window.getVariables === 'function') {\n            const vars = window.getVariables({ type: 'global' });\n            const userName = vars?.user_name || vars?.username;\n            if (userName && typeof userName === 'string') {\n                console.log('[Constants] 从全局变量获取用户键:', userName);\n                return userName;\n            }\n        }\n        // 回退2: 尝试从SillyTavern获取\n        const st = window.SillyTavern;\n        if (st?.name1) {\n            console.log('[Constants] 从SillyTavern获取用户键:', st.name1);\n            return st.name1;\n        }\n        // 回退3: 从聊天消息中推断用户名\n        if (typeof window.getChatMessages === 'function') {\n            try {\n                const messages = window.getChatMessages();\n                const userMessage = messages.find((msg) => msg.is_user);\n                if (userMessage?.name) {\n                    console.log('[Constants] 从聊天消息推断用户键:', userMessage.name);\n                    return userMessage.name;\n                }\n            }\n            catch {\n                // ignore\n            }\n        }\n        // 最终回退: 使用默认值\n        console.warn('[Constants] 无法获取用户键，使用默认值: <user>');\n        return '<user>';\n    }\n    catch (error) {\n        console.error('[Constants] 获取用户键时发生错误:', error);\n        return '<user>';\n    }\n}\n// 延迟获取用户键，确保在需要时才计算\nlet userKey = '<user>';\n// 提供动态更新用户键的函数\nfunction updateUserKey() {\n    userKey = getUserKey();\n    return userKey;\n}\n// 在模块加载时尝试获取一次\ntry {\n    userKey = getUserKey();\n}\ncatch {\n    // ignore\n}\nconst TRIGGERED_RANDOM_EVENTS_PATH = 'tavern_helper.random_events.triggered';\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxNQUFNLENBQUM7SUFDUCxTQUFTO0FBQ1gsQ0FBQztBQUNNLE1BQU0sNEJBQTRCLEdBQUcsdUNBQXVDLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90YXZlcm5faGVscGVyX3RlbXBsYXRlLy4vc3JjL3NoYXJlZC9jb25zdGFudHMudHM/Il0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBSQU5ET01fRVZFTlRfUEFUSCA9ICdzdGF0X2RhdGEu5LiW55WMLumaj+acuuS6i+S7tlswXSc7XHJcblxyXG4vKipcclxuICog6I635Y+W55So5oi36ZSu5ZCN77yM5pSv5oyB5aSa56eN5Zue6YCA5py65Yi2XHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRVc2VyS2V5KCk6IHN0cmluZyB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIOWwneivleS9v+eUqCBzdWJzdGl0dWRlTWFjcm9zIOWHveaVsFxyXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHMtY29tbWVudFxyXG4gICAgLy8gQHRzLWlnbm9yZVxyXG4gICAgaWYgKHR5cGVvZiBzdWJzdGl0dWRlTWFjcm9zID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHN1YnN0aXR1ZGVNYWNyb3MoJzx1c2VyPicpO1xyXG4gICAgICBpZiAocmVzdWx0ICYmIHJlc3VsdCAhPT0gJzx1c2VyPicgJiYgdHlwZW9mIHJlc3VsdCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnW0NvbnN0YW50c10g5L2/55SoIHN1YnN0aXR1ZGVNYWNyb3Mg6I635Y+W55So5oi36ZSuOicsIHJlc3VsdCk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOWbnumAgDE6IOWwneivleS7jumFkummhuWKqeaJi+WPmOmHj+iOt+WPllxyXG4gICAgaWYgKHR5cGVvZiAod2luZG93IGFzIGFueSkuZ2V0VmFyaWFibGVzID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgIGNvbnN0IHZhcnMgPSAod2luZG93IGFzIGFueSkuZ2V0VmFyaWFibGVzKHsgdHlwZTogJ2dsb2JhbCcgfSk7XHJcbiAgICAgIGNvbnN0IHVzZXJOYW1lID0gdmFycz8udXNlcl9uYW1lIHx8IHZhcnM/LnVzZXJuYW1lO1xyXG4gICAgICBpZiAodXNlck5hbWUgJiYgdHlwZW9mIHVzZXJOYW1lID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdbQ29uc3RhbnRzXSDku47lhajlsYDlj5jph4/ojrflj5bnlKjmiLfplK46JywgdXNlck5hbWUpO1xyXG4gICAgICAgIHJldHVybiB1c2VyTmFtZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOWbnumAgDI6IOWwneivleS7jlNpbGx5VGF2ZXJu6I635Y+WXHJcbiAgICBjb25zdCBzdCA9ICh3aW5kb3cgYXMgYW55KS5TaWxseVRhdmVybjtcclxuICAgIGlmIChzdD8ubmFtZTEpIHtcclxuICAgICAgY29uc29sZS5sb2coJ1tDb25zdGFudHNdIOS7jlNpbGx5VGF2ZXJu6I635Y+W55So5oi36ZSuOicsIHN0Lm5hbWUxKTtcclxuICAgICAgcmV0dXJuIHN0Lm5hbWUxO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOWbnumAgDM6IOS7juiBiuWkqea2iOaBr+S4reaOqOaWreeUqOaIt+WQjVxyXG4gICAgaWYgKHR5cGVvZiAod2luZG93IGFzIGFueSkuZ2V0Q2hhdE1lc3NhZ2VzID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgbWVzc2FnZXMgPSAod2luZG93IGFzIGFueSkuZ2V0Q2hhdE1lc3NhZ2VzKCk7XHJcbiAgICAgICAgY29uc3QgdXNlck1lc3NhZ2UgPSBtZXNzYWdlcy5maW5kKChtc2c6IGFueSkgPT4gbXNnLmlzX3VzZXIpO1xyXG4gICAgICAgIGlmICh1c2VyTWVzc2FnZT8ubmFtZSkge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coJ1tDb25zdGFudHNdIOS7juiBiuWkqea2iOaBr+aOqOaWreeUqOaIt+mUrjonLCB1c2VyTWVzc2FnZS5uYW1lKTtcclxuICAgICAgICAgIHJldHVybiB1c2VyTWVzc2FnZS5uYW1lO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgLy8gaWdub3JlXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDmnIDnu4jlm57pgIA6IOS9v+eUqOm7mOiupOWAvFxyXG4gICAgY29uc29sZS53YXJuKCdbQ29uc3RhbnRzXSDml6Dms5Xojrflj5bnlKjmiLfplK7vvIzkvb/nlKjpu5jorqTlgLw6IDx1c2VyPicpO1xyXG4gICAgcmV0dXJuICc8dXNlcj4nO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbQ29uc3RhbnRzXSDojrflj5bnlKjmiLfplK7ml7blj5HnlJ/plJnor686JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuICc8dXNlcj4nO1xyXG4gIH1cclxufVxyXG5cclxuLy8g5bu26L+f6I635Y+W55So5oi36ZSu77yM56Gu5L+d5Zyo6ZyA6KaB5pe25omN6K6h566XXHJcbmV4cG9ydCBsZXQgdXNlcktleSA9ICc8dXNlcj4nO1xyXG5cclxuLy8g5o+Q5L6b5Yqo5oCB5pu05paw55So5oi36ZSu55qE5Ye95pWwXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVVc2VyS2V5KCk6IHN0cmluZyB7XHJcbiAgdXNlcktleSA9IGdldFVzZXJLZXkoKTtcclxuICByZXR1cm4gdXNlcktleTtcclxufVxyXG5cclxuLy8g5Zyo5qih5Z2X5Yqg6L295pe25bCd6K+V6I635Y+W5LiA5qyhXHJcbnRyeSB7XHJcbiAgdXNlcktleSA9IGdldFVzZXJLZXkoKTtcclxufSBjYXRjaCB7XHJcbiAgLy8gaWdub3JlXHJcbn1cclxuZXhwb3J0IGNvbnN0IFRSSUdHRVJFRF9SQU5ET01fRVZFTlRTX1BBVEggPSAndGF2ZXJuX2hlbHBlci5yYW5kb21fZXZlbnRzLnRyaWdnZXJlZCc7XHJcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/shared/constants.ts\n\n}");
  },
  "./src/好感事件触发/index.ts": 
  /*!*****************************!*\
  !*** ./src/好感事件触发/index.ts ***!
  \*****************************/ (__unused_webpack_module, __webpack_exports__, __webpack_require__) => {
    eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _shared_constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../shared/constants */ \"./src/shared/constants.ts\");\n// 好感事件触发器（增强版）\n// 规则：当 角色(紫音/凛/枫).好感度[0] 达到 50/100/150 阈值时：\n// 1) 先更新 角色.好感事件[0] = 对应阶段(1/2/3)，仅单调递增；\n// 2) 若 世界.随机事件[0] === '无'，择一触发该角色尚未触发的最低阶段事件，并记录触发痕迹（脚本变量域），确保每阶段只触发一次。\n\nconst ROLES = ['紫音', '凛', '枫'];\nconst THRESHOLDS = [50, 100, 150]; // 对应阶段 1/2/3\nconst CONFIG_ROOT = '好感事件触发器.配置'; // 存于脚本变量域根下\n// 变量路径辅助\nconst stagePathOf = (role) => `tavern_helper.affection_events.stage.${role}`;\nconst lustStagePathOf = (role) => `tavern_helper.lust_events.stage.${role}`;\n// 特殊事件：圣女传承\nconst SAINT_EVENT_NAME = '圣女传承';\n// 读取/写入 stat_data.* 的工具（优先走 Mvu，回退到 _.get/_.set）\nfunction getStatValue(variables, path, defaultValue) {\n    try {\n        if (typeof Mvu !== 'undefined') {\n            const value = Mvu.getMvuVariable(variables, path);\n            return (value === undefined ? defaultValue : value);\n        }\n    }\n    catch (_) {\n        void 0;\n    }\n    return _.get(variables, `stat_data.${path}`, defaultValue);\n}\nasync function setStatValue(variables, path, value, reason) {\n    try {\n        if (typeof Mvu !== 'undefined') {\n            await Mvu.setMvuVariable(variables, path, value, { reason });\n            return;\n        }\n    }\n    catch (_) {\n        void 0;\n    }\n    _.set(variables, `stat_data.${path}`, value);\n}\n// 事件命名（支持角色自定义映射）\nconst CUSTOM_EVENT_NAME_MAP = {\n    紫音: {\n        1: '女仆修行',\n        2: '心理评估',\n        3: '便利店圣女',\n    },\n    凛: {\n        1: '任务意外',\n        2: '家庭性教育',\n        3: '后宫失火',\n    },\n    枫: {\n        1: '时光胶囊',\n        2: '花火大会',\n        3: '素材争夺战',\n    },\n};\nfunction buildEventName(role, stage) {\n    const roleMap = CUSTOM_EVENT_NAME_MAP[role];\n    if (roleMap && roleMap[stage])\n        return roleMap[stage];\n    return `好感事件-${role}-阶段${stage}`;\n}\n// 凛·淫堕事件命名映射\nconst RIN_LUST_EVENT_NAME_MAP = {\n    1: '浴室惩罚',\n    2: '性处理委员',\n    3: '极乐婚典',\n};\nfunction buildRinLustEventName(stage) {\n    return RIN_LUST_EVENT_NAME_MAP[stage] ?? `凛淫堕事件-阶段${stage}`;\n}\n// 紫音·淫堕事件命名映射（占位，后续可自定义替换）\nconst ZIYIN_LUST_EVENT_NAME_MAP = {\n    1: '失控净化',\n    2: '青梅目前犯',\n    3: '异次元大团圆',\n};\nfunction buildZiyinLustEventName(stage) {\n    return ZIYIN_LUST_EVENT_NAME_MAP[stage] ?? `紫音淫堕事件-阶段${stage}`;\n}\nfunction getTriggerConfig(scriptVars) {\n    const globalEnabled = _.get(scriptVars, `${CONFIG_ROOT}.启用全局`, true);\n    const roleEnabled = {};\n    for (const role of ROLES) {\n        roleEnabled[role] = _.get(scriptVars, `${CONFIG_ROOT}.启用角色.${role}`, true);\n    }\n    const saintEnabled = _.get(scriptVars, `${CONFIG_ROOT}.启用圣女传承`, true);\n    const saintThreshold = _.get(scriptVars, `${CONFIG_ROOT}.圣女传承阈值`, 70);\n    return { globalEnabled, roleEnabled, saintEnabled, saintThreshold };\n}\nfunction calcStageFromAffection(affection) {\n    if (affection >= THRESHOLDS[2])\n        return 3;\n    if (affection >= THRESHOLDS[1])\n        return 2;\n    if (affection >= THRESHOLDS[0])\n        return 1;\n    return 0;\n}\nasync function trySyncStagesAndTriggerEvent(variables) {\n    try {\n        const scriptVars = getVariables({ type: 'script', script_id: getScriptId() });\n        const config = getTriggerConfig(scriptVars);\n        if (!config.globalEnabled)\n            return;\n        // 1) 同步所有角色的状态\n        for (const role of ROLES) {\n            const affection = getStatValue(variables, `${role}.好感度[0]`, 0);\n            const currentState = _.get(variables, stagePathOf(role), 0);\n            const targetAffectionStage = calcStageFromAffection(affection);\n            const currentAchievedStage = Math.ceil(currentState / 2);\n            if (targetAffectionStage > currentAchievedStage) {\n                const newState = targetAffectionStage * 2 - 1;\n                _.set(variables, stagePathOf(role), newState);\n            }\n            // 同步“凛”的淫堕阶段（50/100/150），采用奇/偶状态表示达成/已触发\n            if (role === '凛') {\n                const rinLust = getStatValue(variables, '凛.淫堕值[0]', 0);\n                const rinTargetStage = calcStageFromAffection(rinLust);\n                const rinCurrentState = _.get(variables, lustStagePathOf('凛'), 0);\n                const rinAchievedStage = Math.ceil(rinCurrentState / 2);\n                if (rinTargetStage > rinAchievedStage) {\n                    const newRinState = rinTargetStage * 2 - 1; // 奇数=已达到未触发\n                    _.set(variables, lustStagePathOf('凛'), newRinState);\n                }\n            }\n            // 同步“紫音”的淫堕阶段（50/100/150），采用奇/偶状态表示达成/已触发\n            if (role === '紫音') {\n                const ziyinLust = getStatValue(variables, '紫音.淫堕值[0]', 0);\n                const ziyinTargetStage = calcStageFromAffection(ziyinLust);\n                const ziyinCurrentState = _.get(variables, lustStagePathOf('紫音'), 0);\n                const ziyinAchievedStage = Math.ceil(ziyinCurrentState / 2);\n                if (ziyinTargetStage > ziyinAchievedStage) {\n                    const newZiyinState = ziyinTargetStage * 2 - 1; // 奇数=已达到未触发\n                    _.set(variables, lustStagePathOf('紫音'), newZiyinState);\n                }\n            }\n        }\n        // 2) 若随机事件空闲，优先触发“圣女传承”（一次性），否则择一触发“待触发”的角色事件\n        const currentRandomEvent = getStatValue(variables, '世界.随机事件[0]', '无');\n        if (currentRandomEvent === '无') {\n            // 圣女传承优先\n            const lust = getStatValue(variables, `${_shared_constants__WEBPACK_IMPORTED_MODULE_0__.userKey}.淫堕值[0]`, 0);\n            const power = getStatValue(variables, `${_shared_constants__WEBPACK_IMPORTED_MODULE_0__.userKey}.实力等级[0]`, '');\n            const triggeredEvents = _.get(variables, _shared_constants__WEBPACK_IMPORTED_MODULE_0__.TRIGGERED_RANDOM_EVENTS_PATH, []);\n            if (config.saintEnabled &&\n                lust >= config.saintThreshold &&\n                power === 'S' &&\n                !triggeredEvents.includes(SAINT_EVENT_NAME)) {\n                await setStatValue(variables, '世界.随机事件[0]', SAINT_EVENT_NAME, '圣女传承');\n                const existed = _.get(variables, _shared_constants__WEBPACK_IMPORTED_MODULE_0__.TRIGGERED_RANDOM_EVENTS_PATH, []);\n                _.set(variables, _shared_constants__WEBPACK_IMPORTED_MODULE_0__.TRIGGERED_RANDOM_EVENTS_PATH, _.uniq([...(Array.isArray(existed) ? existed : []), SAINT_EVENT_NAME]));\n            }\n            else {\n                // 先尝试“凛”的淫堕事件：当状态为奇数表示待触发，触发最低阶段一次\n                if (config.roleEnabled['凛']) {\n                    const rinCurrentState = _.get(variables, lustStagePathOf('凛'), 0);\n                    if (rinCurrentState > 0 && rinCurrentState % 2 !== 0) {\n                        const rinTriggerStage = (rinCurrentState + 1) / 2;\n                        const rinLustEventName = buildRinLustEventName(rinTriggerStage);\n                        await setStatValue(variables, '世界.随机事件[0]', rinLustEventName, '凛淫堕值触发');\n                        // 标记已触发：由奇数（待触发）变为偶数（已触发）\n                        _.set(variables, lustStagePathOf('凛'), rinCurrentState + 1);\n                        return; // 本轮仅触发一个事件\n                    }\n                }\n                // 再尝试\"紫音\"的淫堕事件\n                if (config.roleEnabled['紫音']) {\n                    const ziyinCurrentState = _.get(variables, lustStagePathOf('紫音'), 0);\n                    if (ziyinCurrentState > 0 && ziyinCurrentState % 2 !== 0) {\n                        const ziyinTriggerStage = (ziyinCurrentState + 1) / 2;\n                        const ziyinLustEventName = buildZiyinLustEventName(ziyinTriggerStage);\n                        await setStatValue(variables, '世界.随机事件[0]', ziyinLustEventName, '紫音淫堕值触发');\n                        // 紫音淫堕阶段2触发时，设置心魔为0\n                        if (ziyinTriggerStage === 2) {\n                            await setStatValue(variables, '紫音.心魔[0]', 0, '紫音淫堕阶段2触发');\n                        }\n                        // 标记已触发：由奇数（待触发）变为偶数（已触发）\n                        _.set(variables, lustStagePathOf('紫音'), ziyinCurrentState + 1);\n                        return; // 本轮仅触发一个事件\n                    }\n                }\n                // 否则尝试触发角色事件\n                outer: for (const role of ROLES) {\n                    if (!config.roleEnabled[role])\n                        continue;\n                    const currentState = _.get(variables, stagePathOf(role), 0);\n                    // 状态值为奇数，表示“已达到但未触发”\n                    if (currentState > 0 && currentState % 2 !== 0) {\n                        const triggerStage = (currentState + 1) / 2;\n                        const eventName = buildEventName(role, triggerStage);\n                        await setStatValue(variables, '世界.随机事件[0]', eventName, '好感事件触发');\n                        // 紫音 第三阶段（便利店圣女）触发时，仅在心魔为初始值2时设置心魔为 1\n                        if (role === '紫音' && triggerStage === 3) {\n                            const currentXinmo = getStatValue(variables, '紫音.心魔[0]', 2);\n                            // 只有心魔为初始值2(被心魔困扰)时才设置为1(正在面对心魔)，避免覆盖淫堕事件设置的0\n                            if (currentXinmo === 2) {\n                                await setStatValue(variables, '紫音.心魔[0]', 1, '便利店圣女触发');\n                            }\n                        }\n                        // 状态+1，变为“已触发”的偶数值（显式持久化）\n                        _.set(variables, stagePathOf(role), currentState + 1);\n                        break outer; // 每轮只触发一个\n                    }\n                }\n            }\n        }\n    }\n    catch (error) {\n        console.error('[好感事件触发器] 运行出错:', error);\n    }\n}\neventOn(typeof Mvu !== 'undefined' ? Mvu.events.VARIABLE_UPDATE_ENDED : 'mag_variable_update_ended', trySyncStagesAndTriggerEvent);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Li9zcmMv5aW95oSf5LqL5Lu26Kem5Y+RL2luZGV4LnRzPyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyDlpb3mhJ/kuovku7bop6blj5HlmajvvIjlop7lvLrniYjvvIlcbi8vIOinhOWIme+8muW9kyDop5LoibIo57Sr6Z+zL+WHmy/mnqspLuWlveaEn+W6plswXSDovr7liLAgNTAvMTAwLzE1MCDpmIjlgLzml7bvvJpcbi8vIDEpIOWFiOabtOaWsCDop5LoibIu5aW95oSf5LqL5Lu2WzBdID0g5a+55bqU6Zi25q61KDEvMi8zKe+8jOS7heWNleiwg+mAkuWinu+8m1xuLy8gMikg6IulIOS4lueVjC7pmo/mnLrkuovku7ZbMF0gPT09ICfml6An77yM5oup5LiA6Kem5Y+R6K+l6KeS6Imy5bCa5pyq6Kem5Y+R55qE5pyA5L2O6Zi25q615LqL5Lu277yM5bm26K6w5b2V6Kem5Y+R55eV6L+577yI6ISa5pys5Y+Y6YeP5Z+f77yJ77yM56Gu5L+d5q+P6Zi25q615Y+q6Kem5Y+R5LiA5qyh44CCXG5cbmltcG9ydCB7IFRSSUdHRVJFRF9SQU5ET01fRVZFTlRTX1BBVEgsIHVzZXJLZXkgfSBmcm9tICcuLi9zaGFyZWQvY29uc3RhbnRzJztcblxuY29uc3QgUk9MRVM6IHN0cmluZ1tdID0gWyfntKvpn7MnLCAn5YebJywgJ+aeqyddO1xuY29uc3QgVEhSRVNIT0xEUzogbnVtYmVyW10gPSBbNTAsIDEwMCwgMTUwXTsgLy8g5a+55bqU6Zi25q61IDEvMi8zXG5jb25zdCBDT05GSUdfUk9PVCA9ICflpb3mhJ/kuovku7bop6blj5Hlmagu6YWN572uJzsgLy8g5a2Y5LqO6ISa5pys5Y+Y6YeP5Z+f5qC55LiLXG5cbi8vIOWPmOmHj+i3r+W+hOi+heWKqVxuY29uc3Qgc3RhZ2VQYXRoT2YgPSAocm9sZTogc3RyaW5nKSA9PiBgdGF2ZXJuX2hlbHBlci5hZmZlY3Rpb25fZXZlbnRzLnN0YWdlLiR7cm9sZX1gO1xuY29uc3QgbHVzdFN0YWdlUGF0aE9mID0gKHJvbGU6IHN0cmluZykgPT4gYHRhdmVybl9oZWxwZXIubHVzdF9ldmVudHMuc3RhZ2UuJHtyb2xlfWA7XG5cbi8vIOeJueauiuS6i+S7tu+8muWco+Wls+S8oOaJv1xuY29uc3QgU0FJTlRfRVZFTlRfTkFNRSA9ICflnKPlpbPkvKDmib8nO1xuXG4vLyDor7vlj5Yv5YaZ5YWlIHN0YXRfZGF0YS4qIOeahOW3peWFt++8iOS8mOWFiOi1sCBNdnXvvIzlm57pgIDliLAgXy5nZXQvXy5zZXTvvIlcbmZ1bmN0aW9uIGdldFN0YXRWYWx1ZTxUID0gYW55Pih2YXJpYWJsZXM6IFJlY29yZDxzdHJpbmcsIGFueT4sIHBhdGg6IHN0cmluZywgZGVmYXVsdFZhbHVlPzogVCk6IFQge1xuICB0cnkge1xuICAgIGlmICh0eXBlb2YgTXZ1ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgY29uc3QgdmFsdWUgPSBNdnUuZ2V0TXZ1VmFyaWFibGUodmFyaWFibGVzIGFzIGFueSwgcGF0aCk7XG4gICAgICByZXR1cm4gKHZhbHVlID09PSB1bmRlZmluZWQgPyBkZWZhdWx0VmFsdWUgOiB2YWx1ZSkgYXMgVDtcbiAgICB9XG4gIH0gY2F0Y2ggKF8pIHtcbiAgICB2b2lkIDA7XG4gIH1cbiAgcmV0dXJuIF8uZ2V0KHZhcmlhYmxlcywgYHN0YXRfZGF0YS4ke3BhdGh9YCwgZGVmYXVsdFZhbHVlKSBhcyBUO1xufVxuXG5hc3luYyBmdW5jdGlvbiBzZXRTdGF0VmFsdWUodmFyaWFibGVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+LCBwYXRoOiBzdHJpbmcsIHZhbHVlOiBhbnksIHJlYXNvbj86IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICB0cnkge1xuICAgIGlmICh0eXBlb2YgTXZ1ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgYXdhaXQgTXZ1LnNldE12dVZhcmlhYmxlKHZhcmlhYmxlcyBhcyBhbnksIHBhdGgsIHZhbHVlLCB7IHJlYXNvbiB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH0gY2F0Y2ggKF8pIHtcbiAgICB2b2lkIDA7XG4gIH1cbiAgXy5zZXQodmFyaWFibGVzLCBgc3RhdF9kYXRhLiR7cGF0aH1gLCB2YWx1ZSk7XG59XG5cbi8vIOS6i+S7tuWRveWQje+8iOaUr+aMgeinkuiJsuiHquWumuS5ieaYoOWwhO+8iVxuY29uc3QgQ1VTVE9NX0VWRU5UX05BTUVfTUFQOiBSZWNvcmQ8c3RyaW5nLCBSZWNvcmQ8bnVtYmVyLCBzdHJpbmc+PiA9IHtcbiAg57Sr6Z+zOiB7XG4gICAgMTogJ+Wls+S7huS/ruihjCcsXG4gICAgMjogJ+W/g+eQhuivhOS8sCcsXG4gICAgMzogJ+S+v+WIqeW6l+Wco+WlsycsXG4gIH0sXG4gIOWHmzoge1xuICAgIDE6ICfku7vliqHmhI/lpJYnLFxuICAgIDI6ICflrrbluq3mgKfmlZnogrInLFxuICAgIDM6ICflkI7lrqvlpLHngasnLFxuICB9LFxuICDmnqs6IHtcbiAgICAxOiAn5pe25YWJ6IO25ZuKJyxcbiAgICAyOiAn6Iqx54Gr5aSn5LyaJyxcbiAgICAzOiAn57Sg5p2Q5LqJ5aS65oiYJyxcbiAgfSxcbn07XG5cbmZ1bmN0aW9uIGJ1aWxkRXZlbnROYW1lKHJvbGU6IHN0cmluZywgc3RhZ2U6IG51bWJlcik6IHN0cmluZyB7XG4gIGNvbnN0IHJvbGVNYXAgPSBDVVNUT01fRVZFTlRfTkFNRV9NQVBbcm9sZV07XG4gIGlmIChyb2xlTWFwICYmIHJvbGVNYXBbc3RhZ2VdKSByZXR1cm4gcm9sZU1hcFtzdGFnZV07XG4gIHJldHVybiBg5aW95oSf5LqL5Lu2LSR7cm9sZX0t6Zi25q61JHtzdGFnZX1gO1xufVxuXG4vLyDlh5vCt+a3q+WgleS6i+S7tuWRveWQjeaYoOWwhFxuY29uc3QgUklOX0xVU1RfRVZFTlRfTkFNRV9NQVA6IFJlY29yZDxudW1iZXIsIHN0cmluZz4gPSB7XG4gIDE6ICfmtbTlrqTmg6nnvZonLFxuICAyOiAn5oCn5aSE55CG5aeU5ZGYJyxcbiAgMzogJ+aegeS5kOWpmuWFuCcsXG59O1xuZnVuY3Rpb24gYnVpbGRSaW5MdXN0RXZlbnROYW1lKHN0YWdlOiBudW1iZXIpOiBzdHJpbmcge1xuICByZXR1cm4gUklOX0xVU1RfRVZFTlRfTkFNRV9NQVBbc3RhZ2VdID8/IGDlh5vmt6vloJXkuovku7Yt6Zi25q61JHtzdGFnZX1gO1xufVxuXG4vLyDntKvpn7PCt+a3q+WgleS6i+S7tuWRveWQjeaYoOWwhO+8iOWNoOS9je+8jOWQjue7reWPr+iHquWumuS5ieabv+aNou+8iVxuY29uc3QgWklZSU5fTFVTVF9FVkVOVF9OQU1FX01BUDogUmVjb3JkPG51bWJlciwgc3RyaW5nPiA9IHtcbiAgMTogJ+WkseaOp+WHgOWMlicsXG4gIDI6ICfpnZLmooXnm67liY3niq8nLFxuICAzOiAn5byC5qyh5YWD5aSn5Zui5ZyGJyxcbn07XG5mdW5jdGlvbiBidWlsZFppeWluTHVzdEV2ZW50TmFtZShzdGFnZTogbnVtYmVyKTogc3RyaW5nIHtcbiAgcmV0dXJuIFpJWUlOX0xVU1RfRVZFTlRfTkFNRV9NQVBbc3RhZ2VdID8/IGDntKvpn7Pmt6vloJXkuovku7Yt6Zi25q61JHtzdGFnZX1gO1xufVxuXG50eXBlIFRyaWdnZXJDb25maWcgPSB7XG4gIGdsb2JhbEVuYWJsZWQ6IGJvb2xlYW47XG4gIHJvbGVFbmFibGVkOiBSZWNvcmQ8c3RyaW5nLCBib29sZWFuPjtcbiAgc2FpbnRFbmFibGVkOiBib29sZWFuO1xuICBzYWludFRocmVzaG9sZDogbnVtYmVyO1xufTtcblxuZnVuY3Rpb24gZ2V0VHJpZ2dlckNvbmZpZyhzY3JpcHRWYXJzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogVHJpZ2dlckNvbmZpZyB7XG4gIGNvbnN0IGdsb2JhbEVuYWJsZWQgPSBfLmdldChzY3JpcHRWYXJzLCBgJHtDT05GSUdfUk9PVH0u5ZCv55So5YWo5bGAYCwgdHJ1ZSkgYXMgYm9vbGVhbjtcbiAgY29uc3Qgcm9sZUVuYWJsZWQ6IFJlY29yZDxzdHJpbmcsIGJvb2xlYW4+ID0ge307XG4gIGZvciAoY29uc3Qgcm9sZSBvZiBST0xFUykge1xuICAgIHJvbGVFbmFibGVkW3JvbGVdID0gXy5nZXQoc2NyaXB0VmFycywgYCR7Q09ORklHX1JPT1R9LuWQr+eUqOinkuiJsi4ke3JvbGV9YCwgdHJ1ZSkgYXMgYm9vbGVhbjtcbiAgfVxuICBjb25zdCBzYWludEVuYWJsZWQgPSBfLmdldChzY3JpcHRWYXJzLCBgJHtDT05GSUdfUk9PVH0u5ZCv55So5Zyj5aWz5Lyg5om/YCwgdHJ1ZSkgYXMgYm9vbGVhbjtcbiAgY29uc3Qgc2FpbnRUaHJlc2hvbGQgPSBfLmdldChzY3JpcHRWYXJzLCBgJHtDT05GSUdfUk9PVH0u5Zyj5aWz5Lyg5om/6ZiI5YC8YCwgNzApIGFzIG51bWJlcjtcbiAgcmV0dXJuIHsgZ2xvYmFsRW5hYmxlZCwgcm9sZUVuYWJsZWQsIHNhaW50RW5hYmxlZCwgc2FpbnRUaHJlc2hvbGQgfTtcbn1cblxuZnVuY3Rpb24gY2FsY1N0YWdlRnJvbUFmZmVjdGlvbihhZmZlY3Rpb246IG51bWJlcik6IG51bWJlciB7XG4gIGlmIChhZmZlY3Rpb24gPj0gVEhSRVNIT0xEU1syXSkgcmV0dXJuIDM7XG4gIGlmIChhZmZlY3Rpb24gPj0gVEhSRVNIT0xEU1sxXSkgcmV0dXJuIDI7XG4gIGlmIChhZmZlY3Rpb24gPj0gVEhSRVNIT0xEU1swXSkgcmV0dXJuIDE7XG4gIHJldHVybiAwO1xufVxuXG5hc3luYyBmdW5jdGlvbiB0cnlTeW5jU3RhZ2VzQW5kVHJpZ2dlckV2ZW50KHZhcmlhYmxlczogUmVjb3JkPHN0cmluZywgYW55Pik6IFByb21pc2U8dm9pZD4ge1xuICB0cnkge1xuICAgIGNvbnN0IHNjcmlwdFZhcnMgPSBnZXRWYXJpYWJsZXMoeyB0eXBlOiAnc2NyaXB0Jywgc2NyaXB0X2lkOiBnZXRTY3JpcHRJZCgpIH0pO1xuICAgIGNvbnN0IGNvbmZpZyA9IGdldFRyaWdnZXJDb25maWcoc2NyaXB0VmFycyk7XG5cbiAgICBpZiAoIWNvbmZpZy5nbG9iYWxFbmFibGVkKSByZXR1cm47XG5cbiAgICAvLyAxKSDlkIzmraXmiYDmnInop5LoibLnmoTnirbmgIFcbiAgICBmb3IgKGNvbnN0IHJvbGUgb2YgUk9MRVMpIHtcbiAgICAgIGNvbnN0IGFmZmVjdGlvbjogbnVtYmVyID0gZ2V0U3RhdFZhbHVlPG51bWJlcj4odmFyaWFibGVzLCBgJHtyb2xlfS7lpb3mhJ/luqZbMF1gLCAwKTtcbiAgICAgIGNvbnN0IGN1cnJlbnRTdGF0ZTogbnVtYmVyID0gXy5nZXQodmFyaWFibGVzLCBzdGFnZVBhdGhPZihyb2xlKSwgMCkgYXMgbnVtYmVyO1xuICAgICAgY29uc3QgdGFyZ2V0QWZmZWN0aW9uU3RhZ2UgPSBjYWxjU3RhZ2VGcm9tQWZmZWN0aW9uKGFmZmVjdGlvbik7XG4gICAgICBjb25zdCBjdXJyZW50QWNoaWV2ZWRTdGFnZSA9IE1hdGguY2VpbChjdXJyZW50U3RhdGUgLyAyKTtcblxuICAgICAgaWYgKHRhcmdldEFmZmVjdGlvblN0YWdlID4gY3VycmVudEFjaGlldmVkU3RhZ2UpIHtcbiAgICAgICAgY29uc3QgbmV3U3RhdGUgPSB0YXJnZXRBZmZlY3Rpb25TdGFnZSAqIDIgLSAxO1xuICAgICAgICBfLnNldCh2YXJpYWJsZXMsIHN0YWdlUGF0aE9mKHJvbGUpLCBuZXdTdGF0ZSk7XG4gICAgICB9XG5cbiAgICAgIC8vIOWQjOatpeKAnOWHm+KAneeahOa3q+WglemYtuaute+8iDUwLzEwMC8xNTDvvInvvIzph4fnlKjlpYcv5YG254q25oCB6KGo56S66L6+5oiQL+W3suinpuWPkVxuICAgICAgaWYgKHJvbGUgPT09ICflh5snKSB7XG4gICAgICAgIGNvbnN0IHJpbkx1c3Q6IG51bWJlciA9IGdldFN0YXRWYWx1ZTxudW1iZXI+KHZhcmlhYmxlcywgJ+WHmy7mt6vloJXlgLxbMF0nLCAwKTtcbiAgICAgICAgY29uc3QgcmluVGFyZ2V0U3RhZ2UgPSBjYWxjU3RhZ2VGcm9tQWZmZWN0aW9uKHJpbkx1c3QpO1xuICAgICAgICBjb25zdCByaW5DdXJyZW50U3RhdGU6IG51bWJlciA9IF8uZ2V0KHZhcmlhYmxlcywgbHVzdFN0YWdlUGF0aE9mKCflh5snKSwgMCkgYXMgbnVtYmVyO1xuICAgICAgICBjb25zdCByaW5BY2hpZXZlZFN0YWdlID0gTWF0aC5jZWlsKHJpbkN1cnJlbnRTdGF0ZSAvIDIpO1xuXG4gICAgICAgIGlmIChyaW5UYXJnZXRTdGFnZSA+IHJpbkFjaGlldmVkU3RhZ2UpIHtcbiAgICAgICAgICBjb25zdCBuZXdSaW5TdGF0ZSA9IHJpblRhcmdldFN0YWdlICogMiAtIDE7IC8vIOWlh+aVsD3lt7Lovr7liLDmnKrop6blj5FcbiAgICAgICAgICBfLnNldCh2YXJpYWJsZXMsIGx1c3RTdGFnZVBhdGhPZign5YebJyksIG5ld1JpblN0YXRlKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyDlkIzmraXigJzntKvpn7PigJ3nmoTmt6vloJXpmLbmrrXvvIg1MC8xMDAvMTUw77yJ77yM6YeH55So5aWHL+WBtueKtuaAgeihqOekuui+vuaIkC/lt7Lop6blj5FcbiAgICAgIGlmIChyb2xlID09PSAn57Sr6Z+zJykge1xuICAgICAgICBjb25zdCB6aXlpbkx1c3Q6IG51bWJlciA9IGdldFN0YXRWYWx1ZTxudW1iZXI+KHZhcmlhYmxlcywgJ+e0q+mfsy7mt6vloJXlgLxbMF0nLCAwKTtcbiAgICAgICAgY29uc3Qgeml5aW5UYXJnZXRTdGFnZSA9IGNhbGNTdGFnZUZyb21BZmZlY3Rpb24oeml5aW5MdXN0KTtcbiAgICAgICAgY29uc3Qgeml5aW5DdXJyZW50U3RhdGU6IG51bWJlciA9IF8uZ2V0KHZhcmlhYmxlcywgbHVzdFN0YWdlUGF0aE9mKCfntKvpn7MnKSwgMCkgYXMgbnVtYmVyO1xuICAgICAgICBjb25zdCB6aXlpbkFjaGlldmVkU3RhZ2UgPSBNYXRoLmNlaWwoeml5aW5DdXJyZW50U3RhdGUgLyAyKTtcblxuICAgICAgICBpZiAoeml5aW5UYXJnZXRTdGFnZSA+IHppeWluQWNoaWV2ZWRTdGFnZSkge1xuICAgICAgICAgIGNvbnN0IG5ld1ppeWluU3RhdGUgPSB6aXlpblRhcmdldFN0YWdlICogMiAtIDE7IC8vIOWlh+aVsD3lt7Lovr7liLDmnKrop6blj5FcbiAgICAgICAgICBfLnNldCh2YXJpYWJsZXMsIGx1c3RTdGFnZVBhdGhPZign57Sr6Z+zJyksIG5ld1ppeWluU3RhdGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gMikg6Iul6ZqP5py65LqL5Lu256m66Zey77yM5LyY5YWI6Kem5Y+R4oCc5Zyj5aWz5Lyg5om/4oCd77yI5LiA5qyh5oCn77yJ77yM5ZCm5YiZ5oup5LiA6Kem5Y+R4oCc5b6F6Kem5Y+R4oCd55qE6KeS6Imy5LqL5Lu2XG4gICAgY29uc3QgY3VycmVudFJhbmRvbUV2ZW50ID0gZ2V0U3RhdFZhbHVlPHN0cmluZz4odmFyaWFibGVzLCAn5LiW55WMLumaj+acuuS6i+S7tlswXScsICfml6AnKTtcbiAgICBpZiAoY3VycmVudFJhbmRvbUV2ZW50ID09PSAn5pegJykge1xuICAgICAgLy8g5Zyj5aWz5Lyg5om/5LyY5YWIXG4gICAgICBjb25zdCBsdXN0OiBudW1iZXIgPSBnZXRTdGF0VmFsdWU8bnVtYmVyPih2YXJpYWJsZXMsIGAke3VzZXJLZXl9Lua3q+WgleWAvFswXWAsIDApO1xuICAgICAgY29uc3QgcG93ZXI6IHN0cmluZyA9IGdldFN0YXRWYWx1ZTxzdHJpbmc+KHZhcmlhYmxlcywgYCR7dXNlcktleX0u5a6e5Yqb562J57qnWzBdYCwgJycpO1xuICAgICAgY29uc3QgdHJpZ2dlcmVkRXZlbnRzOiBzdHJpbmdbXSA9IF8uZ2V0KHZhcmlhYmxlcywgVFJJR0dFUkVEX1JBTkRPTV9FVkVOVFNfUEFUSCwgW10pO1xuXG4gICAgICBpZiAoXG4gICAgICAgIGNvbmZpZy5zYWludEVuYWJsZWQgJiZcbiAgICAgICAgbHVzdCA+PSBjb25maWcuc2FpbnRUaHJlc2hvbGQgJiZcbiAgICAgICAgcG93ZXIgPT09ICdTJyAmJlxuICAgICAgICAhdHJpZ2dlcmVkRXZlbnRzLmluY2x1ZGVzKFNBSU5UX0VWRU5UX05BTUUpXG4gICAgICApIHtcbiAgICAgICAgYXdhaXQgc2V0U3RhdFZhbHVlKHZhcmlhYmxlcywgJ+S4lueVjC7pmo/mnLrkuovku7ZbMF0nLCBTQUlOVF9FVkVOVF9OQU1FLCAn5Zyj5aWz5Lyg5om/Jyk7XG4gICAgICAgIGNvbnN0IGV4aXN0ZWQ6IHN0cmluZ1tdID0gXy5nZXQodmFyaWFibGVzLCBUUklHR0VSRURfUkFORE9NX0VWRU5UU19QQVRILCBbXSk7XG4gICAgICAgIF8uc2V0KFxuICAgICAgICAgIHZhcmlhYmxlcyxcbiAgICAgICAgICBUUklHR0VSRURfUkFORE9NX0VWRU5UU19QQVRILFxuICAgICAgICAgIF8udW5pcShbLi4uKEFycmF5LmlzQXJyYXkoZXhpc3RlZCkgPyBleGlzdGVkIDogW10pLCBTQUlOVF9FVkVOVF9OQU1FXSksXG4gICAgICAgICk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyDlhYjlsJ3or5XigJzlh5vigJ3nmoTmt6vloJXkuovku7bvvJrlvZPnirbmgIHkuLrlpYfmlbDooajnpLrlvoXop6blj5HvvIzop6blj5HmnIDkvY7pmLbmrrXkuIDmrKFcbiAgICAgICAgaWYgKGNvbmZpZy5yb2xlRW5hYmxlZFsn5YebJ10pIHtcbiAgICAgICAgICBjb25zdCByaW5DdXJyZW50U3RhdGU6IG51bWJlciA9IF8uZ2V0KHZhcmlhYmxlcywgbHVzdFN0YWdlUGF0aE9mKCflh5snKSwgMCkgYXMgbnVtYmVyO1xuICAgICAgICAgIGlmIChyaW5DdXJyZW50U3RhdGUgPiAwICYmIHJpbkN1cnJlbnRTdGF0ZSAlIDIgIT09IDApIHtcbiAgICAgICAgICAgIGNvbnN0IHJpblRyaWdnZXJTdGFnZSA9IChyaW5DdXJyZW50U3RhdGUgKyAxKSAvIDI7XG4gICAgICAgICAgICBjb25zdCByaW5MdXN0RXZlbnROYW1lID0gYnVpbGRSaW5MdXN0RXZlbnROYW1lKHJpblRyaWdnZXJTdGFnZSk7XG5cbiAgICAgICAgICAgIGF3YWl0IHNldFN0YXRWYWx1ZSh2YXJpYWJsZXMsICfkuJbnlYwu6ZqP5py65LqL5Lu2WzBdJywgcmluTHVzdEV2ZW50TmFtZSwgJ+WHm+a3q+WgleWAvOinpuWPkScpO1xuICAgICAgICAgICAgLy8g5qCH6K6w5bey6Kem5Y+R77ya55Sx5aWH5pWw77yI5b6F6Kem5Y+R77yJ5Y+Y5Li65YG25pWw77yI5bey6Kem5Y+R77yJXG4gICAgICAgICAgICBfLnNldCh2YXJpYWJsZXMsIGx1c3RTdGFnZVBhdGhPZign5YebJyksIHJpbkN1cnJlbnRTdGF0ZSArIDEpO1xuXG4gICAgICAgICAgICByZXR1cm47IC8vIOacrOi9ruS7heinpuWPkeS4gOS4quS6i+S7tlxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIOWGjeWwneivlVwi57Sr6Z+zXCLnmoTmt6vloJXkuovku7ZcbiAgICAgICAgaWYgKGNvbmZpZy5yb2xlRW5hYmxlZFsn57Sr6Z+zJ10pIHtcbiAgICAgICAgICBjb25zdCB6aXlpbkN1cnJlbnRTdGF0ZTogbnVtYmVyID0gXy5nZXQodmFyaWFibGVzLCBsdXN0U3RhZ2VQYXRoT2YoJ+e0q+mfsycpLCAwKSBhcyBudW1iZXI7XG4gICAgICAgICAgaWYgKHppeWluQ3VycmVudFN0YXRlID4gMCAmJiB6aXlpbkN1cnJlbnRTdGF0ZSAlIDIgIT09IDApIHtcbiAgICAgICAgICAgIGNvbnN0IHppeWluVHJpZ2dlclN0YWdlID0gKHppeWluQ3VycmVudFN0YXRlICsgMSkgLyAyO1xuICAgICAgICAgICAgY29uc3Qgeml5aW5MdXN0RXZlbnROYW1lID0gYnVpbGRaaXlpbkx1c3RFdmVudE5hbWUoeml5aW5UcmlnZ2VyU3RhZ2UpO1xuXG4gICAgICAgICAgICBhd2FpdCBzZXRTdGF0VmFsdWUodmFyaWFibGVzLCAn5LiW55WMLumaj+acuuS6i+S7tlswXScsIHppeWluTHVzdEV2ZW50TmFtZSwgJ+e0q+mfs+a3q+WgleWAvOinpuWPkScpO1xuICAgICAgICAgICAgLy8g57Sr6Z+z5rer5aCV6Zi25q61MuinpuWPkeaXtu+8jOiuvue9ruW/g+mtlOS4ujBcbiAgICAgICAgICAgIGlmICh6aXlpblRyaWdnZXJTdGFnZSA9PT0gMikge1xuICAgICAgICAgICAgICBhd2FpdCBzZXRTdGF0VmFsdWUodmFyaWFibGVzLCAn57Sr6Z+zLuW/g+mtlFswXScsIDAsICfntKvpn7Pmt6vloJXpmLbmrrUy6Kem5Y+RJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyDmoIforrDlt7Lop6blj5HvvJrnlLHlpYfmlbDvvIjlvoXop6blj5HvvInlj5jkuLrlgbbmlbDvvIjlt7Lop6blj5HvvIlcbiAgICAgICAgICAgIF8uc2V0KHZhcmlhYmxlcywgbHVzdFN0YWdlUGF0aE9mKCfntKvpn7MnKSwgeml5aW5DdXJyZW50U3RhdGUgKyAxKTtcblxuICAgICAgICAgICAgcmV0dXJuOyAvLyDmnKzova7ku4Xop6blj5HkuIDkuKrkuovku7ZcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyDlkKbliJnlsJ3or5Xop6blj5Hop5LoibLkuovku7ZcbiAgICAgICAgb3V0ZXI6IGZvciAoY29uc3Qgcm9sZSBvZiBST0xFUykge1xuICAgICAgICAgIGlmICghY29uZmlnLnJvbGVFbmFibGVkW3JvbGVdKSBjb250aW51ZTtcblxuICAgICAgICAgIGNvbnN0IGN1cnJlbnRTdGF0ZTogbnVtYmVyID0gXy5nZXQodmFyaWFibGVzLCBzdGFnZVBhdGhPZihyb2xlKSwgMCkgYXMgbnVtYmVyO1xuICAgICAgICAgIC8vIOeKtuaAgeWAvOS4uuWlh+aVsO+8jOihqOekuuKAnOW3sui+vuWIsOS9huacquinpuWPkeKAnVxuICAgICAgICAgIGlmIChjdXJyZW50U3RhdGUgPiAwICYmIGN1cnJlbnRTdGF0ZSAlIDIgIT09IDApIHtcbiAgICAgICAgICAgIGNvbnN0IHRyaWdnZXJTdGFnZSA9IChjdXJyZW50U3RhdGUgKyAxKSAvIDI7XG4gICAgICAgICAgICBjb25zdCBldmVudE5hbWUgPSBidWlsZEV2ZW50TmFtZShyb2xlLCB0cmlnZ2VyU3RhZ2UpO1xuXG4gICAgICAgICAgICBhd2FpdCBzZXRTdGF0VmFsdWUodmFyaWFibGVzLCAn5LiW55WMLumaj+acuuS6i+S7tlswXScsIGV2ZW50TmFtZSwgJ+WlveaEn+S6i+S7tuinpuWPkScpO1xuICAgICAgICAgICAgLy8g57Sr6Z+zIOesrOS4iemYtuaute+8iOS+v+WIqeW6l+Wco+Wls++8ieinpuWPkeaXtu+8jOS7heWcqOW/g+mtlOS4uuWIneWni+WAvDLml7borr7nva7lv4PprZTkuLogMVxuICAgICAgICAgICAgaWYgKHJvbGUgPT09ICfntKvpn7MnICYmIHRyaWdnZXJTdGFnZSA9PT0gMykge1xuICAgICAgICAgICAgICBjb25zdCBjdXJyZW50WGlubW8gPSBnZXRTdGF0VmFsdWU8bnVtYmVyPih2YXJpYWJsZXMsICfntKvpn7Mu5b+D6a2UWzBdJywgMik7XG4gICAgICAgICAgICAgIC8vIOWPquacieW/g+mtlOS4uuWIneWni+WAvDIo6KKr5b+D6a2U5Zuw5omwKeaXtuaJjeiuvue9ruS4ujEo5q2j5Zyo6Z2i5a+55b+D6a2UKe+8jOmBv+WFjeimhueblua3q+WgleS6i+S7tuiuvue9rueahDBcbiAgICAgICAgICAgICAgaWYgKGN1cnJlbnRYaW5tbyA9PT0gMikge1xuICAgICAgICAgICAgICAgIGF3YWl0IHNldFN0YXRWYWx1ZSh2YXJpYWJsZXMsICfntKvpn7Mu5b+D6a2UWzBdJywgMSwgJ+S+v+WIqeW6l+Wco+Wls+inpuWPkScpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyDnirbmgIErMe+8jOWPmOS4uuKAnOW3suinpuWPkeKAneeahOWBtuaVsOWAvO+8iOaYvuW8j+aMgeS5heWMlu+8iVxuICAgICAgICAgICAgXy5zZXQodmFyaWFibGVzLCBzdGFnZVBhdGhPZihyb2xlKSwgY3VycmVudFN0YXRlICsgMSk7XG5cbiAgICAgICAgICAgIGJyZWFrIG91dGVyOyAvLyDmr4/ova7lj6rop6blj5HkuIDkuKpcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW+WlveaEn+S6i+S7tuinpuWPkeWZqF0g6L+Q6KGM5Ye66ZSZOicsIGVycm9yKTtcbiAgfVxufVxuXG5ldmVudE9uKFxuICB0eXBlb2YgTXZ1ICE9PSAndW5kZWZpbmVkJyA/IE12dS5ldmVudHMuVkFSSUFCTEVfVVBEQVRFX0VOREVEIDogJ21hZ192YXJpYWJsZV91cGRhdGVfZW5kZWQnLFxuICB0cnlTeW5jU3RhZ2VzQW5kVHJpZ2dlckV2ZW50LFxuKTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/好感事件触发/index.ts\n\n}");
  }
};

var __webpack_module_cache__ = {};

function __webpack_require__(moduleId) {
  var cachedModule = __webpack_module_cache__[moduleId];
  if (cachedModule !== undefined) {
    return cachedModule.exports;
  }
  var module = __webpack_module_cache__[moduleId] = {
    exports: {}
  };
  __webpack_modules__[moduleId](module, module.exports, __webpack_require__);
  return module.exports;
}

(() => {
  __webpack_require__.d = (exports, definition) => {
    for (var key in definition) {
      if (__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
        Object.defineProperty(exports, key, {
          enumerable: true,
          get: definition[key]
        });
      }
    }
  };
})();

(() => {
  __webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);
})();

(() => {
  __webpack_require__.r = exports => {
    if (typeof Symbol !== "undefined" && Symbol.toStringTag) {
      Object.defineProperty(exports, Symbol.toStringTag, {
        value: "Module"
      });
    }
    Object.defineProperty(exports, "__esModule", {
      value: true
    });
  };
})();

var __webpack_exports__ = __webpack_require__("./src/好感事件触发/index.ts");