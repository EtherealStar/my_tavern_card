<!doctype html><html lang="zh-CN"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>雄小鬼大冒险</title><script src="https://fastly.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script><script type="module">/*! For license information please see index.js.LICENSE.txt */
var e={935:function(e,t,n){var r;e=n.nmd(e),function(){var i,o='Expected a function',a='__lodash_hash_undefined__',s='__lodash_placeholder__',c=16,u=32,l=64,d=128,f=256,h=1/0,p=9007199254740991,v=NaN,m=4294967295,g=[['ary',d],['bind',1],['bindKey',2],['curry',8],['curryRight',c],['flip',512],['partial',u],['partialRight',l],['rearg',f]],y='[object Arguments]',b='[object Array]',w='[object Boolean]',k='[object Date]',S='[object Error]',x='[object Function]',C='[object GeneratorFunction]',A='[object Map]',E='[object Number]',I='[object Object]',M='[object Promise]',L='[object RegExp]',T='[object Set]',P='[object String]',j='[object Symbol]',D='[object WeakMap]',O='[object ArrayBuffer]',B='[object DataView]',Z='[object Float32Array]',N='[object Float64Array]',R='[object Int8Array]',W='[object Int16Array]',G='[object Int32Array]',V='[object Uint8Array]',F='[object Uint8ClampedArray]',U='[object Uint16Array]',H='[object Uint32Array]',q=/\b__p \+= '';/g,J=/\b(__p \+=) '' \+/g,K=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Y=/&(?:amp|lt|gt|quot|#39);/g,X=/[&<>"']/g,Q=RegExp(Y.source),ee=RegExp(X.source),te=/<%-([\s\S]+?)%>/g,ne=/<%([\s\S]+?)%>/g,re=/<%=([\s\S]+?)%>/g,ie=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,oe=/^\w*$/,ae=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,se=/[\\^$.*+?()[\]{}|]/g,ce=RegExp(se.source),ue=/^\s+/,le=/\s/,de=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,fe=/\{\n\/\* \[wrapped with (.+)\] \*/,he=/,? & /,pe=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ve=/[()=,{}\[\]\/\s]/,me=/\\(\\)?/g,ge=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ye=/\w*$/,_e=/^[-+]0x[0-9a-f]+$/i,be=/^0b[01]+$/i,we=/^\[object .+?Constructor\]$/,ke=/^0o[0-7]+$/i,Se=/^(?:0|[1-9]\d*)$/,xe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ze=/($^)/,$e=/['\n\r\u2028\u2029\\]/g,Ce='\\ud800-\\udfff',Ae='\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff',Ee='\\u2700-\\u27bf',Ie='a-z\\xdf-\\xf6\\xf8-\\xff',Me='A-Z\\xc0-\\xd6\\xd8-\\xde',Le='\\ufe0e\\ufe0f',Te='\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000',Pe='[\'’]',je='['+Ce+']',De='['+Te+']',Oe='['+Ae+']',Be='\\d+',Ze='['+Ee+']',Ne='['+Ie+']',Re='[^'+Ce+Te+Be+Ee+Ie+Me+']',We='\\ud83c[\\udffb-\\udfff]',Ge='[^'+Ce+']',Ve='(?:\\ud83c[\\udde6-\\uddff]){2}',Fe='[\\ud800-\\udbff][\\udc00-\\udfff]',Ue='['+Me+']',He='\\u200d',qe='(?:'+Ne+'|'+Re+')',Je='(?:'+Ue+'|'+Re+')',Ke='(?:[\'’](?:d|ll|m|re|s|t|ve))?',Ye='(?:[\'’](?:D|LL|M|RE|S|T|VE))?',Xe='(?:'+Oe+'|'+We+')'+'?',Qe='['+Le+']?',et=Qe+Xe+('(?:'+He+'(?:'+[Ge,Ve,Fe].join('|')+')'+Qe+Xe+')*'),tt='(?:'+[Ze,Ve,Fe].join('|')+')'+et,nt='(?:'+[Ge+Oe+'?',Oe,Ve,Fe,je].join('|')+')',rt=RegExp(Pe,'g'),it=RegExp(Oe,'g'),ot=RegExp(We+'(?='+We+')|'+nt+et,'g'),at=RegExp([Ue+'?'+Ne+'+'+Ke+'(?='+[De,Ue,'$'].join('|')+')',Je+'+'+Ye+'(?='+[De,Ue+qe,'$'].join('|')+')',Ue+'?'+qe+'+'+Ke,Ue+'+'+Ye,'\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])','\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])',Be,tt].join('|'),'g'),st=RegExp('['+He+Ce+Ae+Le+']'),ct=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ut=['Array','Buffer','DataView','Date','Error','Float32Array','Float64Array','Function','Int8Array','Int16Array','Int32Array','Map','Math','Object','Promise','RegExp','Set','String','Symbol','TypeError','Uint8Array','Uint8ClampedArray','Uint16Array','Uint32Array','WeakMap','_','clearTimeout','isFinite','parseInt','setTimeout'],lt=-1,dt={};dt[Z]=dt[N]=dt[R]=dt[W]=dt[G]=dt[V]=dt[F]=dt[U]=dt[H]=!0,dt[y]=dt[b]=dt[O]=dt[w]=dt[B]=dt[k]=dt[S]=dt[x]=dt[A]=dt[E]=dt[I]=dt[L]=dt[T]=dt[P]=dt[D]=!1;var ft={};ft[y]=ft[b]=ft[O]=ft[B]=ft[w]=ft[k]=ft[Z]=ft[N]=ft[R]=ft[W]=ft[G]=ft[A]=ft[E]=ft[I]=ft[L]=ft[T]=ft[P]=ft[j]=ft[V]=ft[F]=ft[U]=ft[H]=!0,ft[S]=ft[x]=ft[D]=!1;var ht={'\\':'\\','\'':'\'','\n':'n','\r':'r','\u2028':'u2028','\u2029':'u2029'},pt=parseFloat,vt=parseInt,mt='object'==typeof n.g&&n.g&&n.g.Object===Object&&n.g,gt='object'==typeof self&&self&&self.Object===Object&&self,yt=mt||gt||Function('return this')(),_t=t&&!t.nodeType&&t,bt=_t&&e&&!e.nodeType&&e,wt=bt&&bt.exports===_t,kt=wt&&mt.process,St=function(){try{var e=bt&&bt.require&&bt.require('util').types;return e||kt&&kt.binding&&kt.binding('util')}catch(e){}}(),xt=St&&St.isArrayBuffer,zt=St&&St.isDate,$t=St&&St.isMap,Ct=St&&St.isRegExp,At=St&&St.isSet,Et=St&&St.isTypedArray;function It(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function Mt(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r}function Lt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function Tt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Pt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function jt(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}function Dt(e,t){return!!(null==e?0:e.length)&&Ut(e,t,0)>-1}function Ot(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function Bt(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function Zt(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function Nt(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function Rt(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function Wt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var Gt=Kt('length');function Vt(e,t,n){var r;return n(e,function(e,n,i){if(t(e,n,i))return r=n,!1}),r}function Ft(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function Ut(e,t,n){return t==t?function(e,t,n){var r=n-1,i=e.length;for(;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):Ft(e,qt,n)}function Ht(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function qt(e){return e!=e}function Jt(e,t){var n=null==e?0:e.length;return n?Qt(e,t)/n:v}function Kt(e){return function(t){return null==t?i:t[e]}}function Yt(e){return function(t){return null==e?i:e[t]}}function Xt(e,t,n,r,i){return i(e,function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)}),n}function Qt(e,t){for(var n,r=-1,o=e.length;++r<o;){var a=t(e[r]);a!==i&&(n=n===i?a:n+a)}return n}function en(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function tn(e){return e?e.slice(0,_n(e)+1).replace(ue,''):e}function nn(e){return function(t){return e(t)}}function rn(e,t){return Bt(t,function(t){return e[t]})}function on(e,t){return e.has(t)}function an(e,t){for(var n=-1,r=e.length;++n<r&&Ut(t,e[n],0)>-1;);return n}function sn(e,t){for(var n=e.length;n--&&Ut(t,e[n],0)>-1;);return n}var cn=Yt({À:'A',Á:'A',Â:'A',Ã:'A',Ä:'A',Å:'A',à:'a',á:'a',â:'a',ã:'a',ä:'a',å:'a',Ç:'C',ç:'c',Ð:'D',ð:'d',È:'E',É:'E',Ê:'E',Ë:'E',è:'e',é:'e',ê:'e',ë:'e',Ì:'I',Í:'I',Î:'I',Ï:'I',ì:'i',í:'i',î:'i',ï:'i',Ñ:'N',ñ:'n',Ò:'O',Ó:'O',Ô:'O',Õ:'O',Ö:'O',Ø:'O',ò:'o',ó:'o',ô:'o',õ:'o',ö:'o',ø:'o',Ù:'U',Ú:'U',Û:'U',Ü:'U',ù:'u',ú:'u',û:'u',ü:'u',Ý:'Y',ý:'y',ÿ:'y',Æ:'Ae',æ:'ae',Þ:'Th',þ:'th',ß:'ss',Ā:'A',Ă:'A',Ą:'A',ā:'a',ă:'a',ą:'a',Ć:'C',Ĉ:'C',Ċ:'C',Č:'C',ć:'c',ĉ:'c',ċ:'c',č:'c',Ď:'D',Đ:'D',ď:'d',đ:'d',Ē:'E',Ĕ:'E',Ė:'E',Ę:'E',Ě:'E',ē:'e',ĕ:'e',ė:'e',ę:'e',ě:'e',Ĝ:'G',Ğ:'G',Ġ:'G',Ģ:'G',ĝ:'g',ğ:'g',ġ:'g',ģ:'g',Ĥ:'H',Ħ:'H',ĥ:'h',ħ:'h',Ĩ:'I',Ī:'I',Ĭ:'I',Į:'I',İ:'I',ĩ:'i',ī:'i',ĭ:'i',į:'i',ı:'i',Ĵ:'J',ĵ:'j',Ķ:'K',ķ:'k',ĸ:'k',Ĺ:'L',Ļ:'L',Ľ:'L',Ŀ:'L',Ł:'L',ĺ:'l',ļ:'l',ľ:'l',ŀ:'l',ł:'l',Ń:'N',Ņ:'N',Ň:'N',Ŋ:'N',ń:'n',ņ:'n',ň:'n',ŋ:'n',Ō:'O',Ŏ:'O',Ő:'O',ō:'o',ŏ:'o',ő:'o',Ŕ:'R',Ŗ:'R',Ř:'R',ŕ:'r',ŗ:'r',ř:'r',Ś:'S',Ŝ:'S',Ş:'S',Š:'S',ś:'s',ŝ:'s',ş:'s',š:'s',Ţ:'T',Ť:'T',Ŧ:'T',ţ:'t',ť:'t',ŧ:'t',Ũ:'U',Ū:'U',Ŭ:'U',Ů:'U',Ű:'U',Ų:'U',ũ:'u',ū:'u',ŭ:'u',ů:'u',ű:'u',ų:'u',Ŵ:'W',ŵ:'w',Ŷ:'Y',ŷ:'y',Ÿ:'Y',Ź:'Z',Ż:'Z',Ž:'Z',ź:'z',ż:'z',ž:'z',Ĳ:'IJ',ĳ:'ij',Œ:'Oe',œ:'oe',ŉ:'\'n',ſ:'s'}),un=Yt({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'});function ln(e){return'\\'+ht[e]}function dn(e){return st.test(e)}function fn(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function hn(e,t){return function(n){return e(t(n))}}function pn(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n];a!==t&&a!==s||(e[n]=s,o[i++]=n)}return o}function vn(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function mn(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=[e,e]}),n}function gn(e){return dn(e)?function(e){var t=ot.lastIndex=0;for(;ot.test(e);)++t;return t}(e):Gt(e)}function yn(e){return dn(e)?function(e){return e.match(ot)||[]}(e):function(e){return e.split('')}(e)}function _n(e){for(var t=e.length;t--&&le.test(e.charAt(t)););return t}var bn=Yt({'&amp;':'&','&lt;':'<','&gt;':'>','&quot;':'"','&#39;':'\''});var _=function e(t){var n,r=(t=null==t?yt:_.defaults(yt.Object(),t,_.pick(yt,ut))).Array,le=t.Date,Ce=t.Error,Ae=t.Function,Ee=t.Math,Ie=t.Object,Me=t.RegExp,Le=t.String,Te=t.TypeError,Pe=r.prototype,je=Ae.prototype,De=Ie.prototype,Oe=t['__core-js_shared__'],Be=je.toString,Ze=De.hasOwnProperty,Ne=0,Re=(n=/[^.]+$/.exec(Oe&&Oe.keys&&Oe.keys.IE_PROTO||''))?'Symbol(src)_1.'+n:'',We=De.toString,Ge=Be.call(Ie),Ve=yt._,Fe=Me('^'+Be.call(Ze).replace(se,'\\$&').replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,'$1.*?')+'$'),Ue=wt?t.Buffer:i,He=t.Symbol,qe=t.Uint8Array,Je=Ue?Ue.allocUnsafe:i,Ke=hn(Ie.getPrototypeOf,Ie),Ye=Ie.create,Xe=De.propertyIsEnumerable,Qe=Pe.splice,et=He?He.isConcatSpreadable:i,tt=He?He.iterator:i,nt=He?He.toStringTag:i,ot=function(){try{var e=vo(Ie,'defineProperty');return e({},'',{}),e}catch(e){}}(),st=t.clearTimeout!==yt.clearTimeout&&t.clearTimeout,ht=le&&le.now!==yt.Date.now&&le.now,mt=t.setTimeout!==yt.setTimeout&&t.setTimeout,gt=Ee.ceil,_t=Ee.floor,bt=Ie.getOwnPropertySymbols,kt=Ue?Ue.isBuffer:i,St=t.isFinite,Gt=Pe.join,Yt=hn(Ie.keys,Ie),wn=Ee.max,kn=Ee.min,Sn=le.now,xn=t.parseInt,zn=Ee.random,$n=Pe.reverse,Cn=vo(t,'DataView'),An=vo(t,'Map'),En=vo(t,'Promise'),In=vo(t,'Set'),Mn=vo(t,'WeakMap'),Ln=vo(Ie,'create'),Tn=Mn&&new Mn,Pn={},jn=Ro(Cn),Dn=Ro(An),On=Ro(En),Bn=Ro(In),Zn=Ro(Mn),Nn=He?He.prototype:i,Rn=Nn?Nn.valueOf:i,Wn=Nn?Nn.toString:i;function Gn(e){if(is(e)&&!Ha(e)&&!(e instanceof Hn)){if(e instanceof Un)return e;if(Ze.call(e,'__wrapped__'))return Wo(e)}return new Un(e)}var Vn=function(){function e(){}return function(t){if(!rs(t))return{};if(Ye)return Ye(t);e.prototype=t;var n=new e;return e.prototype=i,n}}();function Fn(){}function Un(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}function Hn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=m,this.__views__=[]}function qn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Jn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Kn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Yn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Kn;++t<n;)this.add(e[t])}function Xn(e){var t=this.__data__=new Jn(e);this.size=t.size}function Qn(e,t){var n=Ha(e),r=!n&&Ua(e),i=!n&&!r&&Ya(e),o=!n&&!r&&!i&&fs(e),a=n||r||i||o,s=a?en(e.length,Le):[],c=s.length;for(var u in e)!t&&!Ze.call(e,u)||a&&('length'==u||i&&('offset'==u||'parent'==u)||o&&('buffer'==u||'byteLength'==u||'byteOffset'==u)||ko(u,c))||s.push(u);return s}function er(e){var t=e.length;return t?e[Yr(0,t-1)]:i}function tr(e,t){return Bo(Li(e),lr(t,0,e.length))}function nr(e){return Bo(Li(e))}function rr(e,t,n){(n!==i&&!Ga(e[t],n)||n===i&&!(t in e))&&cr(e,t,n)}function ir(e,t,n){var r=e[t];Ze.call(e,t)&&Ga(r,n)&&(n!==i||t in e)||cr(e,t,n)}function or(e,t){for(var n=e.length;n--;)if(Ga(e[n][0],t))return n;return-1}function ar(e,t,n,r){return vr(e,function(e,i,o){t(r,e,n(e),o)}),r}function sr(e,t){return e&&Ti(t,Ps(t),e)}function cr(e,t,n){'__proto__'==t&&ot?ot(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ur(e,t){for(var n=-1,o=t.length,a=r(o),s=null==e;++n<o;)a[n]=s?i:Es(e,t[n]);return a}function lr(e,t,n){return e==e&&(n!==i&&(e=e<=n?e:n),t!==i&&(e=e>=t?e:t)),e}function dr(e,t,n,r,o,a){var s,c=1&t,u=2&t,l=4&t;if(n&&(s=o?n(e,r,o,a):n(e)),s!==i)return s;if(!rs(e))return e;var d=Ha(e);if(d){if(s=function(e){var t=e.length,n=new e.constructor(t);t&&'string'==typeof e[0]&&Ze.call(e,'index')&&(n.index=e.index,n.input=e.input);return n}(e),!c)return Li(e,s)}else{var f=yo(e),h=f==x||f==C;if(Ya(e))return $i(e,c);if(f==I||f==y||h&&!o){if(s=u||h?{}:bo(e),!c)return u?function(e,t){return Ti(e,go(e),t)}(e,function(e,t){return e&&Ti(t,js(t),e)}(s,e)):function(e,t){return Ti(e,mo(e),t)}(e,sr(s,e))}else{if(!ft[f])return o?e:{};s=function(e,t,n){var r=e.constructor;switch(t){case O:return Ci(e);case w:case k:return new r(+e);case B:return function(e,t){var n=t?Ci(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case Z:case N:case R:case W:case G:case V:case F:case U:case H:return Ai(e,n);case A:return new r;case E:case P:return new r(e);case L:return function(e){var t=new e.constructor(e.source,ye.exec(e));return t.lastIndex=e.lastIndex,t}(e);case T:return new r;case j:return function(e){return Rn?Ie(Rn.call(e)):{}}(e)}}(e,f,c)}}a||(a=new Xn);var p=a.get(e);if(p)return p;a.set(e,s),us(e)?e.forEach(function(r){s.add(dr(r,t,n,r,e,a))}):os(e)&&e.forEach(function(r,i){s.set(i,dr(r,t,n,i,e,a))});var v=d?i:(l?u?so:ao:u?js:Ps)(e);return Lt(v||e,function(r,i){v&&(r=e[i=r]),ir(s,i,dr(r,t,n,i,e,a))}),s}function fr(e,t,n){var r=n.length;if(null==e)return!r;for(e=Ie(e);r--;){var o=n[r],a=t[o],s=e[o];if(s===i&&!(o in e)||!a(s))return!1}return!0}function hr(e,t,n){if('function'!=typeof e)throw new Te(o);return Po(function(){e.apply(i,n)},t)}function pr(e,t,n,r){var i=-1,o=Dt,a=!0,s=e.length,c=[],u=t.length;if(!s)return c;n&&(t=Bt(t,nn(n))),r?(o=Ot,a=!1):t.length>=200&&(o=on,a=!1,t=new Yn(t));e:for(;++i<s;){var l=e[i],d=null==n?l:n(l);if(l=r||0!==l?l:0,a&&d==d){for(var f=u;f--;)if(t[f]===d)continue e;c.push(l)}else o(t,d,r)||c.push(l)}return c}Gn.templateSettings={escape:te,evaluate:ne,interpolate:re,variable:'',imports:{_:Gn}},Gn.prototype=Fn.prototype,Gn.prototype.constructor=Gn,Un.prototype=Vn(Fn.prototype),Un.prototype.constructor=Un,Hn.prototype=Vn(Fn.prototype),Hn.prototype.constructor=Hn,qn.prototype.clear=function(){this.__data__=Ln?Ln(null):{},this.size=0},qn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},qn.prototype.get=function(e){var t=this.__data__;if(Ln){var n=t[e];return n===a?i:n}return Ze.call(t,e)?t[e]:i},qn.prototype.has=function(e){var t=this.__data__;return Ln?t[e]!==i:Ze.call(t,e)},qn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Ln&&t===i?a:t,this},Jn.prototype.clear=function(){this.__data__=[],this.size=0},Jn.prototype.delete=function(e){var t=this.__data__,n=or(t,e);return!(n<0)&&(n==t.length-1?t.pop():Qe.call(t,n,1),--this.size,!0)},Jn.prototype.get=function(e){var t=this.__data__,n=or(t,e);return n<0?i:t[n][1]},Jn.prototype.has=function(e){return or(this.__data__,e)>-1},Jn.prototype.set=function(e,t){var n=this.__data__,r=or(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Kn.prototype.clear=function(){this.size=0,this.__data__={hash:new qn,map:new(An||Jn),string:new qn}},Kn.prototype.delete=function(e){var t=ho(this,e).delete(e);return this.size-=t?1:0,t},Kn.prototype.get=function(e){return ho(this,e).get(e)},Kn.prototype.has=function(e){return ho(this,e).has(e)},Kn.prototype.set=function(e,t){var n=ho(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Yn.prototype.add=Yn.prototype.push=function(e){return this.__data__.set(e,a),this},Yn.prototype.has=function(e){return this.__data__.has(e)},Xn.prototype.clear=function(){this.__data__=new Jn,this.size=0},Xn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Xn.prototype.get=function(e){return this.__data__.get(e)},Xn.prototype.has=function(e){return this.__data__.has(e)},Xn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Jn){var r=n.__data__;if(!An||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Kn(r)}return n.set(e,t),this.size=n.size,this};var vr=Di(Sr),mr=Di(xr,!0);function gr(e,t){var n=!0;return vr(e,function(e,r,i){return n=!!t(e,r,i)}),n}function yr(e,t,n){for(var r=-1,o=e.length;++r<o;){var a=e[r],s=t(a);if(null!=s&&(c===i?s==s&&!ds(s):n(s,c)))var c=s,u=a}return u}function _r(e,t){var n=[];return vr(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n}function br(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=wo),i||(i=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?br(s,t-1,n,r,i):Zt(i,s):r||(i[i.length]=s)}return i}var wr=Oi(),kr=Oi(!0);function Sr(e,t){return e&&wr(e,t,Ps)}function xr(e,t){return e&&kr(e,t,Ps)}function zr(e,t){return jt(t,function(t){return es(e[t])})}function $r(e,t){for(var n=0,r=(t=ki(t,e)).length;null!=e&&n<r;)e=e[No(t[n++])];return n&&n==r?e:i}function Cr(e,t,n){var r=t(e);return Ha(e)?r:Zt(r,n(e))}function Ar(e){return null==e?e===i?'[object Undefined]':'[object Null]':nt&&nt in Ie(e)?function(e){var t=Ze.call(e,nt),n=e[nt];try{e[nt]=i;var r=!0}catch(e){}var o=We.call(e);r&&(t?e[nt]=n:delete e[nt]);return o}(e):function(e){return We.call(e)}(e)}function Er(e,t){return e>t}function Ir(e,t){return null!=e&&Ze.call(e,t)}function Mr(e,t){return null!=e&&t in Ie(e)}function Lr(e,t,n){for(var o=n?Ot:Dt,a=e[0].length,s=e.length,c=s,u=r(s),l=1/0,d=[];c--;){var f=e[c];c&&t&&(f=Bt(f,nn(t))),l=kn(f.length,l),u[c]=!n&&(t||a>=120&&f.length>=120)?new Yn(c&&f):i}f=e[0];var h=-1,p=u[0];e:for(;++h<a&&d.length<l;){var v=f[h],m=t?t(v):v;if(v=n||0!==v?v:0,!(p?on(p,m):o(d,m,n))){for(c=s;--c;){var g=u[c];if(!(g?on(g,m):o(e[c],m,n)))continue e}p&&p.push(m),d.push(v)}}return d}function Tr(e,t,n){var r=null==(e=Mo(e,t=ki(t,e)))?e:e[No(Qo(t))];return null==r?i:It(r,e,n)}function Pr(e){return is(e)&&Ar(e)==y}function jr(e,t,n,r,o){return e===t||(null==e||null==t||!is(e)&&!is(t)?e!=e&&t!=t:function(e,t,n,r,o,a){var s=Ha(e),c=Ha(t),u=s?b:yo(e),l=c?b:yo(t),d=(u=u==y?I:u)==I,f=(l=l==y?I:l)==I,h=u==l;if(h&&Ya(e)){if(!Ya(t))return!1;s=!0,d=!1}if(h&&!d)return a||(a=new Xn),s||fs(e)?io(e,t,n,r,o,a):function(e,t,n,r,i,o,a){switch(n){case B:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case O:return!(e.byteLength!=t.byteLength||!o(new qe(e),new qe(t)));case w:case k:case E:return Ga(+e,+t);case S:return e.name==t.name&&e.message==t.message;case L:case P:return e==t+'';case A:var s=fn;case T:var c=1&r;if(s||(s=vn),e.size!=t.size&&!c)return!1;var u=a.get(e);if(u)return u==t;r|=2,a.set(e,t);var l=io(s(e),s(t),r,i,o,a);return a.delete(e),l;case j:if(Rn)return Rn.call(e)==Rn.call(t)}return!1}(e,t,u,n,r,o,a);if(!(1&n)){var p=d&&Ze.call(e,'__wrapped__'),v=f&&Ze.call(t,'__wrapped__');if(p||v){var m=p?e.value():e,g=v?t.value():t;return a||(a=new Xn),o(m,g,n,r,a)}}if(!h)return!1;return a||(a=new Xn),function(e,t,n,r,o,a){var s=1&n,c=ao(e),u=c.length,l=ao(t),d=l.length;if(u!=d&&!s)return!1;var f=u;for(;f--;){var h=c[f];if(!(s?h in t:Ze.call(t,h)))return!1}var p=a.get(e),v=a.get(t);if(p&&v)return p==t&&v==e;var m=!0;a.set(e,t),a.set(t,e);var g=s;for(;++f<u;){var y=e[h=c[f]],b=t[h];if(r)var w=s?r(b,y,h,t,e,a):r(y,b,h,e,t,a);if(!(w===i?y===b||o(y,b,n,r,a):w)){m=!1;break}g||(g='constructor'==h)}if(m&&!g){var k=e.constructor,S=t.constructor;k==S||!('constructor'in e)||!('constructor'in t)||'function'==typeof k&&k instanceof k&&'function'==typeof S&&S instanceof S||(m=!1)}return a.delete(e),a.delete(t),m}(e,t,n,r,o,a)}(e,t,n,r,jr,o))}function Dr(e,t,n,r){var o=n.length,a=o,s=!r;if(null==e)return!a;for(e=Ie(e);o--;){var c=n[o];if(s&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++o<a;){var u=(c=n[o])[0],l=e[u],d=c[1];if(s&&c[2]){if(l===i&&!(u in e))return!1}else{var f=new Xn;if(r)var h=r(l,d,u,e,t,f);if(!(h===i?jr(d,l,3,r,f):h))return!1}}return!0}function Or(e){return!(!rs(e)||(t=e,Re&&Re in t))&&(es(e)?Fe:we).test(Ro(e));var t}function Br(e){return'function'==typeof e?e:null==e?ac:'object'==typeof e?Ha(e)?Vr(e[0],e[1]):Gr(e):vc(e)}function Zr(e){if(!Co(e))return Yt(e);var t=[];for(var n in Ie(e))Ze.call(e,n)&&'constructor'!=n&&t.push(n);return t}function Nr(e){if(!rs(e))return function(e){var t=[];if(null!=e)for(var n in Ie(e))t.push(n);return t}(e);var t=Co(e),n=[];for(var r in e)('constructor'!=r||!t&&Ze.call(e,r))&&n.push(r);return n}function Rr(e,t){return e<t}function Wr(e,t){var n=-1,i=Ja(e)?r(e.length):[];return vr(e,function(e,r,o){i[++n]=t(e,r,o)}),i}function Gr(e){var t=po(e);return 1==t.length&&t[0][2]?Eo(t[0][0],t[0][1]):function(n){return n===e||Dr(n,e,t)}}function Vr(e,t){return xo(e)&&Ao(t)?Eo(No(e),t):function(n){var r=Es(n,e);return r===i&&r===t?Is(n,e):jr(t,r,3)}}function Fr(e,t,n,r,o){e!==t&&wr(t,function(a,s){if(o||(o=new Xn),rs(a))!function(e,t,n,r,o,a,s){var c=Lo(e,n),u=Lo(t,n),l=s.get(u);if(l)return void rr(e,n,l);var d=a?a(c,u,n+'',e,t,s):i,f=d===i;if(f){var h=Ha(u),p=!h&&Ya(u),v=!h&&!p&&fs(u);d=u,h||p||v?Ha(c)?d=c:Ka(c)?d=Li(c):p?(f=!1,d=$i(u,!0)):v?(f=!1,d=Ai(u,!0)):d=[]:ss(u)||Ua(u)?(d=c,Ua(c)?d=bs(c):rs(c)&&!es(c)||(d=bo(u))):f=!1}f&&(s.set(u,d),o(d,u,r,a,s),s.delete(u));rr(e,n,d)}(e,t,s,n,Fr,r,o);else{var c=r?r(Lo(e,s),a,s+'',e,t,o):i;c===i&&(c=a),rr(e,s,c)}},js)}function Ur(e,t){var n=e.length;if(n)return ko(t+=t<0?n:0,n)?e[t]:i}function Hr(e,t,n){t=t.length?Bt(t,function(e){return Ha(e)?function(t){return $r(t,1===e.length?e[0]:e)}:e}):[ac];var r=-1;t=Bt(t,nn(fo()));var i=Wr(e,function(e,n,i){var o=Bt(t,function(t){return t(e)});return{criteria:o,index:++r,value:e}});return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(i,function(e,t){return function(e,t,n){var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;for(;++r<a;){var c=Ei(i[r],o[r]);if(c)return r>=s?c:c*('desc'==n[r]?-1:1)}return e.index-t.index}(e,t,n)})}function qr(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],s=$r(e,a);n(s,a)&&ni(o,ki(a,e),s)}return o}function Jr(e,t,n,r){var i=r?Ht:Ut,o=-1,a=t.length,s=e;for(e===t&&(t=Li(t)),n&&(s=Bt(e,nn(n)));++o<a;)for(var c=0,u=t[o],l=n?n(u):u;(c=i(s,l,c,r))>-1;)s!==e&&Qe.call(s,c,1),Qe.call(e,c,1);return e}function Kr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;ko(i)?Qe.call(e,i,1):pi(e,i)}}return e}function Yr(e,t){return e+_t(zn()*(t-e+1))}function Xr(e,t){var n='';if(!e||t<1||t>p)return n;do{t%2&&(n+=e),(t=_t(t/2))&&(e+=e)}while(t);return n}function Qr(e,t){return jo(Io(e,t,ac),e+'')}function ei(e){return er(Gs(e))}function ti(e,t){var n=Gs(e);return Bo(n,lr(t,0,n.length))}function ni(e,t,n,r){if(!rs(e))return e;for(var o=-1,a=(t=ki(t,e)).length,s=a-1,c=e;null!=c&&++o<a;){var u=No(t[o]),l=n;if('__proto__'===u||'constructor'===u||'prototype'===u)return e;if(o!=s){var d=c[u];(l=r?r(d,u,c):i)===i&&(l=rs(d)?d:ko(t[o+1])?[]:{})}ir(c,u,l),c=c[u]}return e}var ri=Tn?function(e,t){return Tn.set(e,t),e}:ac,ii=ot?function(e,t){return ot(e,'toString',{configurable:!0,enumerable:!1,value:rc(t),writable:!0})}:ac;function oi(e){return Bo(Gs(e))}function ai(e,t,n){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var a=r(o);++i<o;)a[i]=e[i+t];return a}function si(e,t){var n;return vr(e,function(e,r,i){return!(n=t(e,r,i))}),!!n}function ci(e,t,n){var r=0,i=null==e?r:e.length;if('number'==typeof t&&t==t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,a=e[o];null!==a&&!ds(a)&&(n?a<=t:a<t)?r=o+1:i=o}return i}return ui(e,t,ac,n)}function ui(e,t,n,r){var o=0,a=null==e?0:e.length;if(0===a)return 0;for(var s=(t=n(t))!=t,c=null===t,u=ds(t),l=t===i;o<a;){var d=_t((o+a)/2),f=n(e[d]),h=f!==i,p=null===f,v=f==f,m=ds(f);if(s)var g=r||v;else g=l?v&&(r||h):c?v&&h&&(r||!p):u?v&&h&&!p&&(r||!m):!p&&!m&&(r?f<=t:f<t);g?o=d+1:a=d}return kn(a,4294967294)}function li(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n],s=t?t(a):a;if(!n||!Ga(s,c)){var c=s;o[i++]=0===a?0:a}}return o}function di(e){return'number'==typeof e?e:ds(e)?v:+e}function fi(e){if('string'==typeof e)return e;if(Ha(e))return Bt(e,fi)+'';if(ds(e))return Wn?Wn.call(e):'';var t=e+'';return'0'==t&&1/e==-1/0?'-0':t}function hi(e,t,n){var r=-1,i=Dt,o=e.length,a=!0,s=[],c=s;if(n)a=!1,i=Ot;else if(o>=200){var u=t?null:Xi(e);if(u)return vn(u);a=!1,i=on,c=new Yn}else c=t?[]:s;e:for(;++r<o;){var l=e[r],d=t?t(l):l;if(l=n||0!==l?l:0,a&&d==d){for(var f=c.length;f--;)if(c[f]===d)continue e;t&&c.push(d),s.push(l)}else i(c,d,n)||(c!==s&&c.push(d),s.push(l))}return s}function pi(e,t){return null==(e=Mo(e,t=ki(t,e)))||delete e[No(Qo(t))]}function vi(e,t,n,r){return ni(e,t,n($r(e,t)),r)}function mi(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?ai(e,r?0:o,r?o+1:i):ai(e,r?o+1:0,r?i:o)}function gi(e,t){var n=e;return n instanceof Hn&&(n=n.value()),Nt(t,function(e,t){return t.func.apply(t.thisArg,Zt([e],t.args))},n)}function yi(e,t,n){var i=e.length;if(i<2)return i?hi(e[0]):[];for(var o=-1,a=r(i);++o<i;)for(var s=e[o],c=-1;++c<i;)c!=o&&(a[o]=pr(a[o]||s,e[c],t,n));return hi(br(a,1),t,n)}function _i(e,t,n){for(var r=-1,o=e.length,a=t.length,s={};++r<o;){var c=r<a?t[r]:i;n(s,e[r],c)}return s}function bi(e){return Ka(e)?e:[]}function wi(e){return'function'==typeof e?e:ac}function ki(e,t){return Ha(e)?e:xo(e,t)?[e]:Zo(ws(e))}var Si=Qr;function xi(e,t,n){var r=e.length;return n=n===i?r:n,!t&&n>=r?e:ai(e,t,n)}var zi=st||function(e){return yt.clearTimeout(e)};function $i(e,t){if(t)return e.slice();var n=e.length,r=Je?Je(n):new e.constructor(n);return e.copy(r),r}function Ci(e){var t=new e.constructor(e.byteLength);return new qe(t).set(new qe(e)),t}function Ai(e,t){var n=t?Ci(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Ei(e,t){if(e!==t){var n=e!==i,r=null===e,o=e==e,a=ds(e),s=t!==i,c=null===t,u=t==t,l=ds(t);if(!c&&!l&&!a&&e>t||a&&s&&u&&!c&&!l||r&&s&&u||!n&&u||!o)return 1;if(!r&&!a&&!l&&e<t||l&&n&&o&&!r&&!a||c&&n&&o||!s&&o||!u)return-1}return 0}function Ii(e,t,n,i){for(var o=-1,a=e.length,s=n.length,c=-1,u=t.length,l=wn(a-s,0),d=r(u+l),f=!i;++c<u;)d[c]=t[c];for(;++o<s;)(f||o<a)&&(d[n[o]]=e[o]);for(;l--;)d[c++]=e[o++];return d}function Mi(e,t,n,i){for(var o=-1,a=e.length,s=-1,c=n.length,u=-1,l=t.length,d=wn(a-c,0),f=r(d+l),h=!i;++o<d;)f[o]=e[o];for(var p=o;++u<l;)f[p+u]=t[u];for(;++s<c;)(h||o<a)&&(f[p+n[s]]=e[o++]);return f}function Li(e,t){var n=-1,i=e.length;for(t||(t=r(i));++n<i;)t[n]=e[n];return t}function Ti(e,t,n,r){var o=!n;n||(n={});for(var a=-1,s=t.length;++a<s;){var c=t[a],u=r?r(n[c],e[c],c,n,e):i;u===i&&(u=e[c]),o?cr(n,c,u):ir(n,c,u)}return n}function Pi(e,t){return function(n,r){var i=Ha(n)?Mt:ar,o=t?t():{};return i(n,e,fo(r,2),o)}}function ji(e){return Qr(function(t,n){var r=-1,o=n.length,a=o>1?n[o-1]:i,s=o>2?n[2]:i;for(a=e.length>3&&'function'==typeof a?(o--,a):i,s&&So(n[0],n[1],s)&&(a=o<3?i:a,o=1),t=Ie(t);++r<o;){var c=n[r];c&&e(t,c,r,a)}return t})}function Di(e,t){return function(n,r){if(null==n)return n;if(!Ja(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=Ie(n);(t?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function Oi(e){return function(t,n,r){for(var i=-1,o=Ie(t),a=r(t),s=a.length;s--;){var c=a[e?s:++i];if(!1===n(o[c],c,o))break}return t}}function Bi(e){return function(t){var n=dn(t=ws(t))?yn(t):i,r=n?n[0]:t.charAt(0),o=n?xi(n,1).join(''):t.slice(1);return r[e]()+o}}function Zi(e){return function(t){return Nt(ec(Us(t).replace(rt,'')),e,'')}}function Ni(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Vn(e.prototype),r=e.apply(n,t);return rs(r)?r:n}}function Ri(e){return function(t,n,r){var o=Ie(t);if(!Ja(t)){var a=fo(n,3);t=Ps(t),n=function(e){return a(o[e],e,o)}}var s=e(t,n,r);return s>-1?o[a?t[s]:s]:i}}function Wi(e){return oo(function(t){var n=t.length,r=n,a=Un.prototype.thru;for(e&&t.reverse();r--;){var s=t[r];if('function'!=typeof s)throw new Te(o);if(a&&!c&&'wrapper'==uo(s))var c=new Un([],!0)}for(r=c?r:n;++r<n;){var u=uo(s=t[r]),l='wrapper'==u?co(s):i;c=l&&zo(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?c[uo(l[0])].apply(c,l[3]):1==s.length&&zo(s)?c[u]():c.thru(s)}return function(){var e=arguments,r=e[0];if(c&&1==e.length&&Ha(r))return c.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}})}function Gi(e,t,n,o,a,s,c,u,l,f){var h=t&d,p=1&t,v=2&t,m=24&t,g=512&t,y=v?i:Ni(e);return function d(){for(var b=arguments.length,w=r(b),k=b;k--;)w[k]=arguments[k];if(m)var S=lo(d),x=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(w,S);if(o&&(w=Ii(w,o,a,m)),s&&(w=Mi(w,s,c,m)),b-=x,m&&b<f){var C=pn(w,S);return Ki(e,t,Gi,d.placeholder,n,w,C,u,l,f-b)}var A=p?n:this,E=v?A[e]:e;return b=w.length,u?w=function(e,t){var n=e.length,r=kn(t.length,n),o=Li(e);for(;r--;){var a=t[r];e[r]=ko(a,n)?o[a]:i}return e}(w,u):g&&b>1&&w.reverse(),h&&l<b&&(w.length=l),this&&this!==yt&&this instanceof d&&(E=y||Ni(E)),E.apply(A,w)}}function Vi(e,t){return function(n,r){return function(e,t,n,r){return Sr(e,function(e,i,o){t(r,n(e),i,o)}),r}(n,e,t(r),{})}}function Fi(e,t){return function(n,r){var o;if(n===i&&r===i)return t;if(n!==i&&(o=n),r!==i){if(o===i)return r;'string'==typeof n||'string'==typeof r?(n=fi(n),r=fi(r)):(n=di(n),r=di(r)),o=e(n,r)}return o}}function Ui(e){return oo(function(t){return t=Bt(t,nn(fo())),Qr(function(n){var r=this;return e(t,function(e){return It(e,r,n)})})})}function Hi(e,t){var n=(t=t===i?' ':fi(t)).length;if(n<2)return n?Xr(t,e):t;var r=Xr(t,gt(e/gn(t)));return dn(t)?xi(yn(r),0,e).join(''):r.slice(0,e)}function qi(e){return function(t,n,o){return o&&'number'!=typeof o&&So(t,n,o)&&(n=o=i),t=ms(t),n===i?(n=t,t=0):n=ms(n),function(e,t,n,i){for(var o=-1,a=wn(gt((t-e)/(n||1)),0),s=r(a);a--;)s[i?a:++o]=e,e+=n;return s}(t,n,o=o===i?t<n?1:-1:ms(o),e)}}function Ji(e){return function(t,n){return'string'==typeof t&&'string'==typeof n||(t=_s(t),n=_s(n)),e(t,n)}}function Ki(e,t,n,r,o,a,s,c,d,f){var h=8&t;t|=h?u:l,4&(t&=~(h?l:u))||(t&=-4);var p=[e,t,o,h?a:i,h?s:i,h?i:a,h?i:s,c,d,f],v=n.apply(i,p);return zo(e)&&To(v,p),v.placeholder=r,Do(v,e,t)}function Yi(e){var t=Ee[e];return function(e,n){if(e=_s(e),(n=null==n?0:kn(gs(n),292))&&St(e)){var r=(ws(e)+'e').split('e');return+((r=(ws(t(r[0]+'e'+(+r[1]+n)))+'e').split('e'))[0]+'e'+(+r[1]-n))}return t(e)}}var Xi=In&&1/vn(new In([,-0]))[1]==h?function(e){return new In(e)}:dc;function Qi(e){return function(t){var n=yo(t);return n==A?fn(t):n==T?mn(t):function(e,t){return Bt(t,function(t){return[t,e[t]]})}(t,e(t))}}function eo(e,t,n,a,h,p,v,m){var g=2&t;if(!g&&'function'!=typeof e)throw new Te(o);var y=a?a.length:0;if(y||(t&=-97,a=h=i),v=v===i?v:wn(gs(v),0),m=m===i?m:gs(m),y-=h?h.length:0,t&l){var b=a,w=h;a=h=i}var k=g?i:co(e),S=[e,t,n,a,h,b,w,p,v,m];if(k&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,a=r==d&&8==n||r==d&&n==f&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!a)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var c=t[3];if(c){var u=e[3];e[3]=u?Ii(u,c,t[4]):c,e[4]=u?pn(e[3],s):t[4]}(c=t[5])&&(u=e[5],e[5]=u?Mi(u,c,t[6]):c,e[6]=u?pn(e[5],s):t[6]);(c=t[7])&&(e[7]=c);r&d&&(e[8]=null==e[8]?t[8]:kn(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=i}(S,k),e=S[0],t=S[1],n=S[2],a=S[3],h=S[4],!(m=S[9]=S[9]===i?g?0:e.length:wn(S[9]-y,0))&&24&t&&(t&=-25),t&&1!=t)x=8==t||t==c?function(e,t,n){var o=Ni(e);return function a(){for(var s=arguments.length,c=r(s),u=s,l=lo(a);u--;)c[u]=arguments[u];var d=s<3&&c[0]!==l&&c[s-1]!==l?[]:pn(c,l);return(s-=d.length)<n?Ki(e,t,Gi,a.placeholder,i,c,d,i,i,n-s):It(this&&this!==yt&&this instanceof a?o:e,this,c)}}(e,t,m):t!=u&&33!=t||h.length?Gi.apply(i,S):function(e,t,n,i){var o=1&t,a=Ni(e);return function t(){for(var s=-1,c=arguments.length,u=-1,l=i.length,d=r(l+c),f=this&&this!==yt&&this instanceof t?a:e;++u<l;)d[u]=i[u];for(;c--;)d[u++]=arguments[++s];return It(f,o?n:this,d)}}(e,t,n,a);else var x=function(e,t,n){var r=1&t,i=Ni(e);return function t(){return(this&&this!==yt&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,n);return Do((k?ri:To)(x,S),e,t)}function to(e,t,n,r){return e===i||Ga(e,De[n])&&!Ze.call(r,n)?t:e}function no(e,t,n,r,o,a){return rs(e)&&rs(t)&&(a.set(t,e),Fr(e,t,i,no,a),a.delete(t)),e}function ro(e){return ss(e)?i:e}function io(e,t,n,r,o,a){var s=1&n,c=e.length,u=t.length;if(c!=u&&!(s&&u>c))return!1;var l=a.get(e),d=a.get(t);if(l&&d)return l==t&&d==e;var f=-1,h=!0,p=2&n?new Yn:i;for(a.set(e,t),a.set(t,e);++f<c;){var v=e[f],m=t[f];if(r)var g=s?r(m,v,f,t,e,a):r(v,m,f,e,t,a);if(g!==i){if(g)continue;h=!1;break}if(p){if(!Wt(t,function(e,t){if(!on(p,t)&&(v===e||o(v,e,n,r,a)))return p.push(t)})){h=!1;break}}else if(v!==m&&!o(v,m,n,r,a)){h=!1;break}}return a.delete(e),a.delete(t),h}function oo(e){return jo(Io(e,i,qo),e+'')}function ao(e){return Cr(e,Ps,mo)}function so(e){return Cr(e,js,go)}var co=Tn?function(e){return Tn.get(e)}:dc;function uo(e){for(var t=e.name+'',n=Pn[t],r=Ze.call(Pn,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function lo(e){return(Ze.call(Gn,'placeholder')?Gn:e).placeholder}function fo(){var e=Gn.iteratee||sc;return e=e===sc?Br:e,arguments.length?e(arguments[0],arguments[1]):e}function ho(e,t){var n,r,i=e.__data__;return('string'==(r=typeof(n=t))||'number'==r||'symbol'==r||'boolean'==r?'__proto__'!==n:null===n)?i['string'==typeof t?'string':'hash']:i.map}function po(e){for(var t=Ps(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,Ao(i)]}return t}function vo(e,t){var n=function(e,t){return null==e?i:e[t]}(e,t);return Or(n)?n:i}var mo=bt?function(e){return null==e?[]:(e=Ie(e),jt(bt(e),function(t){return Xe.call(e,t)}))}:yc,go=bt?function(e){for(var t=[];e;)Zt(t,mo(e)),e=Ke(e);return t}:yc,yo=Ar;function _o(e,t,n){for(var r=-1,i=(t=ki(t,e)).length,o=!1;++r<i;){var a=No(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&ns(i)&&ko(a,i)&&(Ha(e)||Ua(e))}function bo(e){return'function'!=typeof e.constructor||Co(e)?{}:Vn(Ke(e))}function wo(e){return Ha(e)||Ua(e)||!!(et&&e&&e[et])}function ko(e,t){var n=typeof e;return!!(t=null==t?p:t)&&('number'==n||'symbol'!=n&&Se.test(e))&&e>-1&&e%1==0&&e<t}function So(e,t,n){if(!rs(n))return!1;var r=typeof t;return!!('number'==r?Ja(n)&&ko(t,n.length):'string'==r&&t in n)&&Ga(n[t],e)}function xo(e,t){if(Ha(e))return!1;var n=typeof e;return!('number'!=n&&'symbol'!=n&&'boolean'!=n&&null!=e&&!ds(e))||(oe.test(e)||!ie.test(e)||null!=t&&e in Ie(t))}function zo(e){var t=uo(e),n=Gn[t];if('function'!=typeof n||!(t in Hn.prototype))return!1;if(e===n)return!0;var r=co(n);return!!r&&e===r[0]}(Cn&&yo(new Cn(new ArrayBuffer(1)))!=B||An&&yo(new An)!=A||En&&yo(En.resolve())!=M||In&&yo(new In)!=T||Mn&&yo(new Mn)!=D)&&(yo=function(e){var t=Ar(e),n=t==I?e.constructor:i,r=n?Ro(n):'';if(r)switch(r){case jn:return B;case Dn:return A;case On:return M;case Bn:return T;case Zn:return D}return t});var $o=Oe?es:_c;function Co(e){var t=e&&e.constructor;return e===('function'==typeof t&&t.prototype||De)}function Ao(e){return e==e&&!rs(e)}function Eo(e,t){return function(n){return null!=n&&(n[e]===t&&(t!==i||e in Ie(n)))}}function Io(e,t,n){return t=wn(t===i?e.length-1:t,0),function(){for(var i=arguments,o=-1,a=wn(i.length-t,0),s=r(a);++o<a;)s[o]=i[t+o];o=-1;for(var c=r(t+1);++o<t;)c[o]=i[o];return c[t]=n(s),It(e,this,c)}}function Mo(e,t){return t.length<2?e:$r(e,ai(t,0,-1))}function Lo(e,t){if(('constructor'!==t||'function'!=typeof e[t])&&'__proto__'!=t)return e[t]}var To=Oo(ri),Po=mt||function(e,t){return yt.setTimeout(e,t)},jo=Oo(ii);function Do(e,t,n){var r=t+'';return jo(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?'& ':'')+t[r],t=t.join(n>2?', ':' '),e.replace(de,'{\n/* [wrapped with '+t+'] */\n')}(r,function(e,t){return Lt(g,function(n){var r='_.'+n[0];t&n[1]&&!Dt(e,r)&&e.push(r)}),e.sort()}(function(e){var t=e.match(fe);return t?t[1].split(he):[]}(r),n)))}function Oo(e){var t=0,n=0;return function(){var r=Sn(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(i,arguments)}}function Bo(e,t){var n=-1,r=e.length,o=r-1;for(t=t===i?r:t;++n<t;){var a=Yr(n,o),s=e[a];e[a]=e[n],e[n]=s}return e.length=t,e}var Zo=function(e){var t=Oa(e,function(e){return 500===n.size&&n.clear(),e}),n=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(''),e.replace(ae,function(e,n,r,i){t.push(r?i.replace(me,'$1'):n||e)}),t});function No(e){if('string'==typeof e||ds(e))return e;var t=e+'';return'0'==t&&1/e==-1/0?'-0':t}function Ro(e){if(null!=e){try{return Be.call(e)}catch(e){}try{return e+''}catch(e){}}return''}function Wo(e){if(e instanceof Hn)return e.clone();var t=new Un(e.__wrapped__,e.__chain__);return t.__actions__=Li(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Go=Qr(function(e,t){return Ka(e)?pr(e,br(t,1,Ka,!0)):[]}),Vo=Qr(function(e,t){var n=Qo(t);return Ka(n)&&(n=i),Ka(e)?pr(e,br(t,1,Ka,!0),fo(n,2)):[]}),Fo=Qr(function(e,t){var n=Qo(t);return Ka(n)&&(n=i),Ka(e)?pr(e,br(t,1,Ka,!0),i,n):[]});function Uo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:gs(n);return i<0&&(i=wn(r+i,0)),Ft(e,fo(t,3),i)}function Ho(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r-1;return n!==i&&(o=gs(n),o=n<0?wn(r+o,0):kn(o,r-1)),Ft(e,fo(t,3),o,!0)}function qo(e){return(null==e?0:e.length)?br(e,1):[]}function Jo(e){return e&&e.length?e[0]:i}var Ko=Qr(function(e){var t=Bt(e,bi);return t.length&&t[0]===e[0]?Lr(t):[]}),Yo=Qr(function(e){var t=Qo(e),n=Bt(e,bi);return t===Qo(n)?t=i:n.pop(),n.length&&n[0]===e[0]?Lr(n,fo(t,2)):[]}),Xo=Qr(function(e){var t=Qo(e),n=Bt(e,bi);return(t='function'==typeof t?t:i)&&n.pop(),n.length&&n[0]===e[0]?Lr(n,i,t):[]});function Qo(e){var t=null==e?0:e.length;return t?e[t-1]:i}var ea=Qr(ta);function ta(e,t){return e&&e.length&&t&&t.length?Jr(e,t):e}var na=oo(function(e,t){var n=null==e?0:e.length,r=ur(e,t);return Kr(e,Bt(t,function(e){return ko(e,n)?+e:e}).sort(Ei)),r});function ra(e){return null==e?e:$n.call(e)}var ia=Qr(function(e){return hi(br(e,1,Ka,!0))}),oa=Qr(function(e){var t=Qo(e);return Ka(t)&&(t=i),hi(br(e,1,Ka,!0),fo(t,2))}),aa=Qr(function(e){var t=Qo(e);return t='function'==typeof t?t:i,hi(br(e,1,Ka,!0),i,t)});function sa(e){if(!e||!e.length)return[];var t=0;return e=jt(e,function(e){if(Ka(e))return t=wn(e.length,t),!0}),en(t,function(t){return Bt(e,Kt(t))})}function ca(e,t){if(!e||!e.length)return[];var n=sa(e);return null==t?n:Bt(n,function(e){return It(t,i,e)})}var ua=Qr(function(e,t){return Ka(e)?pr(e,t):[]}),la=Qr(function(e){return yi(jt(e,Ka))}),da=Qr(function(e){var t=Qo(e);return Ka(t)&&(t=i),yi(jt(e,Ka),fo(t,2))}),fa=Qr(function(e){var t=Qo(e);return t='function'==typeof t?t:i,yi(jt(e,Ka),i,t)}),ha=Qr(sa);var pa=Qr(function(e){var t=e.length,n=t>1?e[t-1]:i;return n='function'==typeof n?(e.pop(),n):i,ca(e,n)});function va(e){var t=Gn(e);return t.__chain__=!0,t}function ma(e,t){return t(e)}var ga=oo(function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,o=function(t){return ur(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Hn&&ko(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:ma,args:[o],thisArg:i}),new Un(r,this.__chain__).thru(function(e){return t&&!e.length&&e.push(i),e})):this.thru(o)});var ya=Pi(function(e,t,n){Ze.call(e,n)?++e[n]:cr(e,n,1)});var _a=Ri(Uo),ba=Ri(Ho);function wa(e,t){return(Ha(e)?Lt:vr)(e,fo(t,3))}function ka(e,t){return(Ha(e)?Tt:mr)(e,fo(t,3))}var Sa=Pi(function(e,t,n){Ze.call(e,n)?e[n].push(t):cr(e,n,[t])});var xa=Qr(function(e,t,n){var i=-1,o='function'==typeof t,a=Ja(e)?r(e.length):[];return vr(e,function(e){a[++i]=o?It(t,e,n):Tr(e,t,n)}),a}),za=Pi(function(e,t,n){cr(e,n,t)});function $a(e,t){return(Ha(e)?Bt:Wr)(e,fo(t,3))}var Ca=Pi(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]});var Aa=Qr(function(e,t){if(null==e)return[];var n=t.length;return n>1&&So(e,t[0],t[1])?t=[]:n>2&&So(t[0],t[1],t[2])&&(t=[t[0]]),Hr(e,br(t,1),[])}),Ea=ht||function(){return yt.Date.now()};function Ia(e,t,n){return t=n?i:t,t=e&&null==t?e.length:t,eo(e,d,i,i,i,i,t)}function Ma(e,t){var n;if('function'!=typeof t)throw new Te(o);return e=gs(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=i),n}}var La=Qr(function(e,t,n){var r=1;if(n.length){var i=pn(n,lo(La));r|=u}return eo(e,r,t,n,i)}),Ta=Qr(function(e,t,n){var r=3;if(n.length){var i=pn(n,lo(Ta));r|=u}return eo(t,r,e,n,i)});function Pa(e,t,n){var r,a,s,c,u,l,d=0,f=!1,h=!1,p=!0;if('function'!=typeof e)throw new Te(o);function v(t){var n=r,o=a;return r=a=i,d=t,c=e.apply(o,n)}function m(e){var n=e-l;return l===i||n>=t||n<0||h&&e-d>=s}function g(){var e=Ea();if(m(e))return y(e);u=Po(g,function(e){var n=t-(e-l);return h?kn(n,s-(e-d)):n}(e))}function y(e){return u=i,p&&r?v(e):(r=a=i,c)}function b(){var e=Ea(),n=m(e);if(r=arguments,a=this,l=e,n){if(u===i)return function(e){return d=e,u=Po(g,t),f?v(e):c}(l);if(h)return zi(u),u=Po(g,t),v(l)}return u===i&&(u=Po(g,t)),c}return t=_s(t)||0,rs(n)&&(f=!!n.leading,s=(h='maxWait'in n)?wn(_s(n.maxWait)||0,t):s,p='trailing'in n?!!n.trailing:p),b.cancel=function(){u!==i&&zi(u),d=0,r=l=a=u=i},b.flush=function(){return u===i?c:y(Ea())},b}var ja=Qr(function(e,t){return hr(e,1,t)}),Da=Qr(function(e,t,n){return hr(e,_s(t)||0,n)});function Oa(e,t){if('function'!=typeof e||null!=t&&'function'!=typeof t)throw new Te(o);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(Oa.Cache||Kn),n}function Ba(e){if('function'!=typeof e)throw new Te(o);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Oa.Cache=Kn;var Za=Si(function(e,t){var n=(t=1==t.length&&Ha(t[0])?Bt(t[0],nn(fo())):Bt(br(t,1),nn(fo()))).length;return Qr(function(r){for(var i=-1,o=kn(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return It(e,this,r)})}),Na=Qr(function(e,t){var n=pn(t,lo(Na));return eo(e,u,i,t,n)}),Ra=Qr(function(e,t){var n=pn(t,lo(Ra));return eo(e,l,i,t,n)}),Wa=oo(function(e,t){return eo(e,f,i,i,i,t)});function Ga(e,t){return e===t||e!=e&&t!=t}var Va=Ji(Er),Fa=Ji(function(e,t){return e>=t}),Ua=Pr(function(){return arguments}())?Pr:function(e){return is(e)&&Ze.call(e,'callee')&&!Xe.call(e,'callee')},Ha=r.isArray,qa=xt?nn(xt):function(e){return is(e)&&Ar(e)==O};function Ja(e){return null!=e&&ns(e.length)&&!es(e)}function Ka(e){return is(e)&&Ja(e)}var Ya=kt||_c,Xa=zt?nn(zt):function(e){return is(e)&&Ar(e)==k};function Qa(e){if(!is(e))return!1;var t=Ar(e);return t==S||'[object DOMException]'==t||'string'==typeof e.message&&'string'==typeof e.name&&!ss(e)}function es(e){if(!rs(e))return!1;var t=Ar(e);return t==x||t==C||'[object AsyncFunction]'==t||'[object Proxy]'==t}function ts(e){return'number'==typeof e&&e==gs(e)}function ns(e){return'number'==typeof e&&e>-1&&e%1==0&&e<=p}function rs(e){var t=typeof e;return null!=e&&('object'==t||'function'==t)}function is(e){return null!=e&&'object'==typeof e}var os=$t?nn($t):function(e){return is(e)&&yo(e)==A};function as(e){return'number'==typeof e||is(e)&&Ar(e)==E}function ss(e){if(!is(e)||Ar(e)!=I)return!1;var t=Ke(e);if(null===t)return!0;var n=Ze.call(t,'constructor')&&t.constructor;return'function'==typeof n&&n instanceof n&&Be.call(n)==Ge}var cs=Ct?nn(Ct):function(e){return is(e)&&Ar(e)==L};var us=At?nn(At):function(e){return is(e)&&yo(e)==T};function ls(e){return'string'==typeof e||!Ha(e)&&is(e)&&Ar(e)==P}function ds(e){return'symbol'==typeof e||is(e)&&Ar(e)==j}var fs=Et?nn(Et):function(e){return is(e)&&ns(e.length)&&!!dt[Ar(e)]};var hs=Ji(Rr),ps=Ji(function(e,t){return e<=t});function vs(e){if(!e)return[];if(Ja(e))return ls(e)?yn(e):Li(e);if(tt&&e[tt])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[tt]());var t=yo(e);return(t==A?fn:t==T?vn:Gs)(e)}function ms(e){return e?(e=_s(e))===h||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function gs(e){var t=ms(e),n=t%1;return t==t?n?t-n:t:0}function ys(e){return e?lr(gs(e),0,m):0}function _s(e){if('number'==typeof e)return e;if(ds(e))return v;if(rs(e)){var t='function'==typeof e.valueOf?e.valueOf():e;e=rs(t)?t+'':t}if('string'!=typeof e)return 0===e?e:+e;e=tn(e);var n=be.test(e);return n||ke.test(e)?vt(e.slice(2),n?2:8):_e.test(e)?v:+e}function bs(e){return Ti(e,js(e))}function ws(e){return null==e?'':fi(e)}var ks=ji(function(e,t){if(Co(t)||Ja(t))Ti(t,Ps(t),e);else for(var n in t)Ze.call(t,n)&&ir(e,n,t[n])}),Ss=ji(function(e,t){Ti(t,js(t),e)}),xs=ji(function(e,t,n,r){Ti(t,js(t),e,r)}),zs=ji(function(e,t,n,r){Ti(t,Ps(t),e,r)}),$s=oo(ur);var Cs=Qr(function(e,t){e=Ie(e);var n=-1,r=t.length,o=r>2?t[2]:i;for(o&&So(t[0],t[1],o)&&(r=1);++n<r;)for(var a=t[n],s=js(a),c=-1,u=s.length;++c<u;){var l=s[c],d=e[l];(d===i||Ga(d,De[l])&&!Ze.call(e,l))&&(e[l]=a[l])}return e}),As=Qr(function(e){return e.push(i,no),It(Os,i,e)});function Es(e,t,n){var r=null==e?i:$r(e,t);return r===i?n:r}function Is(e,t){return null!=e&&_o(e,t,Mr)}var Ms=Vi(function(e,t,n){null!=t&&'function'!=typeof t.toString&&(t=We.call(t)),e[t]=n},rc(ac)),Ls=Vi(function(e,t,n){null!=t&&'function'!=typeof t.toString&&(t=We.call(t)),Ze.call(e,t)?e[t].push(n):e[t]=[n]},fo),Ts=Qr(Tr);function Ps(e){return Ja(e)?Qn(e):Zr(e)}function js(e){return Ja(e)?Qn(e,!0):Nr(e)}var Ds=ji(function(e,t,n){Fr(e,t,n)}),Os=ji(function(e,t,n,r){Fr(e,t,n,r)}),Bs=oo(function(e,t){var n={};if(null==e)return n;var r=!1;t=Bt(t,function(t){return t=ki(t,e),r||(r=t.length>1),t}),Ti(e,so(e),n),r&&(n=dr(n,7,ro));for(var i=t.length;i--;)pi(n,t[i]);return n});var Zs=oo(function(e,t){return null==e?{}:function(e,t){return qr(e,t,function(t,n){return Is(e,n)})}(e,t)});function Ns(e,t){if(null==e)return{};var n=Bt(so(e),function(e){return[e]});return t=fo(t),qr(e,n,function(e,n){return t(e,n[0])})}var Rs=Qi(Ps),Ws=Qi(js);function Gs(e){return null==e?[]:rn(e,Ps(e))}var Vs=Zi(function(e,t,n){return t=t.toLowerCase(),e+(n?Fs(t):t)});function Fs(e){return Qs(ws(e).toLowerCase())}function Us(e){return(e=ws(e))&&e.replace(xe,cn).replace(it,'')}var Hs=Zi(function(e,t,n){return e+(n?'-':'')+t.toLowerCase()}),qs=Zi(function(e,t,n){return e+(n?' ':'')+t.toLowerCase()}),Js=Bi('toLowerCase');var Ks=Zi(function(e,t,n){return e+(n?'_':'')+t.toLowerCase()});var Ys=Zi(function(e,t,n){return e+(n?' ':'')+Qs(t)});var Xs=Zi(function(e,t,n){return e+(n?' ':'')+t.toUpperCase()}),Qs=Bi('toUpperCase');function ec(e,t,n){return e=ws(e),(t=n?i:t)===i?function(e){return ct.test(e)}(e)?function(e){return e.match(at)||[]}(e):function(e){return e.match(pe)||[]}(e):e.match(t)||[]}var tc=Qr(function(e,t){try{return It(e,i,t)}catch(e){return Qa(e)?e:new Ce(e)}}),nc=oo(function(e,t){return Lt(t,function(t){t=No(t),cr(e,t,La(e[t],e))}),e});function rc(e){return function(){return e}}var ic=Wi(),oc=Wi(!0);function ac(e){return e}function sc(e){return Br('function'==typeof e?e:dr(e,1))}var cc=Qr(function(e,t){return function(n){return Tr(n,e,t)}}),uc=Qr(function(e,t){return function(n){return Tr(e,n,t)}});function lc(e,t,n){var r=Ps(t),i=zr(t,r);null!=n||rs(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=zr(t,Ps(t)));var o=!(rs(n)&&'chain'in n&&!n.chain),a=es(e);return Lt(i,function(n){var r=t[n];e[n]=r,a&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__);return(n.__actions__=Li(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,Zt([this.value()],arguments))})}),e}function dc(){}var fc=Ui(Bt),hc=Ui(Pt),pc=Ui(Wt);function vc(e){return xo(e)?Kt(No(e)):function(e){return function(t){return $r(t,e)}}(e)}var mc=qi(),gc=qi(!0);function yc(){return[]}function _c(){return!1}var bc=Fi(function(e,t){return e+t},0),wc=Yi('ceil'),kc=Fi(function(e,t){return e/t},1),Sc=Yi('floor');var xc,zc=Fi(function(e,t){return e*t},1),$c=Yi('round'),Cc=Fi(function(e,t){return e-t},0);return Gn.after=function(e,t){if('function'!=typeof t)throw new Te(o);return e=gs(e),function(){if(--e<1)return t.apply(this,arguments)}},Gn.ary=Ia,Gn.assign=ks,Gn.assignIn=Ss,Gn.assignInWith=xs,Gn.assignWith=zs,Gn.at=$s,Gn.before=Ma,Gn.bind=La,Gn.bindAll=nc,Gn.bindKey=Ta,Gn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Ha(e)?e:[e]},Gn.chain=va,Gn.chunk=function(e,t,n){t=(n?So(e,t,n):t===i)?1:wn(gs(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var a=0,s=0,c=r(gt(o/t));a<o;)c[s++]=ai(e,a,a+=t);return c},Gn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},Gn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return Zt(Ha(n)?Li(n):[n],br(t,1))},Gn.cond=function(e){var t=null==e?0:e.length,n=fo();return e=t?Bt(e,function(e){if('function'!=typeof e[1])throw new Te(o);return[n(e[0]),e[1]]}):[],Qr(function(n){for(var r=-1;++r<t;){var i=e[r];if(It(i[0],this,n))return It(i[1],this,n)}})},Gn.conforms=function(e){return function(e){var t=Ps(e);return function(n){return fr(n,e,t)}}(dr(e,1))},Gn.constant=rc,Gn.countBy=ya,Gn.create=function(e,t){var n=Vn(e);return null==t?n:sr(n,t)},Gn.curry=function e(t,n,r){var o=eo(t,8,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},Gn.curryRight=function e(t,n,r){var o=eo(t,c,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},Gn.debounce=Pa,Gn.defaults=Cs,Gn.defaultsDeep=As,Gn.defer=ja,Gn.delay=Da,Gn.difference=Go,Gn.differenceBy=Vo,Gn.differenceWith=Fo,Gn.drop=function(e,t,n){var r=null==e?0:e.length;return r?ai(e,(t=n||t===i?1:gs(t))<0?0:t,r):[]},Gn.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?ai(e,0,(t=r-(t=n||t===i?1:gs(t)))<0?0:t):[]},Gn.dropRightWhile=function(e,t){return e&&e.length?mi(e,fo(t,3),!0,!0):[]},Gn.dropWhile=function(e,t){return e&&e.length?mi(e,fo(t,3),!0):[]},Gn.fill=function(e,t,n,r){var o=null==e?0:e.length;return o?(n&&'number'!=typeof n&&So(e,t,n)&&(n=0,r=o),function(e,t,n,r){var o=e.length;for((n=gs(n))<0&&(n=-n>o?0:o+n),(r=r===i||r>o?o:gs(r))<0&&(r+=o),r=n>r?0:ys(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},Gn.filter=function(e,t){return(Ha(e)?jt:_r)(e,fo(t,3))},Gn.flatMap=function(e,t){return br($a(e,t),1)},Gn.flatMapDeep=function(e,t){return br($a(e,t),h)},Gn.flatMapDepth=function(e,t,n){return n=n===i?1:gs(n),br($a(e,t),n)},Gn.flatten=qo,Gn.flattenDeep=function(e){return(null==e?0:e.length)?br(e,h):[]},Gn.flattenDepth=function(e,t){return(null==e?0:e.length)?br(e,t=t===i?1:gs(t)):[]},Gn.flip=function(e){return eo(e,512)},Gn.flow=ic,Gn.flowRight=oc,Gn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},Gn.functions=function(e){return null==e?[]:zr(e,Ps(e))},Gn.functionsIn=function(e){return null==e?[]:zr(e,js(e))},Gn.groupBy=Sa,Gn.initial=function(e){return(null==e?0:e.length)?ai(e,0,-1):[]},Gn.intersection=Ko,Gn.intersectionBy=Yo,Gn.intersectionWith=Xo,Gn.invert=Ms,Gn.invertBy=Ls,Gn.invokeMap=xa,Gn.iteratee=sc,Gn.keyBy=za,Gn.keys=Ps,Gn.keysIn=js,Gn.map=$a,Gn.mapKeys=function(e,t){var n={};return t=fo(t,3),Sr(e,function(e,r,i){cr(n,t(e,r,i),e)}),n},Gn.mapValues=function(e,t){var n={};return t=fo(t,3),Sr(e,function(e,r,i){cr(n,r,t(e,r,i))}),n},Gn.matches=function(e){return Gr(dr(e,1))},Gn.matchesProperty=function(e,t){return Vr(e,dr(t,1))},Gn.memoize=Oa,Gn.merge=Ds,Gn.mergeWith=Os,Gn.method=cc,Gn.methodOf=uc,Gn.mixin=lc,Gn.negate=Ba,Gn.nthArg=function(e){return e=gs(e),Qr(function(t){return Ur(t,e)})},Gn.omit=Bs,Gn.omitBy=function(e,t){return Ns(e,Ba(fo(t)))},Gn.once=function(e){return Ma(2,e)},Gn.orderBy=function(e,t,n,r){return null==e?[]:(Ha(t)||(t=null==t?[]:[t]),Ha(n=r?i:n)||(n=null==n?[]:[n]),Hr(e,t,n))},Gn.over=fc,Gn.overArgs=Za,Gn.overEvery=hc,Gn.overSome=pc,Gn.partial=Na,Gn.partialRight=Ra,Gn.partition=Ca,Gn.pick=Zs,Gn.pickBy=Ns,Gn.property=vc,Gn.propertyOf=function(e){return function(t){return null==e?i:$r(e,t)}},Gn.pull=ea,Gn.pullAll=ta,Gn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Jr(e,t,fo(n,2)):e},Gn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Jr(e,t,i,n):e},Gn.pullAt=na,Gn.range=mc,Gn.rangeRight=gc,Gn.rearg=Wa,Gn.reject=function(e,t){return(Ha(e)?jt:_r)(e,Ba(fo(t,3)))},Gn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=fo(t,3);++r<o;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r))}return Kr(e,i),n},Gn.rest=function(e,t){if('function'!=typeof e)throw new Te(o);return Qr(e,t=t===i?t:gs(t))},Gn.reverse=ra,Gn.sampleSize=function(e,t,n){return t=(n?So(e,t,n):t===i)?1:gs(t),(Ha(e)?tr:ti)(e,t)},Gn.set=function(e,t,n){return null==e?e:ni(e,t,n)},Gn.setWith=function(e,t,n,r){return r='function'==typeof r?r:i,null==e?e:ni(e,t,n,r)},Gn.shuffle=function(e){return(Ha(e)?nr:oi)(e)},Gn.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&'number'!=typeof n&&So(e,t,n)?(t=0,n=r):(t=null==t?0:gs(t),n=n===i?r:gs(n)),ai(e,t,n)):[]},Gn.sortBy=Aa,Gn.sortedUniq=function(e){return e&&e.length?li(e):[]},Gn.sortedUniqBy=function(e,t){return e&&e.length?li(e,fo(t,2)):[]},Gn.split=function(e,t,n){return n&&'number'!=typeof n&&So(e,t,n)&&(t=n=i),(n=n===i?m:n>>>0)?(e=ws(e))&&('string'==typeof t||null!=t&&!cs(t))&&!(t=fi(t))&&dn(e)?xi(yn(e),0,n):e.split(t,n):[]},Gn.spread=function(e,t){if('function'!=typeof e)throw new Te(o);return t=null==t?0:wn(gs(t),0),Qr(function(n){var r=n[t],i=xi(n,0,t);return r&&Zt(i,r),It(e,this,i)})},Gn.tail=function(e){var t=null==e?0:e.length;return t?ai(e,1,t):[]},Gn.take=function(e,t,n){return e&&e.length?ai(e,0,(t=n||t===i?1:gs(t))<0?0:t):[]},Gn.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?ai(e,(t=r-(t=n||t===i?1:gs(t)))<0?0:t,r):[]},Gn.takeRightWhile=function(e,t){return e&&e.length?mi(e,fo(t,3),!1,!0):[]},Gn.takeWhile=function(e,t){return e&&e.length?mi(e,fo(t,3)):[]},Gn.tap=function(e,t){return t(e),e},Gn.throttle=function(e,t,n){var r=!0,i=!0;if('function'!=typeof e)throw new Te(o);return rs(n)&&(r='leading'in n?!!n.leading:r,i='trailing'in n?!!n.trailing:i),Pa(e,t,{leading:r,maxWait:t,trailing:i})},Gn.thru=ma,Gn.toArray=vs,Gn.toPairs=Rs,Gn.toPairsIn=Ws,Gn.toPath=function(e){return Ha(e)?Bt(e,No):ds(e)?[e]:Li(Zo(ws(e)))},Gn.toPlainObject=bs,Gn.transform=function(e,t,n){var r=Ha(e),i=r||Ya(e)||fs(e);if(t=fo(t,4),null==n){var o=e&&e.constructor;n=i?r?new o:[]:rs(e)&&es(o)?Vn(Ke(e)):{}}return(i?Lt:Sr)(e,function(e,r,i){return t(n,e,r,i)}),n},Gn.unary=function(e){return Ia(e,1)},Gn.union=ia,Gn.unionBy=oa,Gn.unionWith=aa,Gn.uniq=function(e){return e&&e.length?hi(e):[]},Gn.uniqBy=function(e,t){return e&&e.length?hi(e,fo(t,2)):[]},Gn.uniqWith=function(e,t){return t='function'==typeof t?t:i,e&&e.length?hi(e,i,t):[]},Gn.unset=function(e,t){return null==e||pi(e,t)},Gn.unzip=sa,Gn.unzipWith=ca,Gn.update=function(e,t,n){return null==e?e:vi(e,t,wi(n))},Gn.updateWith=function(e,t,n,r){return r='function'==typeof r?r:i,null==e?e:vi(e,t,wi(n),r)},Gn.values=Gs,Gn.valuesIn=function(e){return null==e?[]:rn(e,js(e))},Gn.without=ua,Gn.words=ec,Gn.wrap=function(e,t){return Na(wi(t),e)},Gn.xor=la,Gn.xorBy=da,Gn.xorWith=fa,Gn.zip=ha,Gn.zipObject=function(e,t){return _i(e||[],t||[],ir)},Gn.zipObjectDeep=function(e,t){return _i(e||[],t||[],ni)},Gn.zipWith=pa,Gn.entries=Rs,Gn.entriesIn=Ws,Gn.extend=Ss,Gn.extendWith=xs,lc(Gn,Gn),Gn.add=bc,Gn.attempt=tc,Gn.camelCase=Vs,Gn.capitalize=Fs,Gn.ceil=wc,Gn.clamp=function(e,t,n){return n===i&&(n=t,t=i),n!==i&&(n=(n=_s(n))==n?n:0),t!==i&&(t=(t=_s(t))==t?t:0),lr(_s(e),t,n)},Gn.clone=function(e){return dr(e,4)},Gn.cloneDeep=function(e){return dr(e,5)},Gn.cloneDeepWith=function(e,t){return dr(e,5,t='function'==typeof t?t:i)},Gn.cloneWith=function(e,t){return dr(e,4,t='function'==typeof t?t:i)},Gn.conformsTo=function(e,t){return null==t||fr(e,t,Ps(t))},Gn.deburr=Us,Gn.defaultTo=function(e,t){return null==e||e!=e?t:e},Gn.divide=kc,Gn.endsWith=function(e,t,n){e=ws(e),t=fi(t);var r=e.length,o=n=n===i?r:lr(gs(n),0,r);return(n-=t.length)>=0&&e.slice(n,o)==t},Gn.eq=Ga,Gn.escape=function(e){return(e=ws(e))&&ee.test(e)?e.replace(X,un):e},Gn.escapeRegExp=function(e){return(e=ws(e))&&ce.test(e)?e.replace(se,'\\$&'):e},Gn.every=function(e,t,n){var r=Ha(e)?Pt:gr;return n&&So(e,t,n)&&(t=i),r(e,fo(t,3))},Gn.find=_a,Gn.findIndex=Uo,Gn.findKey=function(e,t){return Vt(e,fo(t,3),Sr)},Gn.findLast=ba,Gn.findLastIndex=Ho,Gn.findLastKey=function(e,t){return Vt(e,fo(t,3),xr)},Gn.floor=Sc,Gn.forEach=wa,Gn.forEachRight=ka,Gn.forIn=function(e,t){return null==e?e:wr(e,fo(t,3),js)},Gn.forInRight=function(e,t){return null==e?e:kr(e,fo(t,3),js)},Gn.forOwn=function(e,t){return e&&Sr(e,fo(t,3))},Gn.forOwnRight=function(e,t){return e&&xr(e,fo(t,3))},Gn.get=Es,Gn.gt=Va,Gn.gte=Fa,Gn.has=function(e,t){return null!=e&&_o(e,t,Ir)},Gn.hasIn=Is,Gn.head=Jo,Gn.identity=ac,Gn.includes=function(e,t,n,r){e=Ja(e)?e:Gs(e),n=n&&!r?gs(n):0;var i=e.length;return n<0&&(n=wn(i+n,0)),ls(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&Ut(e,t,n)>-1},Gn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:gs(n);return i<0&&(i=wn(r+i,0)),Ut(e,t,i)},Gn.inRange=function(e,t,n){return t=ms(t),n===i?(n=t,t=0):n=ms(n),function(e,t,n){return e>=kn(t,n)&&e<wn(t,n)}(e=_s(e),t,n)},Gn.invoke=Ts,Gn.isArguments=Ua,Gn.isArray=Ha,Gn.isArrayBuffer=qa,Gn.isArrayLike=Ja,Gn.isArrayLikeObject=Ka,Gn.isBoolean=function(e){return!0===e||!1===e||is(e)&&Ar(e)==w},Gn.isBuffer=Ya,Gn.isDate=Xa,Gn.isElement=function(e){return is(e)&&1===e.nodeType&&!ss(e)},Gn.isEmpty=function(e){if(null==e)return!0;if(Ja(e)&&(Ha(e)||'string'==typeof e||'function'==typeof e.splice||Ya(e)||fs(e)||Ua(e)))return!e.length;var t=yo(e);if(t==A||t==T)return!e.size;if(Co(e))return!Zr(e).length;for(var n in e)if(Ze.call(e,n))return!1;return!0},Gn.isEqual=function(e,t){return jr(e,t)},Gn.isEqualWith=function(e,t,n){var r=(n='function'==typeof n?n:i)?n(e,t):i;return r===i?jr(e,t,i,n):!!r},Gn.isError=Qa,Gn.isFinite=function(e){return'number'==typeof e&&St(e)},Gn.isFunction=es,Gn.isInteger=ts,Gn.isLength=ns,Gn.isMap=os,Gn.isMatch=function(e,t){return e===t||Dr(e,t,po(t))},Gn.isMatchWith=function(e,t,n){return n='function'==typeof n?n:i,Dr(e,t,po(t),n)},Gn.isNaN=function(e){return as(e)&&e!=+e},Gn.isNative=function(e){if($o(e))throw new Ce('Unsupported core-js use. Try https://npms.io/search?q=ponyfill.');return Or(e)},Gn.isNil=function(e){return null==e},Gn.isNull=function(e){return null===e},Gn.isNumber=as,Gn.isObject=rs,Gn.isObjectLike=is,Gn.isPlainObject=ss,Gn.isRegExp=cs,Gn.isSafeInteger=function(e){return ts(e)&&e>=-9007199254740991&&e<=p},Gn.isSet=us,Gn.isString=ls,Gn.isSymbol=ds,Gn.isTypedArray=fs,Gn.isUndefined=function(e){return e===i},Gn.isWeakMap=function(e){return is(e)&&yo(e)==D},Gn.isWeakSet=function(e){return is(e)&&'[object WeakSet]'==Ar(e)},Gn.join=function(e,t){return null==e?'':Gt.call(e,t)},Gn.kebabCase=Hs,Gn.last=Qo,Gn.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r;return n!==i&&(o=(o=gs(n))<0?wn(r+o,0):kn(o,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,o):Ft(e,qt,o,!0)},Gn.lowerCase=qs,Gn.lowerFirst=Js,Gn.lt=hs,Gn.lte=ps,Gn.max=function(e){return e&&e.length?yr(e,ac,Er):i},Gn.maxBy=function(e,t){return e&&e.length?yr(e,fo(t,2),Er):i},Gn.mean=function(e){return Jt(e,ac)},Gn.meanBy=function(e,t){return Jt(e,fo(t,2))},Gn.min=function(e){return e&&e.length?yr(e,ac,Rr):i},Gn.minBy=function(e,t){return e&&e.length?yr(e,fo(t,2),Rr):i},Gn.stubArray=yc,Gn.stubFalse=_c,Gn.stubObject=function(){return{}},Gn.stubString=function(){return''},Gn.stubTrue=function(){return!0},Gn.multiply=zc,Gn.nth=function(e,t){return e&&e.length?Ur(e,gs(t)):i},Gn.noConflict=function(){return yt._===this&&(yt._=Ve),this},Gn.noop=dc,Gn.now=Ea,Gn.pad=function(e,t,n){e=ws(e);var r=(t=gs(t))?gn(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Hi(_t(i),n)+e+Hi(gt(i),n)},Gn.padEnd=function(e,t,n){e=ws(e);var r=(t=gs(t))?gn(e):0;return t&&r<t?e+Hi(t-r,n):e},Gn.padStart=function(e,t,n){e=ws(e);var r=(t=gs(t))?gn(e):0;return t&&r<t?Hi(t-r,n)+e:e},Gn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),xn(ws(e).replace(ue,''),t||0)},Gn.random=function(e,t,n){if(n&&'boolean'!=typeof n&&So(e,t,n)&&(t=n=i),n===i&&('boolean'==typeof t?(n=t,t=i):'boolean'==typeof e&&(n=e,e=i)),e===i&&t===i?(e=0,t=1):(e=ms(e),t===i?(t=e,e=0):t=ms(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var o=zn();return kn(e+o*(t-e+pt('1e-'+((o+'').length-1))),t)}return Yr(e,t)},Gn.reduce=function(e,t,n){var r=Ha(e)?Nt:Xt,i=arguments.length<3;return r(e,fo(t,4),n,i,vr)},Gn.reduceRight=function(e,t,n){var r=Ha(e)?Rt:Xt,i=arguments.length<3;return r(e,fo(t,4),n,i,mr)},Gn.repeat=function(e,t,n){return t=(n?So(e,t,n):t===i)?1:gs(t),Xr(ws(e),t)},Gn.replace=function(){var e=arguments,t=ws(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Gn.result=function(e,t,n){var r=-1,o=(t=ki(t,e)).length;for(o||(o=1,e=i);++r<o;){var a=null==e?i:e[No(t[r])];a===i&&(r=o,a=n),e=es(a)?a.call(e):a}return e},Gn.round=$c,Gn.runInContext=e,Gn.sample=function(e){return(Ha(e)?er:ei)(e)},Gn.size=function(e){if(null==e)return 0;if(Ja(e))return ls(e)?gn(e):e.length;var t=yo(e);return t==A||t==T?e.size:Zr(e).length},Gn.snakeCase=Ks,Gn.some=function(e,t,n){var r=Ha(e)?Wt:si;return n&&So(e,t,n)&&(t=i),r(e,fo(t,3))},Gn.sortedIndex=function(e,t){return ci(e,t)},Gn.sortedIndexBy=function(e,t,n){return ui(e,t,fo(n,2))},Gn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=ci(e,t);if(r<n&&Ga(e[r],t))return r}return-1},Gn.sortedLastIndex=function(e,t){return ci(e,t,!0)},Gn.sortedLastIndexBy=function(e,t,n){return ui(e,t,fo(n,2),!0)},Gn.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=ci(e,t,!0)-1;if(Ga(e[n],t))return n}return-1},Gn.startCase=Ys,Gn.startsWith=function(e,t,n){return e=ws(e),n=null==n?0:lr(gs(n),0,e.length),t=fi(t),e.slice(n,n+t.length)==t},Gn.subtract=Cc,Gn.sum=function(e){return e&&e.length?Qt(e,ac):0},Gn.sumBy=function(e,t){return e&&e.length?Qt(e,fo(t,2)):0},Gn.template=function(e,t,n){var r=Gn.templateSettings;n&&So(e,t,n)&&(t=i),e=ws(e),t=xs({},t,r,to);var o,a,s=xs({},t.imports,r.imports,to),c=Ps(s),u=rn(s,c),l=0,d=t.interpolate||ze,f='__p += \'',h=Me((t.escape||ze).source+'|'+d.source+'|'+(d===re?ge:ze).source+'|'+(t.evaluate||ze).source+'|$','g'),p='//# sourceURL='+(Ze.call(t,'sourceURL')?(t.sourceURL+'').replace(/\s/g,' '):'lodash.templateSources['+ ++lt+']')+'\n';e.replace(h,function(t,n,r,i,s,c){return r||(r=i),f+=e.slice(l,c).replace($e,ln),n&&(o=!0,f+='\' +\n__e('+n+') +\n\''),s&&(a=!0,f+='\';\n'+s+';\n__p += \''),r&&(f+='\' +\n((__t = ('+r+')) == null ? \'\' : __t) +\n\''),l=c+t.length,t}),f+='\';\n';var v=Ze.call(t,'variable')&&t.variable;if(v){if(ve.test(v))throw new Ce('Invalid `variable` option passed into `_.template`')}else f='with (obj) {\n'+f+'\n}\n';f=(a?f.replace(q,''):f).replace(J,'$1').replace(K,'$1;'),f='function('+(v||'obj')+') {\n'+(v?'':'obj || (obj = {});\n')+'var __t, __p = \'\''+(o?', __e = _.escape':'')+(a?', __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, \'\') }\n':';\n')+f+'return __p\n}';var m=tc(function(){return Ae(c,p+'return '+f).apply(i,u)});if(m.source=f,Qa(m))throw m;return m},Gn.times=function(e,t){if((e=gs(e))<1||e>p)return[];var n=m,r=kn(e,m);t=fo(t),e-=m;for(var i=en(r,t);++n<e;)t(n);return i},Gn.toFinite=ms,Gn.toInteger=gs,Gn.toLength=ys,Gn.toLower=function(e){return ws(e).toLowerCase()},Gn.toNumber=_s,Gn.toSafeInteger=function(e){return e?lr(gs(e),-9007199254740991,p):0===e?e:0},Gn.toString=ws,Gn.toUpper=function(e){return ws(e).toUpperCase()},Gn.trim=function(e,t,n){if((e=ws(e))&&(n||t===i))return tn(e);if(!e||!(t=fi(t)))return e;var r=yn(e),o=yn(t);return xi(r,an(r,o),sn(r,o)+1).join('')},Gn.trimEnd=function(e,t,n){if((e=ws(e))&&(n||t===i))return e.slice(0,_n(e)+1);if(!e||!(t=fi(t)))return e;var r=yn(e);return xi(r,0,sn(r,yn(t))+1).join('')},Gn.trimStart=function(e,t,n){if((e=ws(e))&&(n||t===i))return e.replace(ue,'');if(!e||!(t=fi(t)))return e;var r=yn(e);return xi(r,an(r,yn(t))).join('')},Gn.truncate=function(e,t){var n=30,r='...';if(rs(t)){var o='separator'in t?t.separator:o;n='length'in t?gs(t.length):n,r='omission'in t?fi(t.omission):r}var a=(e=ws(e)).length;if(dn(e)){var s=yn(e);a=s.length}if(n>=a)return e;var c=n-gn(r);if(c<1)return r;var u=s?xi(s,0,c).join(''):e.slice(0,c);if(o===i)return u+r;if(s&&(c+=u.length-c),cs(o)){if(e.slice(c).search(o)){var l,d=u;for(o.global||(o=Me(o.source,ws(ye.exec(o))+'g')),o.lastIndex=0;l=o.exec(d);)var f=l.index;u=u.slice(0,f===i?c:f)}}else if(e.indexOf(fi(o),c)!=c){var h=u.lastIndexOf(o);h>-1&&(u=u.slice(0,h))}return u+r},Gn.unescape=function(e){return(e=ws(e))&&Q.test(e)?e.replace(Y,bn):e},Gn.uniqueId=function(e){var t=++Ne;return ws(e)+t},Gn.upperCase=Xs,Gn.upperFirst=Qs,Gn.each=wa,Gn.eachRight=ka,Gn.first=Jo,lc(Gn,(xc={},Sr(Gn,function(e,t){Ze.call(Gn.prototype,t)||(xc[t]=e)}),xc),{chain:!1}),Gn.VERSION='4.17.21',Lt(['bind','bindKey','curry','curryRight','partial','partialRight'],function(e){Gn[e].placeholder=Gn}),Lt(['drop','take'],function(e,t){Hn.prototype[e]=function(n){n=n===i?1:wn(gs(n),0);var r=this.__filtered__&&!t?new Hn(this):this.clone();return r.__filtered__?r.__takeCount__=kn(n,r.__takeCount__):r.__views__.push({size:kn(n,m),type:e+(r.__dir__<0?'Right':'')}),r},Hn.prototype[e+'Right']=function(t){return this.reverse()[e](t).reverse()}}),Lt(['filter','map','takeWhile'],function(e,t){var n=t+1,r=1==n||3==n;Hn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:fo(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}}),Lt(['head','last'],function(e,t){var n='take'+(t?'Right':'');Hn.prototype[e]=function(){return this[n](1).value()[0]}}),Lt(['initial','tail'],function(e,t){var n='drop'+(t?'':'Right');Hn.prototype[e]=function(){return this.__filtered__?new Hn(this):this[n](1)}}),Hn.prototype.compact=function(){return this.filter(ac)},Hn.prototype.find=function(e){return this.filter(e).head()},Hn.prototype.findLast=function(e){return this.reverse().find(e)},Hn.prototype.invokeMap=Qr(function(e,t){return'function'==typeof e?new Hn(this):this.map(function(n){return Tr(n,e,t)})}),Hn.prototype.reject=function(e){return this.filter(Ba(fo(e)))},Hn.prototype.slice=function(e,t){e=gs(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Hn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==i&&(n=(t=gs(t))<0?n.dropRight(-t):n.take(t-e)),n)},Hn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Hn.prototype.toArray=function(){return this.take(m)},Sr(Hn.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),o=Gn[r?'take'+('last'==t?'Right':''):t],a=r||/^find/.test(t);o&&(Gn.prototype[t]=function(){var t=this.__wrapped__,s=r?[1]:arguments,c=t instanceof Hn,u=s[0],l=c||Ha(t),d=function(e){var t=o.apply(Gn,Zt([e],s));return r&&f?t[0]:t};l&&n&&'function'==typeof u&&1!=u.length&&(c=l=!1);var f=this.__chain__,h=!!this.__actions__.length,p=a&&!f,v=c&&!h;if(!a&&l){t=v?t:new Hn(this);var m=e.apply(t,s);return m.__actions__.push({func:ma,args:[d],thisArg:i}),new Un(m,f)}return p&&v?e.apply(this,s):(m=this.thru(d),p?r?m.value()[0]:m.value():m)})}),Lt(['pop','push','shift','sort','splice','unshift'],function(e){var t=Pe[e],n=/^(?:push|sort|unshift)$/.test(e)?'tap':'thru',r=/^(?:pop|shift)$/.test(e);Gn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(Ha(i)?i:[],e)}return this[n](function(n){return t.apply(Ha(n)?n:[],e)})}}),Sr(Hn.prototype,function(e,t){var n=Gn[t];if(n){var r=n.name+'';Ze.call(Pn,r)||(Pn[r]=[]),Pn[r].push({name:t,func:n})}}),Pn[Gi(i,2).name]=[{name:'wrapper',func:i}],Hn.prototype.clone=function(){var e=new Hn(this.__wrapped__);return e.__actions__=Li(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Li(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Li(this.__views__),e},Hn.prototype.reverse=function(){if(this.__filtered__){var e=new Hn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Hn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Ha(e),r=t<0,i=n?e.length:0,o=function(e,t,n){var r=-1,i=n.length;for(;++r<i;){var o=n[r],a=o.size;switch(o.type){case'drop':e+=a;break;case'dropRight':t-=a;break;case'take':t=kn(t,e+a);break;case'takeRight':e=wn(e,t-a)}}return{start:e,end:t}}(0,i,this.__views__),a=o.start,s=o.end,c=s-a,u=r?s:a-1,l=this.__iteratees__,d=l.length,f=0,h=kn(c,this.__takeCount__);if(!n||!r&&i==c&&h==c)return gi(e,this.__actions__);var p=[];e:for(;c--&&f<h;){for(var v=-1,m=e[u+=t];++v<d;){var g=l[v],y=g.iteratee,b=g.type,w=y(m);if(2==b)m=w;else if(!w){if(1==b)continue e;break e}}p[f++]=m}return p},Gn.prototype.at=ga,Gn.prototype.chain=function(){return va(this)},Gn.prototype.commit=function(){return new Un(this.value(),this.__chain__)},Gn.prototype.next=function(){this.__values__===i&&(this.__values__=vs(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?i:this.__values__[this.__index__++]}},Gn.prototype.plant=function(e){for(var t,n=this;n instanceof Fn;){var r=Wo(n);r.__index__=0,r.__values__=i,t?o.__wrapped__=r:t=r;var o=r;n=n.__wrapped__}return o.__wrapped__=e,t},Gn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Hn){var t=e;return this.__actions__.length&&(t=new Hn(this)),(t=t.reverse()).__actions__.push({func:ma,args:[ra],thisArg:i}),new Un(t,this.__chain__)}return this.thru(ra)},Gn.prototype.toJSON=Gn.prototype.valueOf=Gn.prototype.value=function(){return gi(this.__wrapped__,this.__actions__)},Gn.prototype.first=Gn.prototype.head,tt&&(Gn.prototype[tt]=function(){return this}),Gn}();yt._=_,(r=function(){return _}.call(t,n,t,e))===i||(e.exports=r)}.call(this)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if('object'==typeof globalThis)return globalThis;try{return this||new Function('return this')()}catch(e){if('object'==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);Object.freeze({status:'aborted'});function r(e,t,n){function r(n,r){var i;Object.defineProperty(n,'_zod',{value:n._zod??{},enumerable:!1}),(i=n._zod).traits??(i.traits=new Set),n._zod.traits.add(e),t(n,r);for(const e in _.prototype)e in n||Object.defineProperty(n,e,{value:_.prototype[e].bind(n)});n._zod.constr=_,n._zod.def=r}const i=n?.Parent??Object;class o extends i{}function _(e){var t;const i=n?.Parent?new o:this;r(i,e),(t=i._zod).deferred??(t.deferred=[]);for(const e of i._zod.deferred)e();return i}return Object.defineProperty(o,'name',{value:e}),Object.defineProperty(_,'init',{value:r}),Object.defineProperty(_,Symbol.hasInstance,{value:t=>!!(n?.Parent&&t instanceof n.Parent)||t?._zod?.traits?.has(e)}),Object.defineProperty(_,'name',{value:e}),_}Symbol('zod_brand');class i extends Error{constructor(){super('Encountered Promise during synchronous parse. Use .parseAsync() instead.')}}class o extends Error{constructor(e){super(`Encountered unidirectional transform during encode: ${e}`),this.name='ZodEncodeError'}}const a={};function s(e){return e&&Object.assign(a,e),a}const c=/^[cC][^\s-]{8,}$/,u=/^[0-9a-z]+$/,l=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,d=/^[0-9a-vA-V]{20}$/,f=/^[A-Za-z0-9]{27}$/,h=/^[a-zA-Z0-9_-]{21}$/,p=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,v=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,m=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,g=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/;const y=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,b=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,w=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,k=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,S=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,x=/^[A-Za-z0-9_-]*$/,C=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,A=/^\+(?:[0-9]){6,14}[0-9]$/,E='(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))',I=new RegExp(`^${E}$`);function M(e){const t='(?:[01]\\d|2[0-3]):[0-5]\\d';return'number'==typeof e.precision?-1===e.precision?`${t}`:0===e.precision?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}const L=/^\d+$/,T=/^-?\d+(?:\.\d+)?/i,P=/true|false/i,j=/^[^A-Z]*$/,D=/^[^a-z]*$/;function O(_,e){return'bigint'==typeof e?e.toString():e}function B(e){return{get value(){{const t=e();return Object.defineProperty(this,'value',{value:t}),t}}}}function Z(e){return null==e}function N(e){const t=e.startsWith('^')?1:0,n=e.endsWith('$')?e.length-1:e.length;return e.slice(t,n)}const R=Symbol('evaluating');function W(e,t,n){let r;Object.defineProperty(e,t,{get(){if(r!==R)return void 0===r&&(r=R,r=n()),r},set(n){Object.defineProperty(e,t,{value:n})},configurable:!0})}function G(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0})}function V(...e){const t={};for(const n of e){const e=Object.getOwnPropertyDescriptors(n);Object.assign(t,e)}return Object.defineProperties({},t)}function F(e){return JSON.stringify(e)}const U='captureStackTrace'in Error?Error.captureStackTrace:(...e)=>{};function H(e){return'object'==typeof e&&null!==e&&!Array.isArray(e)}const q=B(()=>{if('undefined'!=typeof navigator&&navigator?.userAgent?.includes('Cloudflare'))return!1;try{return new Function(''),!0}catch(e){return!1}});function J(e){if(!1===H(e))return!1;const t=e.constructor;if(void 0===t)return!0;const n=t.prototype;return!1!==H(n)&&!1!==Object.prototype.hasOwnProperty.call(n,'isPrototypeOf')}function K(e){return J(e)?{...e}:e}const Y=new Set(['string','number','symbol']);new Set(['string','number','bigint','boolean','symbol','undefined']);function X(e){return e.replace(/[.*+?^${}()|[\]\\]/g,'\\$&')}function Q(e,t,n){const r=new e._zod.constr(t??e._zod.def);return t&&!n?.parent||(r._zod.parent=e),r}function ee(e){const t=e;if(!t)return{};if('string'==typeof t)return{error:()=>t};if(void 0!==t?.message){if(void 0!==t?.error)throw new Error('Cannot specify both `message` and `error` params');t.error=t.message}return delete t.message,'string'==typeof t.error?{...t,error:()=>t.error}:t}const te={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function ne(e,t=0){if(!0===e.aborted)return!0;for(let n=t;n<e.issues.length;n++)if(!0!==e.issues[n]?.continue)return!0;return!1}function re(e,t){return t.map(t=>{var n;return(n=t).path??(n.path=[]),t.path.unshift(e),t})}function ie(e){return'string'==typeof e?e:e?.message}function oe(e,t,n){const r={...e,path:e.path??[]};if(!e.message){const i=ie(e.inst?._zod.def?.error?.(e))??ie(t?.error?.(e))??ie(n.customError?.(e))??ie(n.localeError?.(e))??'Invalid input';r.message=i}return delete r.inst,delete r.continue,t?.reportInput||delete r.input,r}function ae(e){return Array.isArray(e)?'array':'string'==typeof e?'string':'unknown'}function se(...e){const[t,n,r]=e;return'string'==typeof t?{message:t,code:'custom',input:n,inst:r}:{...t}}const ce=r('$ZodCheck',(e,t)=>{var n;e._zod??(e._zod={}),e._zod.def=t,(n=e._zod).onattach??(n.onattach=[])}),ue={number:'number',bigint:'bigint',object:'date'},le=r('$ZodCheckLessThan',(e,t)=>{ce.init(e,t);const n=ue[typeof t.value];e._zod.onattach.push(e=>{const n=e._zod.bag,r=(t.inclusive?n.maximum:n.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<r&&(t.inclusive?n.maximum=t.value:n.exclusiveMaximum=t.value)}),e._zod.check=r=>{(t.inclusive?r.value<=t.value:r.value<t.value)||r.issues.push({origin:n,code:'too_big',maximum:t.value,input:r.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),de=r('$ZodCheckGreaterThan',(e,t)=>{ce.init(e,t);const n=ue[typeof t.value];e._zod.onattach.push(e=>{const n=e._zod.bag,r=(t.inclusive?n.minimum:n.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>r&&(t.inclusive?n.minimum=t.value:n.exclusiveMinimum=t.value)}),e._zod.check=r=>{(t.inclusive?r.value>=t.value:r.value>t.value)||r.issues.push({origin:n,code:'too_small',minimum:t.value,input:r.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),fe=r('$ZodCheckMultipleOf',(e,t)=>{ce.init(e,t),e._zod.onattach.push(e=>{var n;(n=e._zod.bag).multipleOf??(n.multipleOf=t.value)}),e._zod.check=n=>{if(typeof n.value!=typeof t.value)throw new Error('Cannot mix number and bigint in multiple_of check.');('bigint'==typeof n.value?n.value%t.value===BigInt(0):0===function(e,t){const n=(e.toString().split('.')[1]||'').length,r=t.toString();let i=(r.split('.')[1]||'').length;if(0===i&&/\d?e-\d?/.test(r)){const e=r.match(/\d?e-(\d?)/);e?.[1]&&(i=Number.parseInt(e[1]))}const o=n>i?n:i;return Number.parseInt(e.toFixed(o).replace('.',''))%Number.parseInt(t.toFixed(o).replace('.',''))/10**o}(n.value,t.value))||n.issues.push({origin:typeof n.value,code:'not_multiple_of',divisor:t.value,input:n.value,inst:e,continue:!t.abort})}}),he=r('$ZodCheckNumberFormat',(e,t)=>{ce.init(e,t),t.format=t.format||'float64';const n=t.format?.includes('int'),r=n?'int':'number',[i,o]=te[t.format];e._zod.onattach.push(e=>{const r=e._zod.bag;r.format=t.format,r.minimum=i,r.maximum=o,n&&(r.pattern=L)}),e._zod.check=a=>{const s=a.value;if(n){if(!Number.isInteger(s))return void a.issues.push({expected:r,format:t.format,code:'invalid_type',continue:!1,input:s,inst:e});if(!Number.isSafeInteger(s))return void(s>0?a.issues.push({input:s,code:'too_big',maximum:Number.MAX_SAFE_INTEGER,note:'Integers must be within the safe integer range.',inst:e,origin:r,continue:!t.abort}):a.issues.push({input:s,code:'too_small',minimum:Number.MIN_SAFE_INTEGER,note:'Integers must be within the safe integer range.',inst:e,origin:r,continue:!t.abort}))}s<i&&a.issues.push({origin:'number',input:s,code:'too_small',minimum:i,inclusive:!0,inst:e,continue:!t.abort}),s>o&&a.issues.push({origin:'number',input:s,code:'too_big',maximum:o,inst:e})}}),pe=r('$ZodCheckMaxLength',(e,t)=>{var n;ce.init(e,t),(n=e._zod.def).when??(n.when=e=>{const t=e.value;return!Z(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{const n=e._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<n&&(e._zod.bag.maximum=t.maximum)}),e._zod.check=n=>{const r=n.value;if(r.length<=t.maximum)return;const i=ae(r);n.issues.push({origin:i,code:'too_big',maximum:t.maximum,inclusive:!0,input:r,inst:e,continue:!t.abort})}}),ve=r('$ZodCheckMinLength',(e,t)=>{var n;ce.init(e,t),(n=e._zod.def).when??(n.when=e=>{const t=e.value;return!Z(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{const n=e._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>n&&(e._zod.bag.minimum=t.minimum)}),e._zod.check=n=>{const r=n.value;if(r.length>=t.minimum)return;const i=ae(r);n.issues.push({origin:i,code:'too_small',minimum:t.minimum,inclusive:!0,input:r,inst:e,continue:!t.abort})}}),me=r('$ZodCheckLengthEquals',(e,t)=>{var n;ce.init(e,t),(n=e._zod.def).when??(n.when=e=>{const t=e.value;return!Z(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{const n=e._zod.bag;n.minimum=t.length,n.maximum=t.length,n.length=t.length}),e._zod.check=n=>{const r=n.value,i=r.length;if(i===t.length)return;const o=ae(r),a=i>t.length;n.issues.push({origin:o,...a?{code:'too_big',maximum:t.length}:{code:'too_small',minimum:t.length},inclusive:!0,exact:!0,input:n.value,inst:e,continue:!t.abort})}}),ge=r('$ZodCheckStringFormat',(e,t)=>{var n,r;ce.init(e,t),e._zod.onattach.push(e=>{const n=e._zod.bag;n.format=t.format,t.pattern&&(n.patterns??(n.patterns=new Set),n.patterns.add(t.pattern))}),t.pattern?(n=e._zod).check??(n.check=n=>{t.pattern.lastIndex=0,t.pattern.test(n.value)||n.issues.push({origin:'string',code:'invalid_format',format:t.format,input:n.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(r=e._zod).check??(r.check=()=>{})}),ye=r('$ZodCheckRegex',(e,t)=>{ge.init(e,t),e._zod.check=n=>{t.pattern.lastIndex=0,t.pattern.test(n.value)||n.issues.push({origin:'string',code:'invalid_format',format:'regex',input:n.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),_e=r('$ZodCheckLowerCase',(e,t)=>{t.pattern??(t.pattern=j),ge.init(e,t)}),be=r('$ZodCheckUpperCase',(e,t)=>{t.pattern??(t.pattern=D),ge.init(e,t)}),we=r('$ZodCheckIncludes',(e,t)=>{ce.init(e,t);const n=X(t.includes),r=new RegExp('number'==typeof t.position?`^.{${t.position}}${n}`:n);t.pattern=r,e._zod.onattach.push(e=>{const t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(r)}),e._zod.check=n=>{n.value.includes(t.includes,t.position)||n.issues.push({origin:'string',code:'invalid_format',format:'includes',includes:t.includes,input:n.value,inst:e,continue:!t.abort})}}),ke=r('$ZodCheckStartsWith',(e,t)=>{ce.init(e,t);const n=new RegExp(`^${X(t.prefix)}.*`);t.pattern??(t.pattern=n),e._zod.onattach.push(e=>{const t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(n)}),e._zod.check=n=>{n.value.startsWith(t.prefix)||n.issues.push({origin:'string',code:'invalid_format',format:'starts_with',prefix:t.prefix,input:n.value,inst:e,continue:!t.abort})}}),Se=r('$ZodCheckEndsWith',(e,t)=>{ce.init(e,t);const n=new RegExp(`.*${X(t.suffix)}$`);t.pattern??(t.pattern=n),e._zod.onattach.push(e=>{const t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(n)}),e._zod.check=n=>{n.value.endsWith(t.suffix)||n.issues.push({origin:'string',code:'invalid_format',format:'ends_with',suffix:t.suffix,input:n.value,inst:e,continue:!t.abort})}});const xe=r('$ZodCheckOverwrite',(e,t)=>{ce.init(e,t),e._zod.check=e=>{e.value=t.tx(e.value)}});class ze{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if('function'==typeof e)return e(this,{execution:'sync'}),void e(this,{execution:'async'});const t=e.split('\n').filter(e=>e),n=Math.min(...t.map(e=>e.length-e.trimStart().length)),r=t.map(e=>e.slice(n)).map(e=>' '.repeat(2*this.indent)+e);for(const e of r)this.content.push(e)}compile(){const e=Function,t=this?.args;return new e(...t,[...(this?.content??['']).map(e=>`  ${e}`)].join('\n'))}}const $e=(e,t)=>{e.name='$ZodError',Object.defineProperty(e,'_zod',{value:e._zod,enumerable:!1}),Object.defineProperty(e,'issues',{value:t,enumerable:!1}),e.message=JSON.stringify(t,O,2),Object.defineProperty(e,'toString',{value:()=>e.message,enumerable:!1})},Ce=r('$ZodError',$e),Ae=r('$ZodError',$e,{Parent:Error});const Ee=e=>(t,n,r,o)=>{const a=r?Object.assign(r,{async:!1}):{async:!1},c=t._zod.run({value:n,issues:[]},a);if(c instanceof Promise)throw new i;if(c.issues.length){const t=new(o?.Err??e)(c.issues.map(e=>oe(e,a,s())));throw U(t,o?.callee),t}return c.value},Ie=e=>async(t,n,r,i)=>{const o=r?Object.assign(r,{async:!0}):{async:!0};let a=t._zod.run({value:n,issues:[]},o);if(a instanceof Promise&&(a=await a),a.issues.length){const t=new(i?.Err??e)(a.issues.map(e=>oe(e,o,s())));throw U(t,i?.callee),t}return a.value},Me=e=>(t,n,r)=>{const o=r?{...r,async:!1}:{async:!1},a=t._zod.run({value:n,issues:[]},o);if(a instanceof Promise)throw new i;return a.issues.length?{success:!1,error:new(e??Ce)(a.issues.map(e=>oe(e,o,s())))}:{success:!0,data:a.value}},Le=Me(Ae),Te=e=>async(t,n,r)=>{const i=r?Object.assign(r,{async:!0}):{async:!0};let o=t._zod.run({value:n,issues:[]},i);return o instanceof Promise&&(o=await o),o.issues.length?{success:!1,error:new e(o.issues.map(e=>oe(e,i,s())))}:{success:!0,data:o.value}},Pe=Te(Ae),je=e=>(t,n,r)=>{const i=r?Object.assign(r,{direction:'backward'}):{direction:'backward'};return Ee(e)(t,n,i)},De=e=>(t,n,r)=>Ee(e)(t,n,r),Oe=e=>async(t,n,r)=>{const i=r?Object.assign(r,{direction:'backward'}):{direction:'backward'};return Ie(e)(t,n,i)},Be=e=>async(t,n,r)=>Ie(e)(t,n,r),Ze=e=>(t,n,r)=>{const i=r?Object.assign(r,{direction:'backward'}):{direction:'backward'};return Me(e)(t,n,i)},Ne=e=>(t,n,r)=>Me(e)(t,n,r),Re=e=>async(t,n,r)=>{const i=r?Object.assign(r,{direction:'backward'}):{direction:'backward'};return Te(e)(t,n,i)},We=e=>async(t,n,r)=>Te(e)(t,n,r),Ge={major:4,minor:1,patch:5},Ve=r('$ZodType',(e,t)=>{var n;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=Ge;const r=[...e._zod.def.checks??[]];e._zod.traits.has('$ZodCheck')&&r.unshift(e);for(const t of r)for(const n of t._zod.onattach)n(e);if(0===r.length)(n=e._zod).deferred??(n.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{const t=(e,t,n)=>{let r,o=ne(e);for(const a of t){if(a._zod.def.when){if(!a._zod.def.when(e))continue}else if(o)continue;const t=e.issues.length,_=a._zod.check(e);if(_ instanceof Promise&&!1===n?.async)throw new i;if(r||_ instanceof Promise)r=(r??Promise.resolve()).then(async()=>{await _;e.issues.length!==t&&(o||(o=ne(e,t)))});else{if(e.issues.length===t)continue;o||(o=ne(e,t))}}return r?r.then(()=>e):e},n=(n,o,a)=>{if(ne(n))return n.aborted=!0,n;const s=t(o,r,a);if(s instanceof Promise){if(!1===a.async)throw new i;return s.then(t=>e._zod.parse(t,a))}return e._zod.parse(s,a)};e._zod.run=(o,a)=>{if(a.skipChecks)return e._zod.parse(o,a);if('backward'===a.direction){const t=e._zod.parse({value:o.value,issues:[]},{...a,skipChecks:!0});return t instanceof Promise?t.then(e=>n(e,o,a)):n(t,o,a)}const s=e._zod.parse(o,a);if(s instanceof Promise){if(!1===a.async)throw new i;return s.then(e=>t(e,r,a))}return t(s,r,a)}}e['~standard']={validate:t=>{try{const n=Le(e,t);return n.success?{value:n.data}:{issues:n.error?.issues}}catch(n){return Pe(e,t).then(e=>e.success?{value:e.data}:{issues:e.error?.issues})}},vendor:'zod',version:1}}),Fe=r('$ZodString',(e,t)=>{var n;Ve.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??(n=e._zod.bag,new RegExp(`^${n?`[\\s\\S]{${n?.minimum??0},${n?.maximum??''}}`:'[\\s\\S]*'}$`)),e._zod.parse=(n,_)=>{if(t.coerce)try{n.value=String(n.value)}catch(_){}return'string'==typeof n.value||n.issues.push({expected:'string',code:'invalid_type',input:n.value,inst:e}),n}}),Ue=r('$ZodStringFormat',(e,t)=>{ge.init(e,t),Fe.init(e,t)}),He=r('$ZodGUID',(e,t)=>{t.pattern??(t.pattern=v),Ue.init(e,t)}),qe=r('$ZodUUID',(e,t)=>{if(t.version){const e={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(void 0===e)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=m(e))}else t.pattern??(t.pattern=m());Ue.init(e,t)}),Je=r('$ZodEmail',(e,t)=>{t.pattern??(t.pattern=g),Ue.init(e,t)}),Ke=r('$ZodURL',(e,t)=>{Ue.init(e,t),e._zod.check=n=>{try{const r=n.value.trim(),i=new URL(r);return t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(i.hostname)||n.issues.push({code:'invalid_format',format:'url',note:'Invalid hostname',pattern:C.source,input:n.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(i.protocol.endsWith(':')?i.protocol.slice(0,-1):i.protocol)||n.issues.push({code:'invalid_format',format:'url',note:'Invalid protocol',pattern:t.protocol.source,input:n.value,inst:e,continue:!t.abort})),void(t.normalize?n.value=i.href:n.value=r)}catch(r){n.issues.push({code:'invalid_format',format:'url',input:n.value,inst:e,continue:!t.abort})}}}),Ye=r('$ZodEmoji',(e,t)=>{t.pattern??(t.pattern=new RegExp('^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$','u')),Ue.init(e,t)}),Xe=r('$ZodNanoID',(e,t)=>{t.pattern??(t.pattern=h),Ue.init(e,t)}),Qe=r('$ZodCUID',(e,t)=>{t.pattern??(t.pattern=c),Ue.init(e,t)}),et=r('$ZodCUID2',(e,t)=>{t.pattern??(t.pattern=u),Ue.init(e,t)}),tt=r('$ZodULID',(e,t)=>{t.pattern??(t.pattern=l),Ue.init(e,t)}),nt=r('$ZodXID',(e,t)=>{t.pattern??(t.pattern=d),Ue.init(e,t)}),rt=r('$ZodKSUID',(e,t)=>{t.pattern??(t.pattern=f),Ue.init(e,t)}),it=r('$ZodISODateTime',(e,t)=>{t.pattern??(t.pattern=function(e){const t=M({precision:e.precision}),n=['Z'];e.local&&n.push(''),e.offset&&n.push('([+-](?:[01]\\d|2[0-3]):[0-5]\\d)');const r=`${t}(?:${n.join('|')})`;return new RegExp(`^${E}T(?:${r})$`)}(t)),Ue.init(e,t)}),ot=r('$ZodISODate',(e,t)=>{t.pattern??(t.pattern=I),Ue.init(e,t)}),at=r('$ZodISOTime',(e,t)=>{t.pattern??(t.pattern=new RegExp(`^${M(t)}$`)),Ue.init(e,t)}),st=r('$ZodISODuration',(e,t)=>{t.pattern??(t.pattern=p),Ue.init(e,t)}),ct=r('$ZodIPv4',(e,t)=>{t.pattern??(t.pattern=y),Ue.init(e,t),e._zod.onattach.push(e=>{e._zod.bag.format='ipv4'})}),ut=r('$ZodIPv6',(e,t)=>{t.pattern??(t.pattern=b),Ue.init(e,t),e._zod.onattach.push(e=>{e._zod.bag.format='ipv6'}),e._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:'invalid_format',format:'ipv6',input:n.value,inst:e,continue:!t.abort})}}}),lt=r('$ZodCIDRv4',(e,t)=>{t.pattern??(t.pattern=w),Ue.init(e,t)}),dt=r('$ZodCIDRv6',(e,t)=>{t.pattern??(t.pattern=k),Ue.init(e,t),e._zod.check=n=>{const[r,i]=n.value.split('/');try{if(!i)throw new Error;const e=Number(i);if(`${e}`!==i)throw new Error;if(e<0||e>128)throw new Error;new URL(`http://[${r}]`)}catch{n.issues.push({code:'invalid_format',format:'cidrv6',input:n.value,inst:e,continue:!t.abort})}}});function ft(e){if(''===e)return!0;if(e.length%4!=0)return!1;try{return atob(e),!0}catch{return!1}}const ht=r('$ZodBase64',(e,t)=>{t.pattern??(t.pattern=S),Ue.init(e,t),e._zod.onattach.push(e=>{e._zod.bag.contentEncoding='base64'}),e._zod.check=n=>{ft(n.value)||n.issues.push({code:'invalid_format',format:'base64',input:n.value,inst:e,continue:!t.abort})}});const pt=r('$ZodBase64URL',(e,t)=>{t.pattern??(t.pattern=x),Ue.init(e,t),e._zod.onattach.push(e=>{e._zod.bag.contentEncoding='base64url'}),e._zod.check=n=>{(function(e){if(!x.test(e))return!1;const t=e.replace(/[-_]/g,e=>'-'===e?'+':'/');return ft(t.padEnd(4*Math.ceil(t.length/4),'='))})(n.value)||n.issues.push({code:'invalid_format',format:'base64url',input:n.value,inst:e,continue:!t.abort})}}),vt=r('$ZodE164',(e,t)=>{t.pattern??(t.pattern=A),Ue.init(e,t)});const mt=r('$ZodJWT',(e,t)=>{Ue.init(e,t),e._zod.check=n=>{(function(e,t=null){try{const n=e.split('.');if(3!==n.length)return!1;const[r]=n;if(!r)return!1;const i=JSON.parse(atob(r));return!('typ'in i&&'JWT'!==i?.typ||!i.alg||t&&(!('alg'in i)||i.alg!==t))}catch{return!1}})(n.value,t.alg)||n.issues.push({code:'invalid_format',format:'jwt',input:n.value,inst:e,continue:!t.abort})}}),gt=r('$ZodNumber',(e,t)=>{Ve.init(e,t),e._zod.pattern=e._zod.bag.pattern??T,e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=Number(n.value)}catch(e){}const i=n.value;if('number'==typeof i&&!Number.isNaN(i)&&Number.isFinite(i))return n;const o='number'==typeof i?Number.isNaN(i)?'NaN':Number.isFinite(i)?void 0:'Infinity':void 0;return n.issues.push({expected:'number',code:'invalid_type',input:i,inst:e,...o?{received:o}:{}}),n}}),yt=r('$ZodNumber',(e,t)=>{he.init(e,t),gt.init(e,t)}),_t=r('$ZodBoolean',(e,t)=>{Ve.init(e,t),e._zod.pattern=P,e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=Boolean(n.value)}catch(e){}const i=n.value;return'boolean'==typeof i||n.issues.push({expected:'boolean',code:'invalid_type',input:i,inst:e}),n}}),bt=r('$ZodAny',(e,t)=>{Ve.init(e,t),e._zod.parse=e=>e}),wt=r('$ZodUnknown',(e,t)=>{Ve.init(e,t),e._zod.parse=e=>e}),kt=r('$ZodNever',(e,t)=>{Ve.init(e,t),e._zod.parse=(t,n)=>(t.issues.push({expected:'never',code:'invalid_type',input:t.value,inst:e}),t)});function St(e,t,n){e.issues.length&&t.issues.push(...re(n,e.issues)),t.value[n]=e.value}const xt=r('$ZodArray',(e,t)=>{Ve.init(e,t),e._zod.parse=(n,r)=>{const i=n.value;if(!Array.isArray(i))return n.issues.push({expected:'array',code:'invalid_type',input:i,inst:e}),n;n.value=Array(i.length);const o=[];for(let e=0;e<i.length;e++){const a=i[e],s=t.element._zod.run({value:a,issues:[]},r);s instanceof Promise?o.push(s.then(t=>St(t,n,e))):St(s,n,e)}return o.length?Promise.all(o).then(()=>n):n}});function zt(e,t,n,r){e.issues.length&&t.issues.push(...re(n,e.issues)),void 0===e.value?n in r&&(t.value[n]=void 0):t.value[n]=e.value}function $t(e){const t=Object.keys(e.shape);for(const n of t)if(!e.shape[n]._zod.traits.has('$ZodType'))throw new Error(`Invalid element at key "${n}": expected a Zod schema`);const n=(r=e.shape,Object.keys(r).filter(e=>'optional'===r[e]._zod.optin&&'optional'===r[e]._zod.optout));var r;return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(n)}}function Ct(e,t,n,r,i,o){const a=[],s=i.keySet,c=i.catchall._zod,u=c.def.type;for(const i of Object.keys(t)){if(s.has(i))continue;if('never'===u){a.push(i);continue}const o=c.run({value:t[i],issues:[]},r);o instanceof Promise?e.push(o.then(e=>zt(e,n,i,t))):zt(o,n,i,t)}return a.length&&n.issues.push({code:'unrecognized_keys',keys:a,input:t,inst:o}),e.length?Promise.all(e).then(()=>n):n}const At=r('$ZodObject',(e,t)=>{Ve.init(e,t);const n=B(()=>$t(t));W(e._zod,'propValues',()=>{const e=t.shape,n={};for(const t in e){const r=e[t]._zod;if(r.values){n[t]??(n[t]=new Set);for(const e of r.values)n[t].add(e)}}return n});const r=H,i=t.catchall;let o;e._zod.parse=(t,a)=>{o??(o=n.value);const s=t.value;if(!r(s))return t.issues.push({expected:'object',code:'invalid_type',input:s,inst:e}),t;t.value={};const c=[],u=o.shape;for(const e of o.keys){const n=u[e]._zod.run({value:s[e],issues:[]},a);n instanceof Promise?c.push(n.then(n=>zt(n,t,e,s))):zt(n,t,e,s)}return i?Ct(c,s,t,a,n.value,e):c.length?Promise.all(c).then(()=>t):t}}),Et=r('$ZodObjectJIT',(e,t)=>{At.init(e,t);const n=e._zod.parse,r=B(()=>$t(t));let i;const o=H,s=!a.jitless,c=s&&q.value,u=t.catchall;let l;e._zod.parse=(a,d)=>{l??(l=r.value);const f=a.value;return o(f)?s&&c&&!1===d?.async&&!0!==d.jitless?(i||(i=(e=>{const t=new ze(['shape','payload','ctx']),n=r.value,i=e=>{const t=F(e);return`shape[${t}]._zod.run({ value: input[${t}], issues: [] }, ctx)`};t.write('const input = payload.value;');const o=Object.create(null);let a=0;for(const e of n.keys)o[e]='key_'+a++;t.write('const newResult = {}');for(const e of n.keys){const n=o[e],r=F(e);t.write(`const ${n} = ${i(e)};`),t.write(`\n        if (${n}.issues.length) {\n          payload.issues = payload.issues.concat(${n}.issues.map(iss => ({\n            ...iss,\n            path: iss.path ? [${r}, ...iss.path] : [${r}]\n          })));\n        }\n        \n        if (${n}.value === undefined) {\n          if (${r} in input) {\n            newResult[${r}] = undefined;\n          }\n        } else {\n          newResult[${r}] = ${n}.value;\n        }\n      `)}t.write('payload.value = newResult;'),t.write('return payload;');const s=t.compile();return(t,n)=>s(e,t,n)})(t.shape)),a=i(a,d),u?Ct([],f,a,d,l,e):a):n(a,d):(a.issues.push({expected:'object',code:'invalid_type',input:f,inst:e}),a)}});function It(e,t,n,r){for(const n of e)if(0===n.issues.length)return t.value=n.value,t;const i=e.filter(e=>!ne(e));return 1===i.length?(t.value=i[0].value,i[0]):(t.issues.push({code:'invalid_union',input:t.value,inst:n,errors:e.map(e=>e.issues.map(e=>oe(e,r,s())))}),t)}const Mt=r('$ZodUnion',(e,t)=>{Ve.init(e,t),W(e._zod,'optin',()=>t.options.some(e=>'optional'===e._zod.optin)?'optional':void 0),W(e._zod,'optout',()=>t.options.some(e=>'optional'===e._zod.optout)?'optional':void 0),W(e._zod,'values',()=>{if(t.options.every(e=>e._zod.values))return new Set(t.options.flatMap(e=>Array.from(e._zod.values)))}),W(e._zod,'pattern',()=>{if(t.options.every(e=>e._zod.pattern)){const e=t.options.map(e=>e._zod.pattern);return new RegExp(`^(${e.map(e=>N(e.source)).join('|')})$`)}});const n=1===t.options.length,r=t.options[0]._zod.run;e._zod.parse=(i,o)=>{if(n)return r(i,o);let a=!1;const s=[];for(const e of t.options){const t=e._zod.run({value:i.value,issues:[]},o);if(t instanceof Promise)s.push(t),a=!0;else{if(0===t.issues.length)return t;s.push(t)}}return a?Promise.all(s).then(t=>It(t,i,e,o)):It(s,i,e,o)}}),Lt=r('$ZodIntersection',(e,t)=>{Ve.init(e,t),e._zod.parse=(e,n)=>{const r=e.value,i=t.left._zod.run({value:r,issues:[]},n),o=t.right._zod.run({value:r,issues:[]},n);return i instanceof Promise||o instanceof Promise?Promise.all([i,o]).then(([t,n])=>Pt(e,t,n)):Pt(e,i,o)}});function Tt(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e===+t)return{valid:!0,data:e};if(J(e)&&J(t)){const n=Object.keys(t),r=Object.keys(e).filter(e=>-1!==n.indexOf(e)),i={...e,...t};for(const n of r){const r=Tt(e[n],t[n]);if(!r.valid)return{valid:!1,mergeErrorPath:[n,...r.mergeErrorPath]};i[n]=r.data}return{valid:!0,data:i}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let r=0;r<e.length;r++){const i=Tt(e[r],t[r]);if(!i.valid)return{valid:!1,mergeErrorPath:[r,...i.mergeErrorPath]};n.push(i.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function Pt(e,t,n){if(t.issues.length&&e.issues.push(...t.issues),n.issues.length&&e.issues.push(...n.issues),ne(e))return e;const r=Tt(t.value,n.value);if(!r.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(r.mergeErrorPath)}`);return e.value=r.data,e}const jt=r('$ZodRecord',(e,t)=>{Ve.init(e,t),e._zod.parse=(n,r)=>{const i=n.value;if(!J(i))return n.issues.push({expected:'record',code:'invalid_type',input:i,inst:e}),n;const o=[];if(t.keyType._zod.values){const a=t.keyType._zod.values;n.value={};for(const e of a)if('string'==typeof e||'number'==typeof e||'symbol'==typeof e){const a=t.valueType._zod.run({value:i[e],issues:[]},r);a instanceof Promise?o.push(a.then(t=>{t.issues.length&&n.issues.push(...re(e,t.issues)),n.value[e]=t.value})):(a.issues.length&&n.issues.push(...re(e,a.issues)),n.value[e]=a.value)}let s;for(const e in i)a.has(e)||(s=s??[],s.push(e));s&&s.length>0&&n.issues.push({code:'unrecognized_keys',input:i,inst:e,keys:s})}else{n.value={};for(const a of Reflect.ownKeys(i)){if('__proto__'===a)continue;const c=t.keyType._zod.run({value:a,issues:[]},r);if(c instanceof Promise)throw new Error('Async schemas not supported in object keys currently');if(c.issues.length){n.issues.push({code:'invalid_key',origin:'record',issues:c.issues.map(e=>oe(e,r,s())),input:a,path:[a],inst:e}),n.value[c.value]=c.value;continue}const u=t.valueType._zod.run({value:i[a],issues:[]},r);u instanceof Promise?o.push(u.then(e=>{e.issues.length&&n.issues.push(...re(a,e.issues)),n.value[c.value]=e.value})):(u.issues.length&&n.issues.push(...re(a,u.issues)),n.value[c.value]=u.value)}}return o.length?Promise.all(o).then(()=>n):n}});const Dt=r('$ZodEnum',(e,t)=>{Ve.init(e,t);const n=function(e){const t=Object.values(e).filter(e=>'number'==typeof e);return Object.entries(e).filter(([e,_])=>-1===t.indexOf(+e)).map(([_,e])=>e)}(t.entries),r=new Set(n);e._zod.values=r,e._zod.pattern=new RegExp(`^(${n.filter(e=>Y.has(typeof e)).map(e=>'string'==typeof e?X(e):e.toString()).join('|')})$`),e._zod.parse=(t,i)=>{const o=t.value;return r.has(o)||t.issues.push({code:'invalid_value',values:n,input:o,inst:e}),t}}),Ot=r('$ZodTransform',(e,t)=>{Ve.init(e,t),e._zod.parse=(n,r)=>{if('backward'===r.direction)throw new o(e.constructor.name);const a=t.transform(n.value,n);if(r.async){return(a instanceof Promise?a:Promise.resolve(a)).then(e=>(n.value=e,n))}if(a instanceof Promise)throw new i;return n.value=a,n}});function Bt(e,t){return e.issues.length&&void 0===t?{issues:[],value:void 0}:e}const Zt=r('$ZodOptional',(e,t)=>{Ve.init(e,t),e._zod.optin='optional',e._zod.optout='optional',W(e._zod,'values',()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),W(e._zod,'pattern',()=>{const e=t.innerType._zod.pattern;return e?new RegExp(`^(${N(e.source)})?$`):void 0}),e._zod.parse=(e,n)=>{if('optional'===t.innerType._zod.optin){const r=t.innerType._zod.run(e,n);return r instanceof Promise?r.then(t=>Bt(t,e.value)):Bt(r,e.value)}return void 0===e.value?e:t.innerType._zod.run(e,n)}}),Nt=r('$ZodNullable',(e,t)=>{Ve.init(e,t),W(e._zod,'optin',()=>t.innerType._zod.optin),W(e._zod,'optout',()=>t.innerType._zod.optout),W(e._zod,'pattern',()=>{const e=t.innerType._zod.pattern;return e?new RegExp(`^(${N(e.source)}|null)$`):void 0}),W(e._zod,'values',()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(e,n)=>null===e.value?e:t.innerType._zod.run(e,n)}),Rt=r('$ZodDefault',(e,t)=>{Ve.init(e,t),e._zod.optin='optional',W(e._zod,'values',()=>t.innerType._zod.values),e._zod.parse=(e,n)=>{if('backward'===n.direction)return t.innerType._zod.run(e,n);if(void 0===e.value)return e.value=t.defaultValue,e;const r=t.innerType._zod.run(e,n);return r instanceof Promise?r.then(e=>Wt(e,t)):Wt(r,t)}});function Wt(e,t){return void 0===e.value&&(e.value=t.defaultValue),e}const Gt=r('$ZodPrefault',(e,t)=>{Ve.init(e,t),e._zod.optin='optional',W(e._zod,'values',()=>t.innerType._zod.values),e._zod.parse=(e,n)=>('backward'===n.direction||void 0===e.value&&(e.value=t.defaultValue),t.innerType._zod.run(e,n))}),Vt=r('$ZodNonOptional',(e,t)=>{Ve.init(e,t),W(e._zod,'values',()=>{const e=t.innerType._zod.values;return e?new Set([...e].filter(e=>void 0!==e)):void 0}),e._zod.parse=(n,r)=>{const i=t.innerType._zod.run(n,r);return i instanceof Promise?i.then(t=>Ft(t,e)):Ft(i,e)}});function Ft(e,t){return e.issues.length||void 0!==e.value||e.issues.push({code:'invalid_type',expected:'nonoptional',input:e.value,inst:t}),e}const Ut=r('$ZodCatch',(e,t)=>{Ve.init(e,t),W(e._zod,'optin',()=>t.innerType._zod.optin),W(e._zod,'optout',()=>t.innerType._zod.optout),W(e._zod,'values',()=>t.innerType._zod.values),e._zod.parse=(e,n)=>{if('backward'===n.direction)return t.innerType._zod.run(e,n);const r=t.innerType._zod.run(e,n);return r instanceof Promise?r.then(r=>(e.value=r.value,r.issues.length&&(e.value=t.catchValue({...e,error:{issues:r.issues.map(e=>oe(e,n,s()))},input:e.value}),e.issues=[]),e)):(e.value=r.value,r.issues.length&&(e.value=t.catchValue({...e,error:{issues:r.issues.map(e=>oe(e,n,s()))},input:e.value}),e.issues=[]),e)}}),Ht=r('$ZodPipe',(e,t)=>{Ve.init(e,t),W(e._zod,'values',()=>t.in._zod.values),W(e._zod,'optin',()=>t.in._zod.optin),W(e._zod,'optout',()=>t.out._zod.optout),W(e._zod,'propValues',()=>t.in._zod.propValues),e._zod.parse=(e,n)=>{if('backward'===n.direction){const r=t.out._zod.run(e,n);return r instanceof Promise?r.then(e=>qt(e,t.in,n)):qt(r,t.in,n)}const r=t.in._zod.run(e,n);return r instanceof Promise?r.then(e=>qt(e,t.out,n)):qt(r,t.out,n)}});function qt(e,t,n){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},n)}const Jt=r('$ZodReadonly',(e,t)=>{Ve.init(e,t),W(e._zod,'propValues',()=>t.innerType._zod.propValues),W(e._zod,'values',()=>t.innerType._zod.values),W(e._zod,'optin',()=>t.innerType._zod.optin),W(e._zod,'optout',()=>t.innerType._zod.optout),e._zod.parse=(e,n)=>{if('backward'===n.direction)return t.innerType._zod.run(e,n);const r=t.innerType._zod.run(e,n);return r instanceof Promise?r.then(Kt):Kt(r)}});function Kt(e){return e.value=Object.freeze(e.value),e}const Yt=r('$ZodCustom',(e,t)=>{ce.init(e,t),Ve.init(e,t),e._zod.parse=(e,_)=>e,e._zod.check=n=>{const r=n.value,i=t.fn(r);if(i instanceof Promise)return i.then(t=>Xt(t,n,r,e));Xt(i,n,r,e)}});function Xt(e,t,n,r){if(!e){const e={code:'custom',input:n,inst:r,path:[...r._zod.def.path??[]],continue:!r._zod.def.abort};r._zod.def.params&&(e.params=r._zod.def.params),t.issues.push(se(e))}}Symbol('ZodOutput'),Symbol('ZodInput');class Qt{constructor(){this._map=new Map,this._idmap=new Map}add(e,...t){const n=t[0];if(this._map.set(e,n),n&&'object'==typeof n&&'id'in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){const t=this._map.get(e);return t&&'object'==typeof t&&'id'in t&&this._idmap.delete(t.id),this._map.delete(e),this}get(e){const t=e._zod.parent;if(t){const n={...this.get(t)??{}};delete n.id;const r={...n,...this._map.get(e)};return Object.keys(r).length?r:void 0}return this._map.get(e)}has(e){return this._map.has(e)}}function en(){return new Qt}const tn=en();function nn(e,t){return new e({type:'string',format:'guid',check:'string_format',abort:!1,...ee(t)})}function rn(e,t){return new le({check:'less_than',...ee(t),value:e,inclusive:!1})}function on(e,t){return new le({check:'less_than',...ee(t),value:e,inclusive:!0})}function an(e,t){return new de({check:'greater_than',...ee(t),value:e,inclusive:!1})}function sn(e,t){return new de({check:'greater_than',...ee(t),value:e,inclusive:!0})}function cn(e,t){return new fe({check:'multiple_of',...ee(t),value:e})}function un(e,t){return new pe({check:'max_length',...ee(t),maximum:e})}function ln(e,t){return new ve({check:'min_length',...ee(t),minimum:e})}function dn(e,t){return new me({check:'length_equals',...ee(t),length:e})}function fn(e){return new xe({check:'overwrite',tx:e})}function hn(e){const t=function(e,t){const n=new ce({check:'custom',...ee(t)});return n._zod.check=e,n}(n=>(n.addIssue=e=>{if('string'==typeof e)n.issues.push(se(e,n.value,t._zod.def));else{const r=e;r.fatal&&(r.continue=!1),r.code??(r.code='custom'),r.input??(r.input=n.value),r.inst??(r.inst=t),r.continue??(r.continue=!t._zod.def.abort),n.issues.push(se(r))}},e(n.value,n)));return t}const pn=r('ZodISODateTime',(e,t)=>{it.init(e,t),Rn.init(e,t)});function vn(e){return function(e,t){return new e({type:'string',format:'datetime',check:'string_format',offset:!1,local:!1,precision:null,...ee(t)})}(pn,e)}const mn=r('ZodISODate',(e,t)=>{ot.init(e,t),Rn.init(e,t)});function gn(e){return function(e,t){return new e({type:'string',format:'date',check:'string_format',...ee(t)})}(mn,e)}const yn=r('ZodISOTime',(e,t)=>{at.init(e,t),Rn.init(e,t)});function _n(e){return function(e,t){return new e({type:'string',format:'time',check:'string_format',precision:null,...ee(t)})}(yn,e)}const bn=r('ZodISODuration',(e,t)=>{st.init(e,t),Rn.init(e,t)});function wn(e){return function(e,t){return new e({type:'string',format:'duration',check:'string_format',...ee(t)})}(bn,e)}const kn=(e,t)=>{Ce.init(e,t),e.name='ZodError',Object.defineProperties(e,{format:{value:t=>function(e,t){const n=t||function(e){return e.message},r={_errors:[]},i=e=>{for(const t of e.issues)if('invalid_union'===t.code&&t.errors.length)t.errors.map(e=>i({issues:e}));else if('invalid_key'===t.code)i({issues:t.issues});else if('invalid_element'===t.code)i({issues:t.issues});else if(0===t.path.length)r._errors.push(n(t));else{let e=r,i=0;for(;i<t.path.length;){const r=t.path[i];i===t.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(n(t))):e[r]=e[r]||{_errors:[]},e=e[r],i++}}};return i(e),r}(e,t)},flatten:{value:t=>function(e,t=e=>e.message){const n={},r=[];for(const i of e.issues)i.path.length>0?(n[i.path[0]]=n[i.path[0]]||[],n[i.path[0]].push(t(i))):r.push(t(i));return{formErrors:r,fieldErrors:n}}(e,t)},addIssue:{value:t=>{e.issues.push(t),e.message=JSON.stringify(e.issues,O,2)}},addIssues:{value:t=>{e.issues.push(...t),e.message=JSON.stringify(e.issues,O,2)}},isEmpty:{get:()=>0===e.issues.length}})},Sn=r('ZodError',kn),xn=r('ZodError',kn,{Parent:Error}),zn=Ee(xn),$n=Ie(xn),Cn=Me(xn),An=Te(xn),En=je(xn),In=De(xn),Mn=Oe(xn),Ln=Be(xn),Tn=Ze(xn),Pn=Ne(xn),jn=Re(xn),Dn=We(xn),On=r('ZodType',(e,t)=>(Ve.init(e,t),e.def=t,e.type=t.type,Object.defineProperty(e,'_def',{value:t}),e.check=(...n)=>e.clone({...t,checks:[...t.checks??[],...n.map(e=>'function'==typeof e?{_zod:{check:e,def:{check:'custom'},onattach:[]}}:e)]}),e.clone=(t,n)=>Q(e,t,n),e.brand=()=>e,e.register=(t,n)=>(t.add(e,n),e),e.parse=(t,n)=>zn(e,t,n,{callee:e.parse}),e.safeParse=(t,n)=>Cn(e,t,n),e.parseAsync=async(t,n)=>$n(e,t,n,{callee:e.parseAsync}),e.safeParseAsync=async(t,n)=>An(e,t,n),e.spa=e.safeParseAsync,e.encode=(t,n)=>En(e,t,n),e.decode=(t,n)=>In(e,t,n),e.encodeAsync=async(t,n)=>Mn(e,t,n),e.decodeAsync=async(t,n)=>Ln(e,t,n),e.safeEncode=(t,n)=>Tn(e,t,n),e.safeDecode=(t,n)=>Pn(e,t,n),e.safeEncodeAsync=async(t,n)=>jn(e,t,n),e.safeDecodeAsync=async(t,n)=>Dn(e,t,n),e.refine=(t,n)=>e.check(function(e,t={}){return function(e,t,n){return new e({type:'custom',check:'custom',fn:t,...ee(n)})}(Wr,e,t)}(t,n)),e.superRefine=t=>e.check(hn(t)),e.overwrite=t=>e.check(fn(t)),e.optional=()=>Lr(e),e.nullable=()=>Pr(e),e.nullish=()=>Lr(Pr(e)),e.nonoptional=t=>function(e,t){return new Or({type:'nonoptional',innerType:e,...ee(t)})}(e,t),e.array=()=>_r(e),e.or=t=>Sr([e,t]),e.and=t=>new xr({type:'intersection',left:e,right:t}),e.transform=t=>Nr(e,Ir(t)),e.default=t=>{return n=t,new jr({type:'default',innerType:e,get defaultValue(){return'function'==typeof n?n():K(n)}});var n},e.prefault=t=>{return n=t,new Dr({type:'prefault',innerType:e,get defaultValue(){return'function'==typeof n?n():K(n)}});var n},e.catch=t=>{return new Br({type:'catch',innerType:e,catchValue:'function'==typeof(n=t)?n:()=>n});var n},e.pipe=t=>Nr(e,t),e.readonly=()=>new Rr({type:'readonly',innerType:e}),e.describe=t=>{const n=e.clone();return tn.add(n,{description:t}),n},Object.defineProperty(e,'description',{get:()=>tn.get(e)?.description,configurable:!0}),e.meta=(...t)=>{if(0===t.length)return tn.get(e);const n=e.clone();return tn.add(n,t[0]),n},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),Bn=r('_ZodString',(e,t)=>{Fe.init(e,t),On.init(e,t);const n=e._zod.bag;e.format=n.format??null,e.minLength=n.minimum??null,e.maxLength=n.maximum??null,e.regex=(...t)=>e.check(function(e,t){return new ye({check:'string_format',format:'regex',...ee(t),pattern:e})}(...t)),e.includes=(...t)=>e.check(function(e,t){return new we({check:'string_format',format:'includes',...ee(t),includes:e})}(...t)),e.startsWith=(...t)=>e.check(function(e,t){return new ke({check:'string_format',format:'starts_with',...ee(t),prefix:e})}(...t)),e.endsWith=(...t)=>e.check(function(e,t){return new Se({check:'string_format',format:'ends_with',...ee(t),suffix:e})}(...t)),e.min=(...t)=>e.check(ln(...t)),e.max=(...t)=>e.check(un(...t)),e.length=(...t)=>e.check(dn(...t)),e.nonempty=(...t)=>e.check(ln(1,...t)),e.lowercase=t=>e.check(function(e){return new _e({check:'string_format',format:'lowercase',...ee(e)})}(t)),e.uppercase=t=>e.check(function(e){return new be({check:'string_format',format:'uppercase',...ee(e)})}(t)),e.trim=()=>e.check(fn(e=>e.trim())),e.normalize=(...t)=>e.check(function(e){return fn(t=>t.normalize(e))}(...t)),e.toLowerCase=()=>e.check(fn(e=>e.toLowerCase())),e.toUpperCase=()=>e.check(fn(e=>e.toUpperCase()))}),Zn=r('ZodString',(e,t)=>{Fe.init(e,t),Bn.init(e,t),e.email=t=>e.check(function(e,t){return new e({type:'string',format:'email',check:'string_format',abort:!1,...ee(t)})}(Wn,t)),e.url=t=>e.check(function(e,t){return new e({type:'string',format:'url',check:'string_format',abort:!1,...ee(t)})}(Fn,t)),e.jwt=t=>e.check(function(e,t){return new e({type:'string',format:'jwt',check:'string_format',abort:!1,...ee(t)})}(ar,t)),e.emoji=t=>e.check(function(e,t){return new e({type:'string',format:'emoji',check:'string_format',abort:!1,...ee(t)})}(Un,t)),e.guid=t=>e.check(nn(Gn,t)),e.uuid=t=>e.check(function(e,t){return new e({type:'string',format:'uuid',check:'string_format',abort:!1,...ee(t)})}(Vn,t)),e.uuidv4=t=>e.check(function(e,t){return new e({type:'string',format:'uuid',check:'string_format',abort:!1,version:'v4',...ee(t)})}(Vn,t)),e.uuidv6=t=>e.check(function(e,t){return new e({type:'string',format:'uuid',check:'string_format',abort:!1,version:'v6',...ee(t)})}(Vn,t)),e.uuidv7=t=>e.check(function(e,t){return new e({type:'string',format:'uuid',check:'string_format',abort:!1,version:'v7',...ee(t)})}(Vn,t)),e.nanoid=t=>e.check(function(e,t){return new e({type:'string',format:'nanoid',check:'string_format',abort:!1,...ee(t)})}(Hn,t)),e.guid=t=>e.check(nn(Gn,t)),e.cuid=t=>e.check(function(e,t){return new e({type:'string',format:'cuid',check:'string_format',abort:!1,...ee(t)})}(qn,t)),e.cuid2=t=>e.check(function(e,t){return new e({type:'string',format:'cuid2',check:'string_format',abort:!1,...ee(t)})}(Jn,t)),e.ulid=t=>e.check(function(e,t){return new e({type:'string',format:'ulid',check:'string_format',abort:!1,...ee(t)})}(Kn,t)),e.base64=t=>e.check(function(e,t){return new e({type:'string',format:'base64',check:'string_format',abort:!1,...ee(t)})}(rr,t)),e.base64url=t=>e.check(function(e,t){return new e({type:'string',format:'base64url',check:'string_format',abort:!1,...ee(t)})}(ir,t)),e.xid=t=>e.check(function(e,t){return new e({type:'string',format:'xid',check:'string_format',abort:!1,...ee(t)})}(Yn,t)),e.ksuid=t=>e.check(function(e,t){return new e({type:'string',format:'ksuid',check:'string_format',abort:!1,...ee(t)})}(Xn,t)),e.ipv4=t=>e.check(function(e,t){return new e({type:'string',format:'ipv4',check:'string_format',abort:!1,...ee(t)})}(Qn,t)),e.ipv6=t=>e.check(function(e,t){return new e({type:'string',format:'ipv6',check:'string_format',abort:!1,...ee(t)})}(er,t)),e.cidrv4=t=>e.check(function(e,t){return new e({type:'string',format:'cidrv4',check:'string_format',abort:!1,...ee(t)})}(tr,t)),e.cidrv6=t=>e.check(function(e,t){return new e({type:'string',format:'cidrv6',check:'string_format',abort:!1,...ee(t)})}(nr,t)),e.e164=t=>e.check(function(e,t){return new e({type:'string',format:'e164',check:'string_format',abort:!1,...ee(t)})}(or,t)),e.datetime=t=>e.check(vn(t)),e.date=t=>e.check(gn(t)),e.time=t=>e.check(_n(t)),e.duration=t=>e.check(wn(t))});function Nn(e){return function(e,t){return new e({type:'string',...ee(t)})}(Zn,e)}const Rn=r('ZodStringFormat',(e,t)=>{Ue.init(e,t),Bn.init(e,t)}),Wn=r('ZodEmail',(e,t)=>{Je.init(e,t),Rn.init(e,t)});const Gn=r('ZodGUID',(e,t)=>{He.init(e,t),Rn.init(e,t)});const Vn=r('ZodUUID',(e,t)=>{qe.init(e,t),Rn.init(e,t)});const Fn=r('ZodURL',(e,t)=>{Ke.init(e,t),Rn.init(e,t)});const Un=r('ZodEmoji',(e,t)=>{Ye.init(e,t),Rn.init(e,t)});const Hn=r('ZodNanoID',(e,t)=>{Xe.init(e,t),Rn.init(e,t)});const qn=r('ZodCUID',(e,t)=>{Qe.init(e,t),Rn.init(e,t)});const Jn=r('ZodCUID2',(e,t)=>{et.init(e,t),Rn.init(e,t)});const Kn=r('ZodULID',(e,t)=>{tt.init(e,t),Rn.init(e,t)});const Yn=r('ZodXID',(e,t)=>{nt.init(e,t),Rn.init(e,t)});const Xn=r('ZodKSUID',(e,t)=>{rt.init(e,t),Rn.init(e,t)});const Qn=r('ZodIPv4',(e,t)=>{ct.init(e,t),Rn.init(e,t)});const er=r('ZodIPv6',(e,t)=>{ut.init(e,t),Rn.init(e,t)});const tr=r('ZodCIDRv4',(e,t)=>{lt.init(e,t),Rn.init(e,t)});const nr=r('ZodCIDRv6',(e,t)=>{dt.init(e,t),Rn.init(e,t)});const rr=r('ZodBase64',(e,t)=>{ht.init(e,t),Rn.init(e,t)});const ir=r('ZodBase64URL',(e,t)=>{pt.init(e,t),Rn.init(e,t)});const or=r('ZodE164',(e,t)=>{vt.init(e,t),Rn.init(e,t)});const ar=r('ZodJWT',(e,t)=>{mt.init(e,t),Rn.init(e,t)});const sr=r('ZodNumber',(e,t)=>{gt.init(e,t),On.init(e,t),e.gt=(t,n)=>e.check(an(t,n)),e.gte=(t,n)=>e.check(sn(t,n)),e.min=(t,n)=>e.check(sn(t,n)),e.lt=(t,n)=>e.check(rn(t,n)),e.lte=(t,n)=>e.check(on(t,n)),e.max=(t,n)=>e.check(on(t,n)),e.int=t=>e.check(lr(t)),e.safe=t=>e.check(lr(t)),e.positive=t=>e.check(an(0,t)),e.nonnegative=t=>e.check(sn(0,t)),e.negative=t=>e.check(rn(0,t)),e.nonpositive=t=>e.check(on(0,t)),e.multipleOf=(t,n)=>e.check(cn(t,n)),e.step=(t,n)=>e.check(cn(t,n)),e.finite=()=>e;const n=e._zod.bag;e.minValue=Math.max(n.minimum??Number.NEGATIVE_INFINITY,n.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(n.maximum??Number.POSITIVE_INFINITY,n.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(n.format??'').includes('int')||Number.isSafeInteger(n.multipleOf??.5),e.isFinite=!0,e.format=n.format??null});function cr(e){return function(e,t){return new e({type:'number',checks:[],...ee(t)})}(sr,e)}const ur=r('ZodNumberFormat',(e,t)=>{yt.init(e,t),sr.init(e,t)});function lr(e){return function(e,t){return new e({type:'number',check:'number_format',abort:!1,format:'safeint',...ee(t)})}(ur,e)}const dr=r('ZodBoolean',(e,t)=>{_t.init(e,t),On.init(e,t)});function fr(e){return function(e,t){return new e({type:'boolean',...ee(t)})}(dr,e)}const hr=r('ZodAny',(e,t)=>{bt.init(e,t),On.init(e,t)});const pr=r('ZodUnknown',(e,t)=>{wt.init(e,t),On.init(e,t)});function vr(){return function(e){return new e({type:'unknown'})}(pr)}const mr=r('ZodNever',(e,t)=>{kt.init(e,t),On.init(e,t)});function gr(e){return function(e,t){return new e({type:'never',...ee(t)})}(mr,e)}const yr=r('ZodArray',(e,t)=>{xt.init(e,t),On.init(e,t),e.element=t.element,e.min=(t,n)=>e.check(ln(t,n)),e.nonempty=t=>e.check(ln(1,t)),e.max=(t,n)=>e.check(un(t,n)),e.length=(t,n)=>e.check(dn(t,n)),e.unwrap=()=>e.element});function _r(e,t){return function(e,t,n){return new e({type:'array',element:t,...ee(n)})}(yr,e,t)}const br=r('ZodObject',(e,t)=>{Et.init(e,t),On.init(e,t),W(e,'shape',()=>t.shape),e.keyof=()=>Ar(Object.keys(e._zod.def.shape)),e.catchall=t=>e.clone({...e._zod.def,catchall:t}),e.passthrough=()=>e.clone({...e._zod.def,catchall:vr()}),e.loose=()=>e.clone({...e._zod.def,catchall:vr()}),e.strict=()=>e.clone({...e._zod.def,catchall:gr()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=t=>function(e,t){if(!J(t))throw new Error('Invalid input to extend: expected a plain object');const n=e._zod.def.checks;if(n&&n.length>0)throw new Error('Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.');const r=V(e._zod.def,{get shape(){const n={...e._zod.def.shape,...t};return G(this,'shape',n),n},checks:[]});return Q(e,r)}(e,t),e.safeExtend=t=>function(e,t){if(!J(t))throw new Error('Invalid input to safeExtend: expected a plain object');const n={...e._zod.def,get shape(){const n={...e._zod.def.shape,...t};return G(this,'shape',n),n},checks:e._zod.def.checks};return Q(e,n)}(e,t),e.merge=t=>function(e,t){const n=V(e._zod.def,{get shape(){const n={...e._zod.def.shape,...t._zod.def.shape};return G(this,'shape',n),n},get catchall(){return t._zod.def.catchall},checks:[]});return Q(e,n)}(e,t),e.pick=t=>function(e,t){const n=e._zod.def;return Q(e,V(e._zod.def,{get shape(){const e={};for(const r in t){if(!(r in n.shape))throw new Error(`Unrecognized key: "${r}"`);t[r]&&(e[r]=n.shape[r])}return G(this,'shape',e),e},checks:[]}))}(e,t),e.omit=t=>function(e,t){const n=e._zod.def,r=V(e._zod.def,{get shape(){const r={...e._zod.def.shape};for(const e in t){if(!(e in n.shape))throw new Error(`Unrecognized key: "${e}"`);t[e]&&delete r[e]}return G(this,'shape',r),r},checks:[]});return Q(e,r)}(e,t),e.partial=(...t)=>function(e,t,n){const r=V(t._zod.def,{get shape(){const r=t._zod.def.shape,i={...r};if(n)for(const t in n){if(!(t in r))throw new Error(`Unrecognized key: "${t}"`);n[t]&&(i[t]=e?new e({type:'optional',innerType:r[t]}):r[t])}else for(const t in r)i[t]=e?new e({type:'optional',innerType:r[t]}):r[t];return G(this,'shape',i),i},checks:[]});return Q(t,r)}(Mr,e,t[0]),e.required=(...t)=>function(e,t,n){const r=V(t._zod.def,{get shape(){const r=t._zod.def.shape,i={...r};if(n)for(const t in n){if(!(t in i))throw new Error(`Unrecognized key: "${t}"`);n[t]&&(i[t]=new e({type:'nonoptional',innerType:r[t]}))}else for(const t in r)i[t]=new e({type:'nonoptional',innerType:r[t]});return G(this,'shape',i),i},checks:[]});return Q(t,r)}(Or,e,t[0])});function wr(e,t){const n={type:'object',get shape(){var t;return G(this,'shape',e?(t=e,Object.create(Object.getPrototypeOf(t),Object.getOwnPropertyDescriptors(t))):{}),this.shape},...ee(t)};return new br(n)}const kr=r('ZodUnion',(e,t)=>{Mt.init(e,t),On.init(e,t),e.options=t.options});function Sr(e,t){return new kr({type:'union',options:e,...ee(t)})}const xr=r('ZodIntersection',(e,t)=>{Lt.init(e,t),On.init(e,t)});const zr=r('ZodRecord',(e,t)=>{jt.init(e,t),On.init(e,t),e.keyType=t.keyType,e.valueType=t.valueType});function $r(e,t,n){return new zr({type:'record',keyType:e,valueType:t,...ee(n)})}const Cr=r('ZodEnum',(e,t)=>{Dt.init(e,t),On.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const n=new Set(Object.keys(t.entries));e.extract=(e,r)=>{const i={};for(const r of e){if(!n.has(r))throw new Error(`Key ${r} not found in enum`);i[r]=t.entries[r]}return new Cr({...t,checks:[],...ee(r),entries:i})},e.exclude=(e,r)=>{const i={...t.entries};for(const t of e){if(!n.has(t))throw new Error(`Key ${t} not found in enum`);delete i[t]}return new Cr({...t,checks:[],...ee(r),entries:i})}});function Ar(e,t){const n=Array.isArray(e)?Object.fromEntries(e.map(e=>[e,e])):e;return new Cr({type:'enum',entries:n,...ee(t)})}const Er=r('ZodTransform',(e,t)=>{Ot.init(e,t),On.init(e,t),e._zod.parse=(n,r)=>{if('backward'===r.direction)throw new o(e.constructor.name);n.addIssue=r=>{if('string'==typeof r)n.issues.push(se(r,n.value,t));else{const t=r;t.fatal&&(t.continue=!1),t.code??(t.code='custom'),t.input??(t.input=n.value),t.inst??(t.inst=e),n.issues.push(se(t))}};const i=t.transform(n.value,n);return i instanceof Promise?i.then(e=>(n.value=e,n)):(n.value=i,n)}});function Ir(e){return new Er({type:'transform',transform:e})}const Mr=r('ZodOptional',(e,t)=>{Zt.init(e,t),On.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Lr(e){return new Mr({type:'optional',innerType:e})}const Tr=r('ZodNullable',(e,t)=>{Nt.init(e,t),On.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Pr(e){return new Tr({type:'nullable',innerType:e})}const jr=r('ZodDefault',(e,t)=>{Rt.init(e,t),On.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});const Dr=r('ZodPrefault',(e,t)=>{Gt.init(e,t),On.init(e,t),e.unwrap=()=>e._zod.def.innerType});const Or=r('ZodNonOptional',(e,t)=>{Vt.init(e,t),On.init(e,t),e.unwrap=()=>e._zod.def.innerType});const Br=r('ZodCatch',(e,t)=>{Ut.init(e,t),On.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});const Zr=r('ZodPipe',(e,t)=>{Ht.init(e,t),On.init(e,t),e.in=t.in,e.out=t.out});function Nr(e,t){return new Zr({type:'pipe',in:e,out:t})}const Rr=r('ZodReadonly',(e,t)=>{Jt.init(e,t),On.init(e,t),e.unwrap=()=>e._zod.def.innerType});const Wr=r('ZodCustom',(e,t)=>{Yt.init(e,t),On.init(e,t)});const Gr=Ar(['西幻','都市','武侠','仙侠']),Vr=Ar(['difficulty','world','attributes','gender-race','talents']),Fr=Ar(['简单','普通','困难']),Ur=Ar(['start','creation','playing']),Hr=wr({strength:cr().int().min(0).max(100).optional(),agility:cr().int().min(0).max(100).optional(),intelligence:cr().int().min(0).max(100).optional(),constitution:cr().int().min(0).max(100).optional(),charisma:cr().int().min(0).max(100).optional(),willpower:cr().int().min(0).max(100).optional(),luck:cr().int().min(0).max(100).optional()}),qr=wr({id:Nn().min(1),name:Nn().min(1),description:Nn(),cost:cr().int().min(0).max(50),attributeBonus:Hr,world:Gr.optional()}),Jr=wr({id:Nn().min(1),name:Nn().min(1),description:Nn(),cost:cr().int().min(0).max(50),attributeBonus:Hr,world:Gr.optional()}),Kr=Ar(['male','female']).nullable(),Yr=Ar(['human','elf','dwarf','orc']).nullable(),Xr=Ar(['default','rose']),Qr=wr({name:Nn().min(1).max(50),gender:Kr,race:Yr,world:Gr,background:qr.optional(),talents:_r(Jr).max(10),meta:$r(function(e){return new e({type:'any'})}(hr)).default({})}),ei=wr({strength:cr().int().min(0).max(100),agility:cr().int().min(0).max(100),intelligence:cr().int().min(0).max(100),constitution:cr().int().min(0).max(100),charisma:cr().int().min(0).max(100),willpower:cr().int().min(0).max(100),luck:cr().int().min(0).max(100),pointsLeft:cr().int().min(0).max(100)}),ti=wr({total:cr().int().min(0).max(100),used:cr().int().min(0).max(100),left:cr().int().min(0).max(100)}).refine(e=>e.used+e.left===e.total,{message:'已使用点数加剩余点数必须等于总点数',path:['total']}),ni=wr({phase:Ur,creation_step:Vr.nullable(),world:Gr.nullable(),character:Qr.nullable(),achievements:_r(Nn()).default([]),difficulty:Fr.nullable(),theme:Xr.default('default'),attributes:ei,destinyPoints:ti,selectedGender:Kr,selectedRace:Yr,selectedBackground:qr.nullable(),selectedTalents:_r(Jr).max(10).default([]),streamingEnabled:fr().default(!1)});function ri(){return ni.parse({phase:'start',creation_step:null,world:null,character:null,achievements:[],difficulty:null,theme:'default',attributes:{strength:0,agility:0,intelligence:0,constitution:0,charisma:0,willpower:0,luck:0,pointsLeft:0},destinyPoints:{total:0,used:0,left:0},selectedGender:null,selectedRace:null,selectedBackground:null,selectedTalents:[],streamingEnabled:!1})}function ii(e){try{return{success:!0,data:ni.parse(e)}}catch(e){if(e instanceof Sn)return{success:!1,errors:e};throw e}}function oi(e,t){try{const n=ei.parse(e),r=n.strength+n.agility+n.intelligence+n.constitution+n.charisma+n.willpower+n.luck;let i=!1,o={...n};if(r>t){const e=t/r;o={strength:Math.floor(n.strength*e),agility:Math.floor(n.agility*e),intelligence:Math.floor(n.intelligence*e),constitution:Math.floor(n.constitution*e),charisma:Math.floor(n.charisma*e),willpower:Math.floor(n.willpower*e),luck:Math.floor(n.luck*e),pointsLeft:0};const a=o.strength+o.agility+o.intelligence+o.constitution+o.charisma+o.willpower+o.luck;o.pointsLeft=t-a,i=!0}else o.pointsLeft=t-r;return{success:!0,data:ei.parse(o),corrected:i}}catch(e){if(e instanceof Sn)return{success:!1,errors:e};throw e}}function ai(e){try{return{success:!0,data:ti.parse(e)}}catch(t){if(t instanceof Sn){const n={total:Math.max(0,Math.min(100,e.total||0)),used:Math.max(0,Math.min(100,e.used||0)),left:0};n.used>n.total&&(n.used=n.total),n.left=n.total-n.used;try{return{success:!0,data:ti.parse(n),corrected:!0}}catch(e){return{success:!1,errors:t}}}throw t}}class si{static services=new Map;static metadata=new Map;static debug=!1;static setDebug(e){this.debug=e,e&&console.log('[ServiceLocator] 调试模式已启用')}static register(e,t){this.services.has(e)&&console.warn(`[ServiceLocator] 覆盖服务: ${e}`),this.services.set(e,{instance:t,singleton:!0,initialized:!0}),this.metadata.set(e,{name:e,registeredAt:new Date,resolveCount:0,type:'instance'}),this.debug&&console.log(`[ServiceLocator] 注册服务实例: ${e}`,t)}static registerFactory(e,t,n={}){const{singleton:r=!0,dependencies:i=[]}=n;this.services.has(e)&&console.warn(`[ServiceLocator] 覆盖服务: ${e}`),this.services.set(e,{factory:t,singleton:r,dependencies:i,initialized:!1}),this.metadata.set(e,{name:e,registeredAt:new Date,resolveCount:0,type:r?'singleton':'factory'}),this.debug&&console.log(`[ServiceLocator] 注册服务工厂: ${e}`,{singleton:r,dependencies:i})}static resolve(e){const t=this.services.get(e);if(!t)throw new Error(`[ServiceLocator] 未注册服务: ${e}`);const n=this.metadata.get(e);if(n.resolveCount++,n.lastResolvedAt=new Date,t.instance&&t.singleton)return this.debug&&console.log(`[ServiceLocator] 解析服务实例 (缓存): ${e}`),t.instance;if(t.factory){this.debug&&console.log(`[ServiceLocator] 解析服务 (工厂): ${e}`);this.resolveDependencies(t.dependencies||[]);try{const n=t.factory();if(n instanceof Promise)throw new Error(`[ServiceLocator] 异步工厂暂不支持同步解析: ${e}`);return t.singleton&&(t.instance=n,t.initialized=!0),n}catch(t){throw console.error(`[ServiceLocator] 服务工厂创建失败: ${e}`,t),t}}throw new Error(`[ServiceLocator] 服务定义无效: ${e}`)}static async resolveAsync(e){const t=this.services.get(e);if(!t)throw new Error(`[ServiceLocator] 未注册服务: ${e}`);const n=this.metadata.get(e);if(n.resolveCount++,n.lastResolvedAt=new Date,t.instance&&t.singleton)return this.debug&&console.log(`[ServiceLocator] 异步解析服务实例 (缓存): ${e}`),t.instance;if(t.factory){this.debug&&console.log(`[ServiceLocator] 异步解析服务 (工厂): ${e}`);await this.resolveDependenciesAsync(t.dependencies||[]);try{const e=await t.factory();return t.singleton&&(t.instance=e,t.initialized=!0),e}catch(t){throw console.error(`[ServiceLocator] 异步服务工厂创建失败: ${e}`,t),t}}throw new Error(`[ServiceLocator] 服务定义无效: ${e}`)}static has(e){return this.services.has(e)}static isInitialized(e){const t=this.services.get(e);return!!t&&!0===t.initialized}static getRegisteredServices(){return Array.from(this.services.keys())}static getServiceMetadata(e){return this.metadata.get(e)}static getStatistics(){const e=Array.from(this.metadata.values()),t=Array.from(this.services.values()).filter(e=>e.initialized).length;return{totalServices:this.services.size,initializedServices:t,serviceDetails:e}}static unregister(e){if(!this.services.has(e))return!1;const t=this.services.get(e);if(t?.instance&&'object'==typeof t.instance){const n=t.instance;if('function'==typeof n.cleanup)try{n.cleanup()}catch(t){console.warn(`[ServiceLocator] 服务清理失败: ${e}`,t)}}return this.services.delete(e),this.metadata.delete(e),this.debug&&console.log(`[ServiceLocator] 注销服务: ${e}`),!0}static reset(){for(const e of this.services.keys())this.unregister(e);console.log('[ServiceLocator] 所有服务已重置')}static resolveDependencies(e){return e.map(e=>{if(!this.has(e))throw new Error(`[ServiceLocator] 依赖服务未注册: ${e}`);return this.resolve(e)})}static async resolveDependenciesAsync(e){const t=[];for(const n of e){if(!this.has(n))throw new Error(`[ServiceLocator] 依赖服务未注册: ${n}`);t.push(await this.resolveAsync(n))}return t}static printDebugInfo(){console.group('[ServiceLocator] 调试信息');const e=this.getStatistics();console.log('总服务数:',e.totalServices),console.log('已初始化服务数:',e.initializedServices),console.table(e.serviceDetails.map(e=>({服务名:e.name,类型:e.type,注册时间:e.registeredAt.toLocaleString(),解析次数:e.resolveCount,最后解析:e.lastResolvedAt?.toLocaleString()||'从未'}))),console.groupEnd()}}class ci{eventBus;stateManager;mounted=!1;constructor(){this.eventBus=si.resolve('eventBus'),this.stateManager=si.resolve('stateManager')}unmount(){this.mounted&&(this.mounted=!1,console.log(`[${this.constructor.name}] 控制器已卸载`))}getService(e){return si.resolve(e)}emit(e,t){this.eventBus.emit(e,t)}on(e,t){return this.eventBus.on(e,t)}updateState(e,t){this.stateManager.updateState(e,t)}getState(){return this.stateManager.getState()}}class ui extends ci{steps=['difficulty','world','attributes','talents'];currentStepIndex=0;constructor(){super()}mount(e){if(!this.mounted)try{$(e).html('<div class="creation-container">\n  \x3c!-- 难度选择页面 --\x3e\n  <div class="step-page" data-step="difficulty">\n    <div class="step-header">\n      <h2 class="step-title">选择难度</h2>\n      <p class="step-desc">不同难度将影响你的属性点分配</p>\n    </div>\n    <div class="step-content">\n      <div class="difficulty-options">\n        <button class="option-btn btn-diff" data-diff="简单">\n          <div class="option-title">简单</div>\n          <div class="option-desc">30属性点 / 60天命点</div>\n        </button>\n        <button class="option-btn btn-diff" data-diff="普通">\n          <div class="option-title">普通</div>\n          <div class="option-desc">20属性点 / 50天命点</div>\n        </button>\n        <button class="option-btn btn-diff" data-diff="困难">\n          <div class="option-title">困难</div>\n          <div class="option-desc">15属性点 / 40天命点</div>\n        </button>\n      </div>\n    </div>\n  </div>\n\n  \x3c!-- 世界选择页面 --\x3e\n  <div class="step-page" data-step="world">\n    <div class="step-header">\n      <h2 class="step-title">选择世界</h2>\n      <p class="step-desc">选择你想要冒险的世界背景</p>\n    </div>\n    <div class="step-content">\n      <div class="world-options">\n        <button class="option-btn btn-world" data-world="都市">\n          <div class="option-title">都市</div>\n          <div class="option-desc">现代都市生活</div>\n        </button>\n        <button class="option-btn btn-world disabled" disabled data-world="西幻">\n          <div class="option-title">西幻</div>\n          <div class="option-desc">魔法与剑的世界</div>\n          <div class="coming-soon">即将到来</div>\n        </button>\n        <button class="option-btn btn-world disabled" disabled data-world="武侠">\n          <div class="option-title">武侠</div>\n          <div class="option-desc">江湖恩怨情仇</div>\n          <div class="coming-soon">即将到来</div>\n        </button>\n        <button class="option-btn btn-world disabled" disabled data-world="仙侠">\n          <div class="option-title">仙侠</div>\n          <div class="option-desc">修仙问道成仙</div>\n          <div class="coming-soon">即将到来</div>\n        </button>\n      </div>\n    </div>\n  </div>\n\n  \x3c!-- 角色选择页面已移除，直接进入属性分配 --\x3e\n\n  \x3c!-- 属性分配页面 --\x3e\n  <div class="step-page" data-step="attributes">\n    <div class="step-header">\n      <h2 class="step-title">属性分配</h2>\n      <p class="step-desc">剩余点数：<span class="points-left">0</span></p>\n    </div>\n    <div class="step-content attributes-and-background">\n      \x3c!-- 属性分配区域 --\x3e\n      <div class="attributes-section">\n        <h3 class="section-title">基础属性</h3>\n        <div class="attributes-sliders">\n          <div class="attr-slider" data-key="strength">\n            <div class="attr-label">\n              <span class="attr-name">力量</span>\n              <span class="attr-value">0</span>\n            </div>\n            <input type="range" class="slider" min="0" max="30" value="0" data-attr="strength" />\n          </div>\n          <div class="attr-slider" data-key="agility">\n            <div class="attr-label">\n              <span class="attr-name">敏捷</span>\n              <span class="attr-value">0</span>\n            </div>\n            <input type="range" class="slider" min="0" max="30" value="0" data-attr="agility" />\n          </div>\n          <div class="attr-slider" data-key="intelligence">\n            <div class="attr-label">\n              <span class="attr-name">智力</span>\n              <span class="attr-value">0</span>\n            </div>\n            <input type="range" class="slider" min="0" max="30" value="0" data-attr="intelligence" />\n          </div>\n          <div class="attr-slider" data-key="constitution">\n            <div class="attr-label">\n              <span class="attr-name">体质</span>\n              <span class="attr-value">0</span>\n            </div>\n            <input type="range" class="slider" min="0" max="30" value="0" data-attr="constitution" />\n          </div>\n          <div class="attr-slider" data-key="charisma">\n            <div class="attr-label">\n              <span class="attr-name">魅力</span>\n              <span class="attr-value">0</span>\n            </div>\n            <input type="range" class="slider" min="0" max="30" value="0" data-attr="charisma" />\n          </div>\n          <div class="attr-slider" data-key="willpower">\n            <div class="attr-label">\n              <span class="attr-name">意志</span>\n              <span class="attr-value">0</span>\n            </div>\n            <input type="range" class="slider" min="0" max="30" value="0" data-attr="willpower" />\n          </div>\n          <div class="attr-slider" data-key="luck">\n            <div class="attr-label">\n              <span class="attr-name">幸运</span>\n              <span class="attr-value">0</span>\n            </div>\n            <input type="range" class="slider" min="0" max="30" value="0" data-attr="luck" />\n          </div>\n        </div>\n      </div>\n\n      \x3c!-- 出身选择区域 --\x3e\n      <div class="background-section">\n        <h3 class="section-title">选择出身</h3>\n        <p class="section-desc">剩余天命点：<span class="destiny-points-left">0</span></p>\n        <div class="background-grid" id="background-list">\n          \x3c!-- 出身选项将通过JavaScript动态生成 --\x3e\n        </div>\n      </div>\n    </div>\n  </div>\n\n  \x3c!-- 性别和种族选择页面 --\x3e\n  <div class="step-page" data-step="gender-race">\n    <div class="step-header">\n      <h2 class="step-title">性别与种族</h2>\n      <p class="step-desc">选择你的性别和种族</p>\n    </div>\n    <div class="step-content gender-race-content">\n      \x3c!-- 性别选择区域 --\x3e\n      <div class="gender-section">\n        <h3 class="section-title">选择性别</h3>\n        <div class="gender-options">\n          <button class="option-btn btn-gender" data-gender="male">\n            <div class="option-title">男性</div>\n            <div class="option-desc">力量+1</div>\n          </button>\n          <button class="option-btn btn-gender" data-gender="female">\n            <div class="option-title">女性</div>\n            <div class="option-desc">魅力+1</div>\n          </button>\n        </div>\n      </div>\n\n      \x3c!-- 种族选择区域 --\x3e\n      <div class="race-section">\n        <h3 class="section-title">选择种族</h3>\n        <div class="race-options">\n          <button class="option-btn btn-race" data-race="human">\n            <div class="option-title">人类</div>\n            <div class="option-desc">平衡发展</div>\n          </button>\n          <button class="option-btn btn-race" data-race="elf">\n            <div class="option-title">精灵</div>\n            <div class="option-desc">智力+2，敏捷+1</div>\n          </button>\n          <button class="option-btn btn-race" data-race="dwarf">\n            <div class="option-title">矮人</div>\n            <div class="option-desc">体质+2，力量+1</div>\n          </button>\n          <button class="option-btn btn-race" data-race="orc">\n            <div class="option-title">兽人</div>\n            <div class="option-desc">力量+3，智力-1</div>\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  \x3c!-- 天赋选择页面 --\x3e\n  <div class="step-page" data-step="talents">\n    <div class="step-header">\n      <h2 class="step-title">选择天赋</h2>\n      <p class="step-desc">剩余天命点：<span class="destiny-points-left">0</span>（可多选）</p>\n    </div>\n    <div class="step-content">\n      <div class="talents-grid" id="talents-list">\n        \x3c!-- 天赋选项将通过JavaScript动态生成 --\x3e\n      </div>\n    </div>\n  </div>\n\n  \x3c!-- 导航栏 --\x3e\n  <div class="creation-nav">\n    <button class="nav-btn btn-back-menu">返回主菜单</button>\n\n    \x3c!-- 步骤指示器 --\x3e\n    <div class="step-indicators">\n      <div class="indicator" data-step="difficulty"></div>\n      <div class="indicator" data-step="world"></div>\n      <div class="indicator" data-step="attributes"></div>\n      <div class="indicator" data-step="gender-race"></div>\n      <div class="indicator" data-step="talents"></div>\n    </div>\n\n    <div class="nav-controls">\n      <button class="nav-btn btn-prev" disabled>上一步</button>\n      <button class="nav-btn btn-next" disabled>下一步</button>\n      <button class="nav-btn btn-start-play" style="display: none">开始游戏</button>\n    </div>\n  </div>\n</div>\n'),this.initializeCreation(),this.bindEvents(e),this.showCurrentStep(e),this.updateNavigation(e),this.mounted=!0,this.emit('controller:mounted',{controller:'CreationController'}),console.log('[CreationController] 角色创建界面已挂载')}catch(e){console.error('[CreationController] 挂载失败:',e),this.emit('controller:error',{controller:'CreationController',error:e})}}initializeCreation(){const e=this.getState();e.creation_step||this.updateState({creation_step:'difficulty'},{reason:'initialize-creation'}),this.currentStepIndex=this.steps.indexOf(e.creation_step),-1===this.currentStepIndex&&(this.currentStepIndex=0)}bindEvents(e){$(e).find('.btn-diff').on('click',e=>{this.handleDifficultySelect(e)}),$(e).find('.btn-world').on('click',e=>{this.handleWorldSelect(e)}),$(e).find('.slider').on('input',()=>{this.handleAttributeChange(e)}),$(e).find('.btn-talent').on('click',e=>{this.handleTalentSelect(e)}),$(e).find('.btn-prev').on('click',()=>{this.handlePreviousStep(e)}),$(e).find('.btn-next').on('click',()=>{this.handleNextStep(e)}),$(e).find('.btn-start-play').on('click',()=>{this.handleStartPlay()}),$(e).find('.btn-back-menu').on('click',()=>{this.handleBackToMenu()}),$(e).find('.indicator').on('click',t=>{this.handleStepIndicatorClick(t,e)})}handleDifficultySelect(e){try{const t=$(e.currentTarget),n=t.data('diff'),r=Fr.safeParse(n);if(!r.success)return console.error('[CreationController] 无效的难度值:',n),void toastr.error('无效的难度选择');const i=r.data;$('.btn-diff').removeClass('selected'),t.addClass('selected');const o=z.object({difficulty:Fr,destinyPoints:z.number().int().min(10).max(100),attributePoints:z.number().int().min(10).max(50)}),a={difficulty:i,destinyPoints:'简单'===i?60:'普通'===i?50:40,attributePoints:'简单'===i?30:'普通'===i?20:15},s=o.safeParse(a);if(!s.success)return console.error('[CreationController] 点数配置验证失败:',s.error),void toastr.error('点数配置错误');const{destinyPoints:c,attributePoints:u}=s.data,l=ai({total:c,used:0,left:c});if(!l.success)return console.error('[CreationController] 天命点数据验证失败:',l.errors),void toastr.error('天命点数据错误');const d=oi({strength:0,agility:0,intelligence:0,constitution:0,charisma:0,willpower:0,luck:0,pointsLeft:u},u);if(!d.success)return console.error('[CreationController] 属性数据验证失败:',d.errors),void toastr.error('属性数据错误');this.updateState({difficulty:i,destinyPoints:l.data,attributes:d.data},{reason:'difficulty-selected',allowCorrection:!0}),this.emit('creation:difficulty-selected',{difficulty:i,destinyPoints:l.data.total,attributePoints:u}),console.log('[CreationController] 已选择难度:',i),toastr.success(`已选择${i}难度`)}catch(e){console.error('[CreationController] 难度选择失败:',e),toastr.error('难度选择失败')}}handleWorldSelect(e){try{const t=$(e.currentTarget),n=t.data('world'),r=Gr.safeParse(n);if(!r.success)return console.error('[CreationController] 无效的世界值:',n),void toastr.error('无效的世界选择');const i=r.data;$('.btn-world').removeClass('selected'),t.addClass('selected'),this.updateState({world:i},{reason:'world-selected',allowCorrection:!0}),this.emit('creation:world-selected',{world:i}),console.log('[CreationController] 已选择世界:',i),toastr.success(`已选择${i}世界`)}catch(e){console.error('[CreationController] 世界选择失败:',e),toastr.error('世界选择失败')}}handleAttributeChange(e){try{this.getState();const t=this.getMaxAttributePoints(),n={};$(e).find('.slider').each((_,e)=>{const t=$(e),r=t.data('attr'),i=t.val(),o=parseInt(i);!isNaN(o)&&r&&'pointsLeft'!==r&&(n[r]=Math.max(0,Math.min(100,o)))}),n.pointsLeft=0;const r=oi(n,t);if(!r.success)return console.error('[CreationController] 属性验证失败:',r.errors),void toastr.error('属性数据无效');const i=r.data;r.corrected&&(console.warn('[CreationController] 属性已自动纠正'),toastr.warning('属性点数已自动调整'),$(e).find('.slider').each((_,e)=>{const t=$(e),n=t.data('attr');n&&'pointsLeft'!==n&&void 0!==i[n]&&t.val(i[n])})),this.updateState({attributes:i},{reason:'attributes-changed',allowCorrection:!1}),this.refreshAttributesUI(e);const o=i.strength+i.agility+i.intelligence+i.constitution+i.charisma+i.willpower+i.luck;this.emit('creation:attributes-changed',{attributes:i,totalUsed:o,remaining:i.pointsLeft,corrected:r.corrected||!1})}catch(e){console.error('[CreationController] 属性变更失败:',e),toastr.error('属性变更失败')}}handleTalentSelect(e){try{const t=$(e.currentTarget),n=t.data('talent'),r=this.getState();if(t.hasClass('selected')){t.removeClass('selected');const e=r.selectedTalents.filter(e=>e.name!==n);this.updateState({selectedTalents:e},{reason:'talent-deselected'}),toastr.info(`取消天赋：${n}`),this.emit('creation:talent-deselected',{talent:n})}else{t.addClass('selected');const e={name:n,description:'',cost:0,attributeBonus:{}},i=[...r.selectedTalents,e];this.updateState({selectedTalents:i},{reason:'talent-selected'}),toastr.success(`选择天赋：${n}`),this.emit('creation:talent-selected',{talent:e})}}catch(e){console.error('[CreationController] 天赋选择失败:',e),toastr.error('天赋选择失败')}}handlePreviousStep(e){this.currentStepIndex>0&&(this.currentStepIndex--,this.updateCurrentStep(e))}handleNextStep(e){this.canProceedToNextStep()&&this.currentStepIndex<this.steps.length-1?(this.currentStepIndex++,this.updateCurrentStep(e)):toastr.warning('请完成当前步骤')}handleStartPlay(){try{if(!this.canStartPlay())return void toastr.warning('请完成所有创建步骤');this.updateState({phase:'playing'},{reason:'start-playing'}),this.emit('creation:completed'),this.emit('game:play-started'),console.log('[CreationController] 开始游戏')}catch(e){console.error('[CreationController] 开始游戏失败:',e),toastr.error('开始游戏失败')}}handleBackToMenu(){try{this.updateState({phase:'start',creation_step:null},{reason:'back-to-menu'}),this.emit('creation:cancelled'),console.log('[CreationController] 返回主菜单')}catch(e){console.error('[CreationController] 返回主菜单失败:',e)}}handleStepIndicatorClick(e,t){const n=$(e.currentTarget).data('step'),r=this.steps.indexOf(n);-1!==r&&this.isStepAccessible(r)&&(this.currentStepIndex=r,this.updateCurrentStep(t))}updateCurrentStep(e){const t=this.steps[this.currentStepIndex];this.updateState({creation_step:t},{reason:'step-changed'}),this.showCurrentStep(e),this.updateNavigation(e),this.emit('creation:step-changed',{step:t,index:this.currentStepIndex})}showCurrentStep(e){const t=this.steps[this.currentStepIndex];$(e).find('.step-page').removeClass('active'),$(e).find(`[data-step="${t}"]`).addClass('active'),$(e).find('.indicator').removeClass('active'),$(e).find(`.indicator[data-step="${t}"]`).addClass('active')}updateNavigation(e){const t=$(e).find('.btn-prev'),n=$(e).find('.btn-next'),r=$(e).find('.btn-start-play');t.prop('disabled',this.currentStepIndex<=0);const i=this.canProceedToNextStep();this.currentStepIndex>=this.steps.length-1?(n.hide(),r.show().prop('disabled',!this.canStartPlay())):(n.show().prop('disabled',!i),r.hide())}canProceedToNextStep(){const e=this.getState();switch(this.steps[this.currentStepIndex]){case'difficulty':return!!e.difficulty;case'world':return!!e.world;case'attributes':return 0===e.attributes.pointsLeft;case'talents':return!0;default:return!1}}canStartPlay(){const e=this.getState();return!(!e.difficulty||!e.world||0!==e.attributes.pointsLeft)}isStepAccessible(e){const t=this.getState();switch(e){case 0:return!0;case 1:return!!t.difficulty;case 2:case 3:return!(!t.difficulty||!t.world);default:return!1}}getMaxAttributePoints(){const e=this.getState().difficulty;return'简单'===e?30:'普通'===e?20:15}refreshAttributesUI(e){const t=this.getState().attributes,n=$(e).find('.points-left');n.text(String(t.pointsLeft)),0===t.pointsLeft?n.addClass('zero-points'):n.removeClass('zero-points'),$(e).find('.slider').each((_,e)=>{const n=$(e),r=n.data('attr');if(r&&'pointsLeft'!==r&&void 0!==t[r]){const e=t[r];n.val(e),n.closest('.attr-slider').find('.attr-value').text(String(e))}})}unmount(){if(this.mounted)try{super.unmount(),console.log('[CreationController] 控制器已卸载')}catch(e){console.error('[CreationController] 卸载失败:',e)}}}class li extends ci{sameLayerService;worldbookService;mvuVariableService;constructor(){super(),this.sameLayerService=this.getService('sameLayerService'),this.worldbookService=this.getService('worldbookService'),this.mvuVariableService=this.getService('mvuVariableService')}mount(e){if(!this.mounted)try{$(e).html('<div class="rpg-panel">\n  <div class="panel-header">\n    <div class="panel-title">开始游玩</div>\n    <div class="panel-actions">\n      <button class="btn-settings" title="设置">⚙ 设置</button>\n    </div>\n  </div>\n  <div class="rpg-actions">\n    <button class="btn-save">存档到世界书</button>\n    <button class="btn-load">读取存档</button>\n  </div>\n  <div class="rpg-actions" style="margin-top: 8px">\n    <button class="btn-ai-generate">普通生成</button>\n    <button class="btn-ai-generate-streaming">流式生成</button>\n  </div>\n\n  <div class="current-content" style="margin-top: 15px">\n    <div class="content-header">\n      <h4>当前内容</h4>\n    </div>\n    <div\n      class="current-message-content"\n      style="padding: 10px; background: #f8f9fa; border-radius: 6px; min-height: 100px; white-space: pre-wrap"\n    >\n      暂无内容\n    </div>\n  </div>\n\n  <div class="game-info" style="margin-top: 15px">\n    <div class="info-header">\n      <h4>游戏信息</h4>\n    </div>\n    <div class="character-info">\n      <div class="info-row">\n        <span class="info-label">角色：</span>\n        <span class="character-name">未知</span>\n      </div>\n      <div class="info-row">\n        <span class="info-label">世界：</span>\n        <span class="character-world">未知</span>\n      </div>\n      <div class="info-row">\n        <span class="info-label">难度：</span>\n        <span class="character-difficulty">未知</span>\n      </div>\n    </div>\n    <div class="ai-status" style="margin-top: 10px; padding: 5px; text-align: center; border-radius: 4px">\n      检查中...\n    </div>\n  </div>\n\n  <div class="settings-modal hidden">\n    <div class="settings-card">\n      <div class="settings-title">外观设置</div>\n      <div class="settings-row">\n        <label>配色方案：</label>\n        <select class="select-theme">\n          <option value="default">默认（白色）</option>\n          <option value="rose">玫瑰（#FFF3F4 / #FF9097 / #DCB18C）</option>\n        </select>\n      </div>\n      <div class="settings-actions">\n        <button class="btn-close-settings">确定</button>\n      </div>\n    </div>\n  </div>\n</div>\n'),this.bindEvents(e),this.initializeInterface(e),this.mounted=!0,this.emit('controller:mounted',{controller:'PlayController'}),console.log('[PlayController] 游戏界面已挂载')}catch(e){console.error('[PlayController] 挂载失败:',e),this.emit('controller:error',{controller:'PlayController',error:e})}}bindEvents(e){$(e).find('.btn-save').on('click',async()=>{await this.handleSaveGame()}),$(e).find('.btn-load').on('click',async()=>{await this.handleLoadGame()}),$(e).find('.btn-back-menu').on('click',()=>{this.handleBackToMenu()}),$(e).find('.btn-ai-generate').on('click',async()=>{await this.handleAIGenerateNormal(e)}),$(e).find('.btn-ai-generate-streaming').on('click',async()=>{await this.handleAIGenerateStreaming(e)}),$(e).find('.btn-character-info').on('click',()=>{this.handleShowCharacterInfo()}),$(e).find('.btn-game-settings').on('click',()=>{this.handleShowGameSettings()}),$(e).find('.btn-achievements').on('click',()=>{this.handleShowAchievements()})}initializeInterface(e){try{const t=this.mvuVariableService.getMvuVariable('rpg_game',{default_value:{}});this.updateCharacterInfo(e,t),this.updateGameStats(e,t);const n='undefined'!=typeof generate;$(e).find('.btn-ai-generate').prop('disabled',!n),$(e).find('.btn-ai-generate-streaming').prop('disabled',!n),n?$(e).find('.ai-status').text('生成功能就绪').removeClass('error'):$(e).find('.ai-status').text('生成功能未就绪').addClass('error');const r=this.sameLayerService.getLayer0Message();$(e).find('.current-message-content').text(r||'暂无内容'),console.log('[PlayController] 界面初始化完成')}catch(e){console.error('[PlayController] 界面初始化失败:',e)}}updateCharacterInfo(e,t){try{$(e).find('.character-name').text(t.character?.name||'未知'),$(e).find('.character-world').text(t.world||'未知'),$(e).find('.character-difficulty').text(t.difficulty||'未知'),t.attributes&&($(e).find('.attr-strength').text(t.attributes.strength||0),$(e).find('.attr-agility').text(t.attributes.agility||0),$(e).find('.attr-intelligence').text(t.attributes.intelligence||0),$(e).find('.attr-constitution').text(t.attributes.constitution||0),$(e).find('.attr-charisma').text(t.attributes.charisma||0),$(e).find('.attr-willpower').text(t.attributes.willpower||0),$(e).find('.attr-luck').text(t.attributes.luck||0));const n=t.selectedTalents||[],r=n.length>0?n.map(e=>e.name).join('、'):'无';$(e).find('.character-talents').text(r)}catch(e){console.error('[PlayController] 更新角色信息失败:',e)}}updateGameStats(e,t){try{t.destinyPoints&&($(e).find('.destiny-total').text(t.destinyPoints.total||0),$(e).find('.destiny-used').text(t.destinyPoints.used||0),$(e).find('.destiny-left').text(t.destinyPoints.left||0));const n=t.achievements||[];$(e).find('.achievements-count').text(n.length);const r=t.startTime;if(r){const t=Date.now()-new Date(r).getTime(),n=Math.floor(t/36e5),i=Math.floor(t%36e5/6e4);$(e).find('.play-time').text(`${n}小时${i}分钟`)}else $(e).find('.play-time').text('未知')}catch(e){console.error('[PlayController] 更新游戏统计失败:',e)}}async handleSaveGame(){try{const e=this.mvuVariableService.getMvuVariable('rpg_game',{default_value:{}});await this.worldbookService.saveGameState(e,{name:'同层游玩RPG-存档',description:`${e.character?.name||'角色'} - ${e.world||'世界'} - ${(new Date).toLocaleString()}`}),await this.sameLayerService.overrideLayer0Message('游戏已保存',{rpg:e,saved_at:(new Date).toISOString()}),this.emit('game:saved',e),toastr.success('存档成功'),console.log('[PlayController] 游戏存档成功')}catch(e){console.error('[PlayController] 存档失败:',e),toastr.error('存档失败')}}async handleLoadGame(){try{const e=await this.worldbookService.loadGameState();e?(this.stateManager.updateState(()=>e,{reason:'load-game-in-play',saveToHistory:!1}),await this.sameLayerService.writeGameStateToSameLayer(e,'读档成功，游戏状态已更新'),this.initializeInterface('#app'),this.emit('game:loaded-in-play',e),toastr.success('读档成功'),console.log('[PlayController] 游戏读档成功')):toastr.info('没有可用存档')}catch(e){console.error('[PlayController] 读档失败:',e),toastr.error('读档失败')}}handleBackToMenu(){try{confirm('是否保存当前游戏进度？')?this.handleSaveGame().then(()=>{this.navigateToMenu()}).catch(e=>{console.error('[PlayController] 保存失败:',e),this.navigateToMenu()}):this.navigateToMenu()}catch(e){console.error('[PlayController] 返回主菜单失败:',e)}}navigateToMenu(){this.updateState({phase:'start'},{reason:'back-to-menu-from-play'}),this.emit('game:back-to-menu'),console.log('[PlayController] 返回主菜单')}async handleAIGenerateNormal(e){try{if('undefined'==typeof generate)return void toastr.error('生成功能未就绪');const t=this.mvuVariableService.getMvuVariable('rpg_game',{default_value:{}}),n=this.buildGenerationPrompt(t),r=$(e).find('.btn-ai-generate'),i=r.text();r.prop('disabled',!0).text('生成中...');try{const r=await this.sameLayerService.generateAndOverrideNormal(n,t);$(e).find('.current-message-content').text(r),this.emit('ai:content-generated',{content:r,context:t,streaming:!1}),toastr.success('AI内容生成成功')}finally{r.prop('disabled',!1).text(i)}}catch(e){console.error('[PlayController] AI生成失败:',e),toastr.error('AI生成失败')}}async handleAIGenerateStreaming(e){try{if('undefined'==typeof generate)return void toastr.error('生成功能未就绪');const t=this.mvuVariableService.getMvuVariable('rpg_game',{default_value:{}}),n=this.buildGenerationPrompt(t),r=$(e).find('.btn-ai-generate-streaming'),i=r.text();r.prop('disabled',!0).text('流式生成中...');try{const r=await this.sameLayerService.generateAndOverrideStreaming(n,t);$(e).find('.current-message-content').text(r),this.emit('ai:content-generated',{content:r,context:t,streaming:!0}),toastr.success('流式AI内容生成成功')}finally{r.prop('disabled',!1).text(i)}}catch(e){console.error('[PlayController] 流式AI生成失败:',e),toastr.error('流式AI生成失败')}}buildGenerationPrompt(e){const t=['请基于以下游戏状态生成相应的RPG内容：'];if(e.character?.name&&t.push(`角色：${e.character.name}`),e.world&&t.push(`世界：${e.world}`),e.difficulty&&t.push(`难度：${e.difficulty}`),e.selectedTalents?.length>0){const n=e.selectedTalents.map(e=>e.name).join('、');t.push(`天赋：${n}`)}return e.attributes&&(t.push('属性：'),t.push(`  力量：${e.attributes.strength||0}`),t.push(`  敏捷：${e.attributes.agility||0}`),t.push(`  智力：${e.attributes.intelligence||0}`),t.push(`  体质：${e.attributes.constitution||0}`),t.push(`  魅力：${e.attributes.charisma||0}`),t.push(`  意志：${e.attributes.willpower||0}`),t.push(`  幸运：${e.attributes.luck||0}`)),t.push(''),t.push('请生成一个适合当前游戏状态的事件或场景描述。'),t.join('\n')}showGeneratedContent(e,t){const n=$(e).find('.ai-generated-content');n.length>0&&(n.html(`\n        <div class="generated-content-wrapper">\n          <h4>AI生成内容</h4>\n          <div class="content">${t}</div>\n          <div class="content-actions">\n            <button class="btn btn-sm btn-primary use-content">使用此内容</button>\n            <button class="btn btn-sm btn-secondary regenerate">重新生成</button>\n          </div>\n        </div>\n      `),n.find('.use-content').on('click',()=>{this.handleUseGeneratedContent(t)}),n.find('.regenerate').on('click',()=>{this.handleAIGenerate(e)}))}async handleUseGeneratedContent(e){try{await this.sameLayerService.writeFinalToSameLayer(e,{type:'ai-generated',timestamp:(new Date).toISOString()}),this.emit('ai:content-used',{content:e}),toastr.success('内容已应用')}catch(e){console.error('[PlayController] 使用生成内容失败:',e),toastr.error('应用内容失败')}}handleShowCharacterInfo(){try{const e=this.getState(),t=this.buildCharacterInfoText(e);this.showModal('角色信息',t),this.emit('character:info-viewed')}catch(e){console.error('[PlayController] 显示角色信息失败:',e),toastr.error('显示角色信息失败')}}buildCharacterInfoText(e){const t=[];return t.push(`<strong>姓名：</strong>${e.character?.name||'未知'}`),t.push(`<strong>世界：</strong>${e.world||'未知'}`),t.push(`<strong>难度：</strong>${e.difficulty||'未知'}`),e.attributes&&(t.push('<br><strong>属性：</strong>'),t.push(`力量：${e.attributes.strength||0}`),t.push(`敏捷：${e.attributes.agility||0}`),t.push(`智力：${e.attributes.intelligence||0}`),t.push(`体质：${e.attributes.constitution||0}`),t.push(`魅力：${e.attributes.charisma||0}`),t.push(`意志：${e.attributes.willpower||0}`),t.push(`幸运：${e.attributes.luck||0}`)),e.selectedTalents?.length>0&&(t.push('<br><strong>天赋：</strong>'),e.selectedTalents.forEach(e=>{t.push(`• ${e.name}`)})),t.join('<br>')}handleShowGameSettings(){try{toastr.info('游戏设置功能开发中...'),this.emit('game:settings-requested')}catch(e){console.error('[PlayController] 显示游戏设置失败:',e)}}handleShowAchievements(){try{const e=this.getService('achievementService'),t=e?.getAchievements?.()||[];if(t.length>0){const e=t.join('<br>• ');this.showModal('成就列表',`• ${e}`)}else toastr.info('暂无成就');this.emit('achievements:viewed-in-play',t)}catch(e){console.error('[PlayController] 显示成就失败:',e),toastr.error('获取成就信息失败')}}showModal(e,t){const n=$(`\n      <div class="modal-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; display: flex; align-items: center; justify-content: center;">\n        <div class="modal-content" style="background: white; padding: 20px; border-radius: 8px; max-width: 500px; max-height: 80vh; overflow-y: auto;">\n          <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">\n            <h3 style="margin: 0;">${e}</h3>\n            <button class="btn-close" style="background: none; border: none; font-size: 20px; cursor: pointer;">&times;</button>\n          </div>\n          <div class="modal-body">\n            ${t}\n          </div>\n        </div>\n      </div>\n    `);n.find('.btn-close').on('click',()=>n.remove()),n.on('click',e=>{e.target===n[0]&&n.remove()}),$('body').append(n)}unmount(){if(this.mounted)try{$('.modal-overlay').remove(),super.unmount(),console.log('[PlayController] 控制器已卸载')}catch(e){console.error('[PlayController] 卸载失败:',e)}}}class di extends ci{sameLayerService;worldbookService;constructor(){super(),this.sameLayerService=this.getService('sameLayerService'),this.worldbookService=this.getService('worldbookService')}mount(e){if(!this.mounted)try{$(e).html('<div class="start-screen">\n  <div class="start-topbar">\n    <button class="start-fs btn-fullscreen" title="全屏">⛶ 全屏</button>\n  </div>\n  <div class="start-title">雄小鬼大冒险</div>\n  <div class="start-buttons">\n    <button class="start-btn primary btn-start">开始游戏</button>\n    <button class="start-btn primary btn-load">读取存档</button>\n    <button class="start-btn primary btn-achievements">成就</button>\n  </div>\n</div>\n'),this.bindEvents(e),this.mounted=!0,this.emit('controller:mounted',{controller:'StartController'}),console.log('[StartController] 开始界面已挂载')}catch(e){console.error('[StartController] 挂载失败:',e),this.emit('controller:error',{controller:'StartController',error:e})}}bindEvents(e){$(e).find('.btn-start').on('click',()=>{this.handleStartGame()}),$(e).find('.btn-load').on('click',async()=>{await this.handleLoadGame()}),$(e).find('.btn-achievements').on('click',()=>{this.handleShowAchievements()}),$(e).find('.btn-fullscreen').on('click',async()=>{await this.handleToggleFullscreen()}),$(e).find('.btn-settings').on('click',()=>{this.handleShowSettings()})}handleStartGame(){try{this.updateState({phase:'creation',creation_step:'difficulty'},{reason:'start-new-game'}),this.emit('game:new-started'),console.log('[StartController] 开始新游戏')}catch(e){console.error('[StartController] 开始游戏失败:',e),toastr.error('开始游戏失败')}}async handleLoadGame(){try{const e=await this.worldbookService.loadGameState();e?(this.stateManager.updateState(()=>e,{reason:'load-game',saveToHistory:!1}),await this.sameLayerService.writeGameStateToSameLayer(e,'读档成功，继续游戏'),this.emit('game:loaded',e),toastr.success('读档成功'),console.log('[StartController] 游戏读档成功')):toastr.info('没有可用存档')}catch(e){console.error('[StartController] 读档失败:',e),toastr.error('读档失败')}}handleShowAchievements(){try{const e=this.getService('achievementService'),t=e?.getAchievements?.()||[];if(t.length>0){const e=t.join('、');toastr.info(`已获得成就：${e}`)}else toastr.info('暂无成就');this.emit('achievements:viewed',t)}catch(e){console.error('[StartController] 显示成就失败:',e),toastr.error('获取成就信息失败')}}async handleToggleFullscreen(){try{const e=document.documentElement;document.fullscreenElement?(document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.msExitFullscreen&&await document.msExitFullscreen(),this.emit('fullscreen:exited'),console.log('[StartController] 已退出全屏模式')):(e.requestFullscreen?await e.requestFullscreen():e.webkitRequestFullscreen?await e.webkitRequestFullscreen():e.msRequestFullscreen&&await e.msRequestFullscreen(),this.emit('fullscreen:entered'),console.log('[StartController] 已进入全屏模式'))}catch(e){console.error('[StartController] 全屏切换失败:',e),toastr.error('全屏切换失败')}}handleShowSettings(){try{toastr.info('设置功能开发中...'),this.emit('settings:requested')}catch(e){console.error('[StartController] 显示设置失败:',e)}}unmount(){if(this.mounted)try{super.unmount(),console.log('[StartController] 控制器已卸载')}catch(e){console.error('[StartController] 卸载失败:',e)}}}class fi{eventBus;achievements=new Map;unlockedAchievements=new Set;constructor(e){this.eventBus=e,this.initializeAchievements(),this.setupEventListeners(),console.log('[AchievementService] 成就系统初始化完成')}initializeAchievements(){[{id:'first_start',name:'初次体验',description:'第一次开始游戏',category:'基础'},{id:'world_explorer',name:'世界探索者',description:'体验所有世界类型',category:'探索',progress:{current:0,target:4}},{id:'difficulty_master',name:'难度大师',description:'在困难难度下完成角色创建',category:'挑战'},{id:'talent_collector',name:'天赋收集者',description:'选择5个或更多天赋',category:'收集'},{id:'save_master',name:'存档大师',description:'成功保存10次游戏',category:'系统',progress:{current:0,target:10}},{id:'ai_enthusiast',name:'AI爱好者',description:'使用AI生成功能5次',category:'AI',progress:{current:0,target:5}},{id:'completionist',name:'完美主义者',description:'解锁所有其他成就',category:'终极'}].forEach(e=>{this.achievements.set(e.id,e)})}setupEventListeners(){this.eventBus.on('game:new-started',()=>{this.unlock('first_start')}),this.eventBus.on('creation:world-selected',e=>{this.updateWorldExplorerProgress(e.world)}),this.eventBus.on('creation:difficulty-selected',e=>{'困难'===e.difficulty&&this.unlock('difficulty_master')}),this.eventBus.on('creation:completed',()=>{this.checkTalentCollectorAchievement()}),this.eventBus.on('game:saved',()=>{this.updateProgress('save_master')}),this.eventBus.on('ai:content-generated',()=>{this.updateProgress('ai_enthusiast')}),this.eventBus.on('achievement:unlocked',()=>{this.checkCompletionistAchievement()})}unlock(e){if(this.unlockedAchievements.has(e))return!1;const t=this.achievements.get(e);return t?(this.unlockedAchievements.add(e),t.unlockedAt=new Date,this.eventBus.emit('achievement:unlocked',{achievement:t,timestamp:new Date}),this.showAchievementNotification(t),console.log('[AchievementService] 解锁成就:',t.name),!0):(console.warn('[AchievementService] 未找到成就:',e),!1)}updateProgress(e,t=1){const n=this.achievements.get(e);return!(!n||!n.progress)&&(!this.unlockedAchievements.has(e)&&(n.progress.current+=t,n.progress.current>=n.progress.target?(this.unlock(e),!0):(this.eventBus.emit('achievement:progress-updated',{achievement:n,progress:n.progress,timestamp:new Date}),!1)))}updateWorldExplorerProgress(e){const t=this.achievements.get('world_explorer');if(!t||!t.progress)return;t.progress.current||(t.progress.current=0);const n=new Set;n.add(e),t.progress.current=Math.max(t.progress.current,n.size),t.progress.current>=t.progress.target&&this.unlock('world_explorer')}checkTalentCollectorAchievement(){this.eventBus.on('creation:talents-changed',e=>{e.talents&&e.talents.length>=5&&this.unlock('talent_collector')})}checkCompletionistAchievement(){const e=this.achievements.size;this.unlockedAchievements.size>=e-1&&!this.unlockedAchievements.has('completionist')&&this.unlock('completionist')}getAllAchievements(){return Array.from(this.achievements.values())}getUnlockedAchievements(){return Array.from(this.achievements.values()).filter(e=>this.unlockedAchievements.has(e.id))}getLockedAchievements(){return Array.from(this.achievements.values()).filter(e=>!this.unlockedAchievements.has(e.id))}getStatistics(){const e=this.achievements.size,t=this.unlockedAchievements.size,n=e-t,r=e>0?t/e*100:0,i={};for(const e of this.achievements.values()){const t=e.category;i[t]||(i[t]={total:0,unlocked:0}),i[t].total++,this.unlockedAchievements.has(e.id)&&i[t].unlocked++}return{total:e,unlocked:t,locked:n,completionRate:r,categories:i}}isUnlocked(e){return this.unlockedAchievements.has(e)}getProgress(e){const t=this.achievements.get(e);return t?.progress||null}showAchievementNotification(e){'undefined'!=typeof toastr&&toastr.success(`🏆 解锁成就：${e.name}`,e.description,{timeOut:5e3,extendedTimeOut:2e3}),this.eventBus.emit('notification:achievement',{type:'achievement',title:'成就解锁',message:`🏆 ${e.name}`,description:e.description,achievement:e})}resetAll(){this.unlockedAchievements.clear();for(const e of this.achievements.values())e.progress&&(e.progress.current=0),e.unlockedAt=void 0;this.eventBus.emit('achievements:reset'),console.log('[AchievementService] 所有成就已重置')}export(){return{unlockedAchievements:Array.from(this.unlockedAchievements),progress:Array.from(this.achievements.values()).filter(e=>e.progress).map(e=>({id:e.id,current:e.progress.current,unlockedAt:e.unlockedAt}))}}import(e){e.unlockedAchievements&&(this.unlockedAchievements.clear(),e.unlockedAchievements.forEach(e=>{this.unlockedAchievements.add(e)})),e.progress&&e.progress.forEach(e=>{const t=this.achievements.get(e.id);t&&t.progress&&(t.progress.current=e.current,t.unlockedAt=e.unlockedAt?new Date(e.unlockedAt):void 0)}),console.log('[AchievementService] 成就数据已导入')}cleanup(){console.log('[AchievementService] 资源清理完成')}}class hi{eventBus;constructor(e){this.eventBus=e,this.setupMvuEventListeners(),console.log('[MvuVariableService] Mvu变量服务初始化完成')}getMvuData(e={}){try{const t=Mvu.getMvuData(e);return this.eventBus.emit('mvu:data-read',{options:e,timestamp:new Date}),t}catch(t){throw console.error('[MvuVariableService] 获取Mvu数据失败:',t),this.eventBus.emit('mvu:error',{operation:'getMvuData',error:t,options:e}),t}}async replaceMvuData(e,t={}){try{await Mvu.replaceMvuData(e,t),this.eventBus.emit('mvu:data-replaced',{mvuData:e,options:t,timestamp:new Date}),console.log('[MvuVariableService] Mvu数据已替换')}catch(n){throw console.error('[MvuVariableService] 替换Mvu数据失败:',n),this.eventBus.emit('mvu:error',{operation:'replaceMvuData',error:n,mvuData:e,options:t}),n}}getMvuVariable(e,t={}){try{const{category:n='stat',default_value:r,...i}=t,o=this.getMvuData(i),a=Mvu.getMvuVariable(o,e,{category:n,default_value:r});return this.eventBus.emit('mvu:variable-read',{path:e,value:a,category:n,timestamp:new Date}),a}catch(n){if(console.error('[MvuVariableService] 获取Mvu变量失败:',e,n),this.eventBus.emit('mvu:error',{operation:'getMvuVariable',path:e,error:n,options:t}),void 0!==t.default_value)return t.default_value;throw n}}async setMvuVariable(e,t,n={}){try{const{reason:r='手动设置',is_recursive:i=!1,...o}=n,a=this.getMvuData(o),s=Mvu.getMvuVariable(a,e,{default_value:void 0}),c=await Mvu.setMvuVariable(a,e,t,{reason:r,is_recursive:i});if(c){await this.replaceMvuData(a,o);const n={path:e,oldValue:s,newValue:t,reason:r,timestamp:new Date};this.eventBus.emit('mvu:variable-changed',n),this.eventBus.emit(`mvu:variable-changed:${e}`,n),console.debug('[MvuVariableService] Mvu变量已设置:',e,'从',s,'到',t)}return c}catch(r){throw console.error('[MvuVariableService] 设置Mvu变量失败:',e,r),this.eventBus.emit('mvu:error',{operation:'setMvuVariable',path:e,value:t,error:r,options:n}),r}}async setMultipleMvuVariables(e,t={}){try{const{reason:n='批量设置',is_recursive:r=!1,...i}=t,o=this.getMvuData(i),a=[];for(const[t,i]of Object.entries(e)){const e=Mvu.getMvuVariable(o,t,{default_value:void 0});await Mvu.setMvuVariable(o,t,i,{reason:n,is_recursive:r})&&a.push({path:t,oldValue:e,newValue:i,reason:n,timestamp:new Date})}await this.replaceMvuData(o,i),this.eventBus.emit('mvu:batch-changed',{changes:a,options:t,timestamp:new Date});for(const e of a)this.eventBus.emit('mvu:variable-changed',e),this.eventBus.emit(`mvu:variable-changed:${e.path}`,e);console.debug('[MvuVariableService] 批量Mvu变量设置完成:',Object.keys(e))}catch(n){throw console.error('[MvuVariableService] 批量设置Mvu变量失败:',e,n),this.eventBus.emit('mvu:error',{operation:'setMultipleMvuVariables',updates:e,error:n,options:t}),n}}async parseMessage(e,t={}){try{const n=this.getMvuData(t),r=await Mvu.parseMessage(e,n);return r&&(await this.replaceMvuData(r,t),this.eventBus.emit('mvu:message-parsed',{message:e,oldData:n,newData:r,options:t,timestamp:new Date}),console.log('[MvuVariableService] 消息解析完成')),r}catch(n){throw console.error('[MvuVariableService] 解析消息失败:',n),this.eventBus.emit('mvu:error',{operation:'parseMessage',message:e,error:n,options:t}),n}}async reloadInitVar(e={}){try{const t=this.getMvuData(e),n=await Mvu.reloadInitVar(t);return n&&(await this.replaceMvuData(t,e),this.eventBus.emit('mvu:init-var-reloaded',{mvuData:t,options:e,timestamp:new Date}),console.log('[MvuVariableService] 初始变量数据已重新加载')),n}catch(t){return console.error('[MvuVariableService] 重新加载初始变量失败:',t),this.eventBus.emit('mvu:error',{operation:'reloadInitVar',error:t,options:e}),!1}}onMvuVariableChange(e,t){return e.includes('*')?this.eventBus.on('mvu:variable-changed',n=>{n&&this.matchesPattern(n.path,e)&&t(n)}):this.eventBus.on(`mvu:variable-changed:${e}`,e=>{e&&t(e)})}getGameStateData(e={}){try{return this.getMvuData(e).stat_data||{}}catch(e){return console.error('[MvuVariableService] 获取游戏状态数据失败:',e),{}}}async setGameStateData(e,t={}){try{const{reason:n='设置游戏状态',...r}=t,i=this.getMvuData(r);await Mvu.setMvuVariable(i,'rpg_game',e,{reason:n}),await this.replaceMvuData(i,r),this.eventBus.emit('mvu:game-state-set',{gameState:e,options:t,timestamp:new Date}),console.log('[MvuVariableService] 游戏状态数据已设置')}catch(e){throw console.error('[MvuVariableService] 设置游戏状态数据失败:',e),e}}setupMvuEventListeners(){if('undefined'!=typeof Mvu)try{document.addEventListener(Mvu.events.VARIABLE_UPDATE_STARTED,e=>{this.eventBus.emit('mvu:update-started',{variables:e.detail,timestamp:new Date})}),document.addEventListener(Mvu.events.SINGLE_VARIABLE_UPDATED,e=>{const{stat_data:t,path:n,old_value:r,new_value:i}=e.detail;this.eventBus.emit('mvu:single-variable-updated',{stat_data:t,path:n,oldValue:r,newValue:i,timestamp:new Date})}),document.addEventListener(Mvu.events.VARIABLE_UPDATE_ENDED,e=>{this.eventBus.emit('mvu:update-ended',{variables:e.detail,timestamp:new Date})}),console.log('[MvuVariableService] Mvu事件监听器已设置')}catch(e){console.error('[MvuVariableService] 设置Mvu事件监听器失败:',e)}else console.warn('[MvuVariableService] Mvu变量框架未加载')}matchesPattern(e,t){const n=t.replace(/\./g,'\\.').replace(/\*/g,'.*');return new RegExp(`^${n}$`).test(e)}cleanup(){console.log('[MvuVariableService] 资源清理完成')}}class pi{eventBus;constructor(e){this.eventBus=e,console.log('[SameLayerService] 同层游玩服务初始化完成')}async getAIGeneratedContent(e={}){try{const{streaming:t=!1,prompt:n='',context:r={}}=e;this.eventBus.emit('same-layer:ai-generation-started',{streaming:t,prompt:n,context:r,timestamp:new Date});let i='';return i=t?await generate({user_input:n,should_stream:!0}):await generate({user_input:n,should_stream:!1}),this.eventBus.emit('same-layer:ai-generation-completed',{generatedText:i,streaming:t,prompt:n,timestamp:new Date}),console.log('[SameLayerService] AI内容生成完成'),i}catch(t){throw console.error('[SameLayerService] AI内容生成失败:',t),this.eventBus.emit('same-layer:ai-generation-error',{error:t,options:e}),t}}getLayer0Message(){try{const e=getChatMessages('0');if(0===e.length)throw new Error('未找到第0楼消息');return e[0].message}catch(e){return console.error('[SameLayerService] 获取第0层消息失败:',e),''}}async overrideLayer0Message(e,t={},n={}){try{const{refresh:r='none'}=n,i=getChatMessages('0');if(0===i.length)throw new Error('未找到第0楼消息');const o=i[0],a=o.message,s={...o.data};o.message=e,o.data={...o.data,...t},await setChatMessages([{message_id:0,message:e,data:o.data}],{refresh:r}),this.eventBus.emit('same-layer:layer0-overridden',{messageId:0,oldMessage:a,newMessage:e,oldData:s,newData:o.data,timestamp:new Date}),console.log('[SameLayerService] 第0层消息已覆盖')}catch(n){throw console.error('[SameLayerService] 覆盖第0层消息失败:',n),this.eventBus.emit('same-layer:error',{operation:'overrideLayer0Message',error:n,content:e,data:t}),n}}async generateAndOverrideStreaming(e,t={}){try{const n=await this.getAIGeneratedContent({streaming:!0,prompt:e,context:t});return await this.overrideLayer0Message(n,{rpg:t,generated_at:(new Date).toISOString(),type:'ai_generated_streaming'}),this.eventBus.emit('same-layer:streaming-generation-completed',{prompt:e,generatedContent:n,context:t,timestamp:new Date}),n}catch(e){throw console.error('[SameLayerService] 流式生成并覆盖失败:',e),e}}async generateAndOverrideNormal(e,t={}){try{const n=await this.getAIGeneratedContent({streaming:!1,prompt:e,context:t});return await this.overrideLayer0Message(n,{rpg:t,generated_at:(new Date).toISOString(),type:'ai_generated_normal'}),this.eventBus.emit('same-layer:normal-generation-completed',{prompt:e,generatedContent:n,context:t,timestamp:new Date}),n}catch(e){throw console.error('[SameLayerService] 普通生成并覆盖失败:',e),e}}async updateMessage(e,t,n={}){try{const{refresh:r='affected'}=n,i=getChatMessages(e.toString());if(0===i.length)throw new Error(`未找到消息ID ${e}`);const o=i[0],a={...o};Object.assign(o,t),await setChatMessages([{message_id:e,...t}],{refresh:r}),this.eventBus.emit('same-layer:message-updated',{messageId:e,oldMessage:a,newMessage:o,updates:t,timestamp:new Date}),console.log('[SameLayerService] 消息已更新:',e)}catch(n){throw console.error('[SameLayerService] 更新消息失败:',n),this.eventBus.emit('same-layer:error',{operation:'updateMessage',messageId:e,updates:t,error:n}),n}}async createMessage(e,t={}){try{const{insert_at:n='end',refresh:r='affected'}=t;await createChatMessages([e],{insert_at:n,refresh:r}),this.eventBus.emit('same-layer:message-created',{messageData:e,options:t,timestamp:new Date}),console.log('[SameLayerService] 消息已创建')}catch(n){throw console.error('[SameLayerService] 创建消息失败:',n),this.eventBus.emit('same-layer:error',{operation:'createMessage',messageData:e,options:t,error:n}),n}}async deleteMessages(e,t={}){try{const{refresh:n='all'}=t;await deleteChatMessages(e,{refresh:n}),this.eventBus.emit('same-layer:messages-deleted',{messageIds:e,timestamp:new Date}),console.log('[SameLayerService] 消息已删除:',e)}catch(t){throw console.error('[SameLayerService] 删除消息失败:',t),this.eventBus.emit('same-layer:error',{operation:'deleteMessages',messageIds:e,error:t}),t}}async getMessages(e,t={}){try{const n=getChatMessages(e,t);return this.eventBus.emit('same-layer:messages-retrieved',{range:e,options:t,count:n.length,timestamp:new Date}),n}catch(n){throw console.error('[SameLayerService] 获取消息失败:',n),this.eventBus.emit('same-layer:error',{operation:'getMessages',range:e,options:t,error:n}),n}}getLastMessageId(){try{if('function'==typeof getLastMessageId)return getLastMessageId();{const e=getChatMessages('0-999999');return e.length>0?Math.max(...e.map(e=>e.message_id)):-1}}catch(e){return console.error('[SameLayerService] 获取最新消息ID失败:',e),-1}}async batchUpdateMessages(e,t={}){try{const{refresh:n='affected'}=t;await setChatMessages(e,{refresh:n}),this.eventBus.emit('same-layer:batch-updated',{updates:e,count:e.length,timestamp:new Date}),console.log('[SameLayerService] 批量消息更新完成:',e.length)}catch(t){throw console.error('[SameLayerService] 批量更新消息失败:',t),this.eventBus.emit('same-layer:error',{operation:'batchUpdateMessages',updates:e,error:t}),t}}async writeGameStateToSameLayer(e,t='游戏状态已更新'){try{await this.writeFinalToSameLayer(t,{rpg:e,timestamp:(new Date).toISOString(),version:'2.0'}),this.eventBus.emit('same-layer:game-state-written',{gameState:e,message:t,timestamp:new Date})}catch(e){throw console.error('[SameLayerService] 写入游戏状态失败:',e),e}}cleanup(){console.log('[SameLayerService] 资源清理完成')}}class vi{eventBus;worldbookName=null;saveStrategy='tagged';constructor(e){this.eventBus=e,console.log('[WorldbookService] 世界书服务初始化完成')}async ensureChatWorldbook(e='current'){if(!this.worldbookName)try{this.worldbookName=await getOrCreateChatWorldbook(e),this.eventBus.emit('worldbook:ensured',{worldbookName:this.worldbookName,chatId:e,timestamp:new Date}),console.log('[WorldbookService] 世界书已确保:',this.worldbookName)}catch(t){throw console.error('[WorldbookService] 确保世界书失败:',t),this.eventBus.emit('worldbook:error',{operation:'ensureChatWorldbook',chatId:e,error:t}),t}return this.worldbookName}async saveGameState(e,t={}){try{const{name:n='同层游玩RPG-存档',description:r='自动保存的游戏状态',overwrite:i=!0}=t,o=await this.ensureChatWorldbook(),a=this.createSaveEntry(e,n,r),s=await getWorldbook(o),c=this.applySaveStrategy(s,a,i);await replaceWorldbook(o,c),this.eventBus.emit('worldbook:game-saved',{state:e,entryName:n,worldbookName:o,timestamp:new Date}),console.log('[WorldbookService] 游戏状态已保存:',n)}catch(n){throw console.error('[WorldbookService] 保存游戏状态失败:',n),this.eventBus.emit('worldbook:error',{operation:'saveGameState',state:e,options:t,error:n}),n}}async loadGameState(e={}){try{const{name:t='同层游玩RPG-存档',latest:n=!0}=e,r=await this.ensureChatWorldbook(),i=(await getWorldbook(r)).filter(e=>'save'===e?.extra?.tag&&(!t||e.name===t));if(0===i.length)return console.log('[WorldbookService] 未找到存档'),null;const o=n?_.maxBy(i,e=>e.uid):i.find(e=>e.name===t)||i[0];if(!o)return null;const a=JSON.parse(o.content);return this.eventBus.emit('worldbook:game-loaded',{gameState:a,entryName:o.name,worldbookName:r,timestamp:new Date}),console.log('[WorldbookService] 游戏状态已加载:',o.name),a}catch(t){return console.error('[WorldbookService] 加载游戏状态失败:',t),this.eventBus.emit('worldbook:error',{operation:'loadGameState',options:e,error:t}),null}}async getSaveList(){try{const e=await this.ensureChatWorldbook(),t=(await getWorldbook(e)).filter(e=>'save'===e?.extra?.tag).map(e=>({name:e.name,uid:e.uid,createdAt:new Date(e.uid),description:e.extra?.description})).sort((e,t)=>t.uid-e.uid);return this.eventBus.emit('worldbook:save-list-retrieved',{count:t.length,worldbookName:e,timestamp:new Date}),t}catch(e){return console.error('[WorldbookService] 获取存档列表失败:',e),this.eventBus.emit('worldbook:error',{operation:'getSaveList',error:e}),[]}}async deleteSave(e,t){try{const n=await this.ensureChatWorldbook(),r=await getWorldbook(n),i=r.filter(n=>'save'!==n?.extra?.tag||(n.name!==e||!(!t||n.uid===t))),o=i.length<r.length;return o&&(await replaceWorldbook(n,i),this.eventBus.emit('worldbook:save-deleted',{name:e,uid:t,worldbookName:n,timestamp:new Date}),console.log('[WorldbookService] 存档已删除:',e)),o}catch(n){return console.error('[WorldbookService] 删除存档失败:',n),this.eventBus.emit('worldbook:error',{operation:'deleteSave',name:e,uid:t,error:n}),!1}}async addEntry(e){try{const t=await this.ensureChatWorldbook(),n=await getWorldbook(t),r={name:e.name,enabled:e.enabled??!0,uid:Date.now(),strategy:{type:'constant',keys:e.keys||[],keys_secondary:e.keys_secondary||{logic:'and_any',keys:[]},scan_depth:1},position:e.position||{type:'after_author_note',role:'assistant',depth:0,order:0},content:e.content,probability:e.probability??100,recursion:{prevent_incoming:!0,prevent_outgoing:!0,delay_until:null},effect:{sticky:null,cooldown:null,delay:null},extra:e.extra||{}},i=[...n,r];await replaceWorldbook(t,i),this.eventBus.emit('worldbook:entry-added',{entry:r,worldbookName:t,timestamp:new Date}),console.log('[WorldbookService] 世界书条目已添加:',e.name)}catch(t){throw console.error('[WorldbookService] 添加世界书条目失败:',t),this.eventBus.emit('worldbook:error',{operation:'addEntry',entry:e,error:t}),t}}async updateEntry(e,t){try{const n=await this.ensureChatWorldbook(),r=await getWorldbook(n),i=r.findIndex(t=>t.name===e);if(-1===i)return!1;const o={...r[i]};return void 0!==t.content&&(o.content=t.content),void 0!==t.enabled&&(o.enabled=t.enabled),void 0!==t.probability&&(o.probability=t.probability),void 0!==t.keys&&(o.strategy.keys=t.keys),r[i]=o,await replaceWorldbook(n,r),this.eventBus.emit('worldbook:entry-updated',{name:e,updates:t,worldbookName:n,timestamp:new Date}),console.log('[WorldbookService] 世界书条目已更新:',e),!0}catch(n){return console.error('[WorldbookService] 更新世界书条目失败:',n),this.eventBus.emit('worldbook:error',{operation:'updateEntry',name:e,updates:t,error:n}),!1}}async deleteEntry(e){try{const t=await this.ensureChatWorldbook(),n=await getWorldbook(t),r=n.filter(t=>t.name!==e),i=r.length<n.length;return i&&(await replaceWorldbook(t,r),this.eventBus.emit('worldbook:entry-deleted',{name:e,worldbookName:t,timestamp:new Date}),console.log('[WorldbookService] 世界书条目已删除:',e)),i}catch(t){return console.error('[WorldbookService] 删除世界书条目失败:',t),this.eventBus.emit('worldbook:error',{operation:'deleteEntry',name:e,error:t}),!1}}setSaveStrategy(e){this.saveStrategy=e,console.log('[WorldbookService] 保存策略设置为:',e)}createSaveEntry(e,t,n){return{name:t,enabled:!0,uid:Date.now(),strategy:{type:'constant',keys:[],keys_secondary:{logic:'and_any',keys:[]},scan_depth:1},position:{type:'after_author_note',role:'assistant',depth:0,order:0},content:JSON.stringify(e,null,2),probability:100,recursion:{prevent_incoming:!0,prevent_outgoing:!0,delay_until:null},effect:{sticky:null,cooldown:null,delay:null},extra:{tag:'save',description:n,version:'2.0',createdAt:(new Date).toISOString()}}}applySaveStrategy(e,t,n){const r=e.filter(e=>'save'===e?.extra?.tag),i=e.filter(e=>'save'!==e?.extra?.tag);switch(this.saveStrategy){case'overwrite':return[...i,t];case'versioned':const o=10,a=[...r,t].sort((e,t)=>t.uid-e.uid).slice(0,o);return[...i,...a];default:if(n){const e=r.filter(e=>e.name!==t.name);return[...i,...e,t]}return[...e,t]}}cleanup(){this.worldbookName=null,console.log('[WorldbookService] 资源清理完成')}}class mi{listeners=new Map;onceListeners=new Map;metadata=new Map;options;constructor(e={}){this.options={debug:!1,maxListeners:100,enableNamespaces:!0,...e},this.options.debug&&console.log('[EventBus] 事件总线初始化完成',this.options)}on(e,t){return this.addListener(e,t,!1),()=>this.off(e,t)}once(e,t){return this.addListener(e,t,!0),()=>this.off(e,t)}off(e,t){const n=this.listeners.get(e);n&&(n.delete(t),0===n.size&&this.listeners.delete(e));const r=this.onceListeners.get(e);r&&(r.delete(t),0===r.size&&this.onceListeners.delete(e)),this.updateListenerMetadata(e),this.options.debug&&console.debug(`[EventBus] 取消监听: ${e}`)}async emit(e,t){this.options.debug&&console.debug(`[EventBus] 发送事件: ${e}`,t),this.updateEmitMetadata(e);const n=this.getMatchingListeners(e);if(0===n.length&&this.options.debug)return void console.debug(`[EventBus] 没有监听器处理事件: ${e}`);const r=[];for(const{listener:i,isOnce:o}of n)try{const e=i(t);e instanceof Promise&&r.push(e)}catch(n){console.error(`[EventBus] 监听器执行错误 (${e}):`,n),this.emit('error:listener',{event:e,error:n,payload:t})}if(r.length>0)try{await Promise.all(r)}catch(n){console.error(`[EventBus] 异步监听器执行错误 (${e}):`,n),this.emit('error:async-listener',{event:e,error:n,payload:t})}this.removeOnceListeners(e)}emitSync(e,t){this.options.debug&&console.debug(`[EventBus] 发送同步事件: ${e}`,t),this.updateEmitMetadata(e);const n=this.getMatchingListeners(e);for(const{listener:r,isOnce:i}of n)try{r(t)}catch(t){console.error(`[EventBus] 同步监听器执行错误 (${e}):`,t)}this.removeOnceListeners(e)}removeAllListeners(e){e?(this.listeners.delete(e),this.onceListeners.delete(e),this.metadata.delete(e),this.options.debug&&console.debug(`[EventBus] 移除所有监听器: ${e}`)):(this.listeners.clear(),this.onceListeners.clear(),this.metadata.clear(),this.options.debug&&console.debug('[EventBus] 移除所有监听器'))}listenerCount(e){return(this.listeners.get(e)?.size||0)+(this.onceListeners.get(e)?.size||0)}eventNames(){const e=new Set;return this.listeners.forEach((_,t)=>e.add(t)),this.onceListeners.forEach((_,t)=>e.add(t)),Array.from(e)}getStatistics(){const e=Array.from(this.metadata.values()),t=e.reduce((e,t)=>e+t.listenerCount,0);return{totalEvents:this.metadata.size,totalListeners:t,eventDetails:e}}setDebug(e){this.options.debug=e,e&&console.log('[EventBus] 调试模式已启用')}printDebugInfo(){console.group('[EventBus] 调试信息');const e=this.getStatistics();console.log('总事件数:',e.totalEvents),console.log('总监听器数:',e.totalListeners),e.eventDetails.length>0&&console.table(e.eventDetails.map(e=>({事件名:e.eventName,监听器数:e.listenerCount,发送次数:e.emitCount,最后发送:e.lastEmittedAt?.toLocaleString()||'从未',命名空间:e.namespace||'无'}))),console.groupEnd()}addListener(e,t,n){if(this.listenerCount(e)>=this.options.maxListeners)return void console.warn(`[EventBus] 事件 ${e} 的监听器数量已达到上限 (${this.options.maxListeners})`);const r=n?this.onceListeners:this.listeners;r.has(e)||r.set(e,new Set),r.get(e).add(t),this.updateListenerMetadata(e),this.options.debug&&console.debug(`[EventBus] 添加${n?'一次性':''}监听器: ${e}`)}getMatchingListeners(e){const t=[],n=this.listeners.get(e);n&&n.forEach(e=>{t.push({listener:e,isOnce:!1})});const r=this.onceListeners.get(e);return r&&r.forEach(e=>{t.push({listener:e,isOnce:!0})}),this.options.enableNamespaces&&this.addWildcardMatches(e,t),t}addWildcardMatches(e,t){const n=`${e.split(':')[0]}:*`,r=this.listeners.get(n);r&&r.forEach(e=>{t.push({listener:e,isOnce:!1})});const i=this.onceListeners.get(n);i&&i.forEach(e=>{t.push({listener:e,isOnce:!0})});const o=this.listeners.get('*');o&&o.forEach(e=>{t.push({listener:e,isOnce:!1})});const a=this.onceListeners.get('*');a&&a.forEach(e=>{t.push({listener:e,isOnce:!0})})}removeOnceListeners(e){const t=this.onceListeners.get(e);t&&t.size>0&&(this.onceListeners.delete(e),this.updateListenerMetadata(e))}updateListenerMetadata(e){const t=this.listenerCount(e),n=this.metadata.get(e);n?n.listenerCount=t:this.metadata.set(e,{eventName:e,listenerCount:t,emitCount:0,namespace:this.extractNamespace(e)})}updateEmitMetadata(e){const t=this.metadata.get(e);t?(t.emitCount++,t.lastEmittedAt=new Date):this.metadata.set(e,{eventName:e,listenerCount:this.listenerCount(e),emitCount:1,lastEmittedAt:new Date,namespace:this.extractNamespace(e)})}extractNamespace(e){const t=e.split(':');return t.length>1?t[0]:void 0}cleanup(){this.removeAllListeners(),console.log('[EventBus] 资源清理完成')}}var gi=n(935),yi=n.n(gi);class _i{state;eventBus;stateHistory=[];maxHistorySize=10;constructor(e){this.eventBus=e,this.state=ri(),this.setupEventListeners(),console.log('[StateManager] 状态管理器初始化完成')}getState(){return yi().cloneDeep(this.state)}updateState(e,t={}){const{silent:n=!1,saveToHistory:r=!0,reason:i='unknown',allowCorrection:o=!0}=t;try{r&&this.saveToHistory();const t=yi().cloneDeep(this.state);let a;a='function'==typeof e?e(yi().cloneDeep(this.state)):{...this.state,...e};const s=this.validateAndCorrectState(a,o);if(!s.success){const e=this.formatZodErrors(s.errors);throw console.error('[StateManager] 状态验证失败:',e),this.eventBus.emit('error:state-validation',{reason:i,errors:s.errors,attempted:a}),new Error(`状态验证失败: ${e}`)}this.state=s.data,s.corrected&&(console.warn('[StateManager] 状态已自动纠正:',i),this.eventBus.emit('state:auto-corrected',{reason:i,oldState:t,correctedState:this.state,timestamp:new Date}),'undefined'!=typeof toastr&&toastr.warning('数据已自动纠正')),n||(this.eventBus.emit('state:changed',{oldState:t,newState:yi().cloneDeep(this.state),reason:i,corrected:s.corrected||!1}),this.emitSpecificStateEvents(t,this.state)),console.debug('[StateManager] 状态已更新:',i,this.state)}catch(e){throw console.error('[StateManager] 状态更新失败:',e),this.eventBus.emit('error:state-update',e),e}}resetState(e={}){console.log('[StateManager] 重置游戏状态'),this.updateState(()=>ri(),{silent:e.silent,saveToHistory:!1,reason:'reset'}),this.stateHistory=[]}undoState(e=1){if(0===this.stateHistory.length)return console.warn('[StateManager] 没有可恢复的历史状态'),!1;const t=Math.max(0,this.stateHistory.length-e),n=this.stateHistory[t];return!!n&&(this.stateHistory=this.stateHistory.slice(0,t),this.updateState(()=>yi().cloneDeep(n),{saveToHistory:!1,reason:`undo-${e}-steps`}),console.log('[StateManager] 状态已恢复:',e,'步'),!0)}getHistorySize(){return this.stateHistory.length}subscribe(e,t){return this.eventBus.on('state:changed',({oldState:n,newState:r})=>{const i=yi().get(n,e),o=yi().get(r,e);yi().isEqual(i,o)||t(o,i)})}subscribeToPhaseChange(e){return this.eventBus.on('state:phase-changed',e)}subscribeToCreationStepChange(e){return this.eventBus.on('state:creation-step-changed',e)}getStateSnapshot(){return{current:yi().cloneDeep(this.state),history:yi().cloneDeep(this.stateHistory),historySize:this.stateHistory.length}}setupEventListeners(){this.eventBus.on('game:start',()=>{this.updateState({phase:'start'},{reason:'game-start'})}),this.eventBus.on('game:creation',()=>{this.updateState({phase:'creation',creation_step:'difficulty'},{reason:'game-creation'})}),this.eventBus.on('game:playing',()=>{this.updateState({phase:'playing'},{reason:'game-playing'})}),this.eventBus.on('creation:step-change',e=>{this.updateState({creation_step:e},{reason:'creation-step-change'})})}saveToHistory(){this.stateHistory.push(yi().cloneDeep(this.state)),this.stateHistory.length>this.maxHistorySize&&this.stateHistory.shift()}validateAndCorrectState(e,t=!0){const n=ii(e);if(n.success)return n;if(!t)return n;let r=!1;const i={...e};try{if(e.attributes&&e.difficulty){const t=this.getMaxAttributePoints(e.difficulty),n=oi(e.attributes,t);n.success&&(i.attributes=n.data,n.corrected&&(r=!0))}if(e.destinyPoints){const t=ai(e.destinyPoints);t.success&&(i.destinyPoints=t.data,t.corrected&&(r=!0))}e.selectedTalents&&Array.isArray(e.selectedTalents)&&e.selectedTalents.length>10&&(i.selectedTalents=e.selectedTalents.slice(0,10),r=!0);const t=ii(i);return t.success?{success:!0,data:t.data,corrected:r}:{success:!1,errors:t.errors}}catch(e){return console.error('[StateManager] 状态纠正失败:',e),{success:!1,errors:n.errors}}}getMaxAttributePoints(e){switch(e){case'简单':return 30;case'普通':default:return 20;case'困难':return 15}}formatZodErrors(e){return e.errors.map(e=>`${e.path.join('.')}: ${e.message}`).join('; ')}emitSpecificStateEvents(e,t){e.phase!==t.phase&&this.eventBus.emit('state:phase-changed',{newPhase:t.phase,oldPhase:e.phase}),e.creation_step!==t.creation_step&&this.eventBus.emit('state:creation-step-changed',{newStep:t.creation_step,oldStep:e.creation_step}),e.world!==t.world&&this.eventBus.emit('state:world-changed',{newWorld:t.world,oldWorld:e.world}),!e.character&&t.character&&this.eventBus.emit('state:character-created',t.character),yi().isEqual(e.attributes,t.attributes)||this.eventBus.emit('state:attributes-changed',{newAttributes:t.attributes,oldAttributes:e.attributes}),yi().isEqual(e.selectedTalents,t.selectedTalents)||this.eventBus.emit('state:talents-changed',{newTalents:t.selectedTalents,oldTalents:e.selectedTalents})}cleanup(){this.stateHistory=[],console.log('[StateManager] 资源清理完成')}}class bi{static instance=null;initialized=!1;mounted=!1;currentController=null;constructor(){}static getInstance(){return bi.instance||(bi.instance=new bi),bi.instance}async init(){if(this.initialized)console.warn('[GameCore] 系统已经初始化');else try{console.log('[GameCore] 开始初始化系统...');const e=new mi({debug:!0});si.register('eventBus',e);const t=new _i(e);si.register('stateManager',t),await this.initializeServices(e),this.registerGlobalEvents(e),this.setupErrorHandling(),this.initialized=!0,console.log('[GameCore] 系统初始化完成'),e.emit('core:initialized')}catch(e){throw console.error('[GameCore] 初始化失败:',e),e}}async mount(e){if(!this.initialized)throw new Error('[GameCore] 系统未初始化，请先调用 init()');if(this.mounted)console.warn('[GameCore] 游戏已经挂载');else try{console.log('[GameCore] 挂载游戏到:',e);const t=si.resolve('eventBus');si.resolve('stateManager');t.on('state:changed',()=>{this.render(e)}),this.render(e),this.mounted=!0,t.emit('core:mounted',{selector:e})}catch(e){throw console.error('[GameCore] 挂载失败:',e),e}}async unmount(){if(this.mounted)try{console.log('[GameCore] 卸载游戏...');const e=si.resolve('eventBus');this.currentController&&'function'==typeof this.currentController.unmount&&await this.currentController.unmount(),await this.cleanupServices(),this.mounted=!1,e.emit('core:unmounted'),console.log('[GameCore] 游戏卸载完成')}catch(e){console.error('[GameCore] 卸载失败:',e)}}render(e){try{const t=si.resolve('stateManager').getState();switch(this.currentController&&'function'==typeof this.currentController.unmount&&this.currentController.unmount(),t.phase){case'start':this.currentController=new di;break;case'creation':this.currentController=new ui;break;case'playing':this.currentController=new li;break;default:console.warn('[GameCore] 未知的游戏阶段:',t.phase),this.currentController=new di}this.currentController&&'function'==typeof this.currentController.mount&&this.currentController.mount(e)}catch(t){console.error('[GameCore] 渲染失败:',t),this.handleRenderError(e,t)}}async initializeServices(e){const t=new hi(e),n=new pi(e),r=new vi(e),i=new fi(e);si.register('mvuVariableService',t),si.register('sameLayerService',n),si.register('worldbookService',r),si.register('achievementService',i),console.log('[GameCore] 服务初始化完成')}registerGlobalEvents(e){e.on('error:*',e=>{console.error('[GameCore] 捕获到错误:',e),this.handleError(e)}),e.on('debug:*',e=>{console.debug('[GameCore] 调试信息:',e)}),e.on('perf:*',e=>{console.log('[GameCore] 性能信息:',e)})}setupErrorHandling(){window.addEventListener('unhandledrejection',e=>{console.error('[GameCore] 未处理的Promise拒绝:',e.reason),this.handleError(e.reason),e.preventDefault()}),window.addEventListener('error',e=>{console.error('[GameCore] 全局错误:',e.error),this.handleError(e.error)})}handleRenderError(e,t){try{$(e).html(`\n        <div class="error-container" style="padding: 20px; text-align: center; color: #ff6b6b;">\n          <h3>渲染错误</h3>\n          <p>游戏渲染时发生错误，请刷新页面重试</p>\n          <details style="margin-top: 10px; text-align: left;">\n            <summary>错误详情</summary>\n            <pre style="background: #f8f8f8; padding: 10px; margin-top: 10px; border-radius: 4px;">${t.stack||t.message||String(t)}</pre>\n          </details>\n          <button onclick="window.location.reload()" style="margin-top: 15px; padding: 8px 16px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">\n            刷新页面\n          </button>\n        </div>\n      `)}catch(e){console.error('[GameCore] 错误处理失败:',e)}}handleError(e){'undefined'!=typeof toastr&&toastr.error('发生了一个错误，请查看控制台获取详细信息')}async cleanupServices(){try{const e=['mvuVariableService','sameLayerService','worldbookService','achievementService'];for(const t of e)try{if(si.has(t)){const e=si.resolve(t);e&&'function'==typeof e.cleanup&&await e.cleanup()}}catch(e){console.warn(`[GameCore] 清理服务 ${t} 时出错:`,e)}console.log('[GameCore] 服务清理完成')}catch(e){console.error('[GameCore] 服务清理失败:',e)}}static reset(){bi.instance&&(bi.instance.unmount(),si.reset(),bi.instance=null)}isInitialized(){return this.initialized}isMounted(){return this.mounted}}const wi=bi.getInstance();$(()=>{console.log('[同层游玩RPG] 开始初始化...'),wi.init().then(()=>wi.mount('#app')).then(()=>{console.log('[同层游玩RPG] 初始化完成')}).catch(e=>{console.error('[同层游玩RPG] 初始化失败:',e),$('#app').html('\n      <div style="padding: 20px; text-align: center; color: #ff6b6b;">\n        <h3>游戏初始化失败</h3>\n        <p>请刷新页面重试</p>\n        <button onclick="window.location.reload()" style="margin-top: 10px; padding: 8px 16px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">\n          刷新页面\n        </button>\n      </div>\n    ')})}),$(window).on('unload',()=>{console.log('[同层游玩RPG] 开始清理...'),wi.unmount()}),window.GameCore=wi;</script><style>.rpg-app{width:100%;aspect-ratio:4/3;display:flex;flex-direction:column;padding:12px;box-sizing:border-box;margin:0 auto}.start-topbar{position:absolute;top:10px;right:10px}.start-fs{padding:6px 10px;border-radius:0;border:1px solid hsla(0,0%,100%,.7);background:hsla(0,0%,100%,.6);color:#5b3a80;font-weight:700;cursor:pointer}.rpg-panel{border:1px solid rgba(0,0,0,.08);border-radius:0;padding:12px;background:#fff}.rpg-actions{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:8px}.rpg-title{font-weight:700;font-size:16px;margin-bottom:8px}.start-screen{width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#fff;border-radius:16px;box-shadow:inset 0 0 0 1px hsla(0,0%,100%,.5),0 10px 30px rgba(255,144,151,.15);position:relative}.start-title{font-size:28px;font-weight:900;letter-spacing:2px;color:#ff9097;text-shadow:0 2px 0 #fff,0 6px 12px rgba(255,144,151,.25)}.start-subtitle{margin-top:4px;font-size:12px;color:#dcb18c;opacity:.9}.start-buttons{display:grid;grid-template-columns:1fr;gap:10px;width:min(80%,360px);margin-top:18px}.start-btn{width:100%;padding:10px 14px;border-radius:14px;border:1px solid hsla(0,0%,100%,.7);font-weight:700;letter-spacing:1px;cursor:pointer;transition:transform .15s ease,box-shadow .2s ease,background .2s ease}.start-btn.primary{background:#fff3f4;color:#ff9097;box-shadow:0 6px 16px rgba(255,144,151,.3)}.start-btn:hover{transform:translateY(-1px);box-shadow:0 8px 18px rgba(255,144,151,.28)}:fullscreen{width:100vw;height:100vh}:fullscreen #rpg-root{max-width:none !important;width:100vw !important;height:100vh !important;margin:0 !important;padding:0 !important;display:flex;align-items:center;justify-content:center}:fullscreen .rpg-app{width:100vw !important;height:100vh !important;aspect-ratio:auto !important;padding:0 !important}:-webkit-full-screen #rpg-root{max-width:none !important;width:100vw !important;height:100vh !important;margin:0 !important;padding:0 !important;display:flex;align-items:center;justify-content:center}:-webkit-full-screen .rpg-app{width:100vw !important;height:100vh !important;aspect-ratio:auto !important;padding:0 !important}.creation-container{display:flex;flex-direction:column;height:100%;background:#fff3f4;border-radius:16px}.step-page{display:none;flex:1;padding:20px;overflow-y:auto}.step-page.active{display:flex;flex-direction:column}.step-header{text-align:center;margin-bottom:30px}.step-title{font-size:24px;font-weight:900;color:#ff9097;margin-bottom:8px}.step-desc{font-size:14px;color:#dcb18c;opacity:.9}.step-content{flex:1;display:flex;align-items:center;justify-content:center}.difficulty-options,.world-options,.role-options{display:grid;gap:16px;max-width:400px;width:100%}.option-btn{background:#fff;border:2px solid rgba(220,177,140,.3);border-radius:12px;padding:20px;cursor:pointer;transition:all .3s ease;text-align:center}.option-btn:hover{background:#fff3f4;border-color:rgba(255,144,151,.5);transform:translateY(-2px)}.option-btn.selected{background:#fff3f4;border-color:#ff9097;color:#ff9097}.option-title{font-size:18px;font-weight:700;color:#ff9097;margin-bottom:4px}.option-desc{font-size:12px;color:#dcb18c;opacity:.8}.attributes-and-background{flex-direction:column;gap:40px;padding:20px;max-width:800px;width:100%;margin:0 auto}.attributes-section,.background-section{width:100%}.section-title{font-size:20px;font-weight:700;color:#ff9097;margin-bottom:16px;text-align:center}.section-desc{font-size:14px;color:#dcb18c;text-align:center;margin-bottom:20px}.attributes-sliders{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;max-width:700px;margin:0 auto}.attr-slider{background:#fff;border:1px solid rgba(220,177,140,.3);border-radius:8px;padding:16px}.attr-label{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.attr-name{font-weight:600;color:#ff9097;font-size:16px}.attr-value{font-weight:700;color:#ff9097;background:#fff3f4;padding:4px 8px;border-radius:4px;min-width:30px;text-align:center}.slider{width:100%;height:6px;border-radius:3px;background:#f0f0f0;outline:none;-webkit-appearance:none;appearance:none}.slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:20px;height:20px;border-radius:50%;background:#ff9097;cursor:pointer;-webkit-transition:all .3s ease;transition:all .3s ease}.slider::-webkit-slider-thumb:hover{background:#ff7a82;transform:scale(1.1)}.points-left.zero-points+.attributes-sliders .slider::-webkit-slider-thumb{cursor:not-allowed}.points-left.zero-points+.attributes-sliders .slider::-webkit-slider-thumb:hover{background:#ff9097;transform:none}.slider::-moz-range-thumb{width:20px;height:20px;border-radius:50%;background:#ff9097;cursor:pointer;border:none;-moz-transition:all .3s ease;transition:all .3s ease}.slider::-moz-range-thumb:hover{background:#ff7a82;transform:scale(1.1)}.slider::-webkit-slider-track{height:6px;border-radius:3px;background:linear-gradient(to right,#ff9097 0%,#f0f0f0 0%)}.slider::-moz-range-track{height:6px;border-radius:3px;background:#f0f0f0}.points-left{font-weight:700;color:#ff9097}.background-grid,.talents-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;max-width:800px;width:100%}.background-item,.talent-item{background:#fff;border:2px solid rgba(220,177,140,.3);border-radius:8px;padding:16px;cursor:pointer;transition:all .3s ease;text-align:left;position:relative}.background-item:hover,.talent-item:hover{background:#fff3f4;border-color:rgba(255,144,151,.5);transform:translateY(-2px)}.background-item.selected,.talent-item.selected{background:#fff3f4;border-color:#ff9097}.background-item.disabled,.talent-item.disabled{opacity:.5;cursor:not-allowed;background:rgba(200,200,200,.3)}.background-item.disabled:hover,.talent-item.disabled:hover{transform:none}.item-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px}.item-name{font-size:16px;font-weight:600;color:#ff9097}.item-cost{background:#f0f0f0;color:#666;padding:2px 6px;border-radius:4px;font-size:12px;font-weight:600}.item-cost.free{background:#e8f5e8;color:#2d5d2d}.item-cost.expensive{background:#ffe8e8;color:darkred}.item-desc{font-size:13px;color:#dcb18c;margin-bottom:8px;line-height:1.4}.item-bonus{font-size:12px;color:#2d5d2d;background:rgba(46,125,50,.1);padding:4px 8px;border-radius:4px;border-left:3px solid #4caf50}.destiny-points-left{font-weight:700;color:#ff9097}.gender-race-content{display:flex;flex-direction:column;gap:40px;padding:20px;max-width:600px;margin:0 auto}.gender-section,.race-section{width:100%}.gender-options,.race-options{display:grid;gap:16px;width:100%}.gender-options{grid-template-columns:1fr 1fr}.race-options{grid-template-columns:repeat(auto-fit,minmax(200px,1fr))}.coming-soon{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,.7);color:#fff;padding:4px 8px;border-radius:4px;font-size:11px;font-weight:600;pointer-events:none}.option-btn.disabled{opacity:.6;cursor:not-allowed;position:relative}.option-btn.disabled:hover{background:hsla(0,0%,100%,.8);border-color:rgba(220,177,140,.2);transform:none}.step-indicators{display:flex;justify-content:center;gap:12px;align-items:center}.indicator{width:12px;height:12px;border-radius:50%;background:#fff;border:2px solid rgba(220,177,140,.4);transition:all .3s ease;cursor:pointer}.indicator.active{background:#ff9097;border-color:#ff9097;transform:scale(1.2)}.indicator:hover{border-color:#ff9097}.indicator.disabled{opacity:.5;cursor:not-allowed}.indicator.disabled:hover{border-color:rgba(220,177,140,.4)}.creation-nav{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;background:hsla(0,0%,100%,.9);border-top:1px solid rgba(220,177,140,.3)}.nav-controls{display:flex;gap:12px}.nav-btn{background:#fff;border:1px solid rgba(220,177,140,.4);border-radius:6px;padding:8px 16px;color:#ff9097;font-weight:600;cursor:pointer;transition:all .3s ease}.nav-btn:hover:not(:disabled){background:#fff3f4;border-color:#ff9097}.nav-btn:disabled{opacity:.5;cursor:not-allowed}.nav-btn.btn-start-play{background:#fff3f4;color:#ff9097;border-color:#ff9097}@media (max-width:768px){.step-page{padding:16px}.attributes-grid{grid-template-columns:1fr}.talents-grid{grid-template-columns:repeat(auto-fit,minmax(120px,1fr))}.creation-nav{padding:12px 16px}.nav-btn{padding:6px 12px;font-size:14px}}
</style></head><body class="min-w-0"><main id="rpg-root" class="tw w-full max-w-[720px] mx-auto"><div id="app" class="rpg-app"></div></main></body></html>